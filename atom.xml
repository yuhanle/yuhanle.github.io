<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ç…œå¯’äº†</title>
  
  <subtitle>å…³å¿ƒç²®é£Ÿå’Œè”¬èœ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.yuhanle.com/"/>
  <updated>2021-10-21T08:18:48.335Z</updated>
  <id>https://blog.yuhanle.com/</id>
  
  <author>
    <name>ç…œå¯’äº†</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä½¿ç”¨ fastlane è¿›è¡Œ iOS æ‰“åŒ…</title>
    <link href="https://blog.yuhanle.com/2018/08/06/fastlane-say-here/"/>
    <id>https://blog.yuhanle.com/2018/08/06/fastlane-say-here/</id>
    <published>2018-08-06T01:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.335Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://docs.fastlane.tools/img/fastlane_text.png" alt></p><p><a href="https://fastlane.tools/" target="_blank" rel="noopener">fastlane</a> æ˜¯ä¸€ä¸ªé€šè¿‡ç®€å•å‘½ä»¤æ¥å®Œæˆè¯¸å¦‚æˆªå›¾ã€è·å–è¯ä¹¦ã€ç¼–è¯‘ã€å¯¼å‡ºå®‰è£…åŒ…ã€æäº¤ iTunesConnect ç­‰ä¸€ç³»åˆ—æ“ä½œçš„å·¥å…·ï¼Œå®ƒåŒæ—¶æ”¯æŒ iOS å’Œ Androidã€‚ </p><a id="more"></a><table><thead><tr><th style="text-align:center"></th><th>fastlane</th></tr></thead><tbody><tr><td style="text-align:center">ğŸš€</td><td>Save <strong>hours</strong> every time you push a new release to the store or beta testing service</td></tr><tr><td style="text-align:center">âœ¨</td><td>Integrates with all your existing tools and services (170 actions currently)</td></tr><tr><td style="text-align:center">ğŸ“–</td><td>100% open source under the MIT license</td></tr><tr><td style="text-align:center">ğŸ©</td><td>Easy setup assistant to get started in a few minutes</td></tr><tr><td style="text-align:center">âš’</td><td>Runs on <strong>your</strong> machine, itâ€™s your app and your data</td></tr><tr><td style="text-align:center">ğŸ‘»</td><td>Integrates with all major CI systems</td></tr><tr><td style="text-align:center">ğŸ–¥</td><td>Supports iOS, Mac, and Android apps</td></tr><tr><td style="text-align:center">ğŸ”§</td><td>Extend and customise <em>fastlane</em> to fit your needs, youâ€™re not dependent on anyone</td></tr><tr><td style="text-align:center">ğŸ’­</td><td>Never remember any commands any more, just <em>fastlane</em></td></tr><tr><td style="text-align:center">ğŸš¢</td><td>Deploy from any computer, including a CI server</td></tr></tbody></table><p>ä½ èƒ½å¤Ÿé€šè¿‡ç®€å•çš„æ–¹å¼é…ç½®æµç¨‹è¿›è¡Œçš„é¡ºåºï¼Œå¹¶é€šè¿‡éå¸¸ç®€å•çš„å‘½ä»¤æ‰§è¡Œå…¶ä¸­çš„ä¸€ä¸ªæµç¨‹ã€‚å½“ç„¶å®ƒçš„ç®€å•å¹¶ä¸ä»£è¡¨åŠŸèƒ½ä¹Ÿç®€é™‹ï¼Œæœ‰å¼€æºç¤¾åŒºçš„æ”¯æŒï¼Œæ›´æ–°è¿…é€Ÿä¸”æœ‰å¾ˆå¤šåŠŸèƒ½èƒ½å¤Ÿæ»¡è¶³ä½ çš„éœ€æ±‚ã€‚</p><p><img src="http://cdn.yuhanle.com/fastlane/2017-12-21-fastlane01.png" alt></p><h2 id="ä¸ºä»€ä¹ˆä½¿ç”¨å®ƒ"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨å®ƒ" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨å®ƒ"></a>ä¸ºä»€ä¹ˆä½¿ç”¨å®ƒ</h2><p>ä½œä¸ºå…¬å¸çš„ iOS ç¨‹åºå‘˜ï¼Œå°‘ä¸äº†åœ¨å‘å¸ƒåº”ç”¨çš„æ—¶å€™å„ç§ç­‰å¾…ã€‚æ ‡å‡†çš„æ‰‹åŠ¨å‘å¸ƒæµç¨‹æ˜¯ï¼šç¼–è¯‘-&gt;æ‰“åŒ…ä¸Šä¼ -&gt;å¡«å†™åº”ç”¨æ›´æ–°æ•°æ®-&gt;ç­‰å¾… iTunesConnect ç¼–è¯‘-&gt;é€‰æ‹©ç‰ˆæœ¬å‘å¸ƒï¼Œæ•´ä¸ªè¿‡ç¨‹å¤§æ¦‚éœ€è¦ 30 åˆ†é’Ÿå·¦å³ã€‚å…³é”®æ˜¯è¿™ä¸ªè¿‡ç¨‹å°±åƒwindows è£…ç³»ç»Ÿä¸€æ ·ï¼Œè™½ç„¶æ‰‹åŠ¨å‚ä¸çš„ä¸å¤šï¼Œä½†æ˜¯è¦ä¸€ç›´å®ˆåœ¨ç”µè„‘å‰ç­‰ç€ã€‚</p><p>åˆšå¼€å§‹ç”¨ fastlaneï¼Œå‘ç°å…¶ä½¿ç”¨å’Œé…ç½®è¿˜ç®—ç®€å•ï¼Œæœ‰å¼€æºç¤¾åŒºæ”¯æŒï¼Œæ›´æ–°è¿…é€ŸåŠŸèƒ½å¼ºå¤§ã€‚ä¸”ç›¸æ¯” jenkins é‡Œçš„æ’ä»¶ï¼Œfastlane å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥è¢«<strong><a href="https://docs.fastlane.tools/best-practices/continuous-integration/" target="_blank" rel="noopener">å¤šç§CI </a></strong>æ¥å…¥ã€‚</p><p>ç¨‹åºå‘˜è¿™ä¹ˆæ‡’ï¼Œä¸€å®šä¼šæƒ³åŠæ³•è®©ä»–è‡ªåŠ¨åŒ–çš„ã€‚åæ¥å‘ç°ç‰¹åˆ«æ‡’çš„ <a href="https://github.com/KrauseFx" target="_blank" rel="noopener">Felix Krause</a> å†™çš„ <a href="https://docs.fastlane.tools/" target="_blank" rel="noopener">Fastlane</a>ï¼ŒFastlaneå¯ä»¥éå¸¸å¿«é€Ÿç®€å•çš„æ­å»ºä¸€ä¸ªè‡ªåŠ¨åŒ–å‘å¸ƒæœåŠ¡ï¼Œå¹¶ä¸”æ”¯æŒ <code>Android</code>ï¼Œ<code>iOS</code>ï¼Œ<code>MacOS</code>ã€‚ä»–å¯ä»¥å®ç°ä¸€æ¡å‘½ä»¤ä»<strong>ç¼–è¯‘</strong>åˆ°<strong>é€‰ç‰ˆå‘å¸ƒ</strong>å…¨ç¨‹ä¸ç”¨å¹²é¢„ã€‚ä½œä¸ºç¨‹åºå‘˜çš„ä½ åªè¦ä¸€æ¡å‘½ä»¤ï¼Œçœ‹é›†ç¾å‰§ï¼Œå‘å¸ƒå°±å®Œæˆäº†ã€‚æˆªæ­¢åˆšåˆš Fastlane å®˜ç½‘ä¸Šå®£ç§°å·²ç»ä¸ºç¨‹åºå‘˜èŠ‚çœäº†<strong>13,746,550å°æ—¶+</strong>ã€‚</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>æäº¤æ—¶æ‰§è¡Œæµ‹è¯•ï¼ˆåŒ…æ‹¬å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼‰ï¼›</li><li>æ„å»ºå¹¶åˆ†å‘å†…éƒ¨æµ‹è¯•ï¼Œå…¬å¼€æµ‹è¯•ç‰ˆæœ¬ï¼›</li><li>æ„å»ºç”Ÿäº§ç‰ˆæœ¬å¹¶ä¸Šä¼ è‡³ ITCï¼ˆåŒ…æ‹¬æ›´æ–°é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºæ–°çš„å±å¹•æˆªå›¾ï¼Œä¸Šä¼ åº”ç”¨å¹¶æäº¤å®¡æ ¸ï¼‰ï¼›</li><li>â€¦</li></ul><h2 id="ç³»ç»Ÿè¦æ±‚"><a href="#ç³»ç»Ÿè¦æ±‚" class="headerlink" title="ç³»ç»Ÿè¦æ±‚"></a>ç³»ç»Ÿè¦æ±‚</h2><ul><li>ä¼šç¼–ç¨‹</li><li>Xcode7+</li><li>Mac OS 10.11+</li></ul><h2 id="å·¥å…·é›†"><a href="#å·¥å…·é›†" class="headerlink" title="å·¥å…·é›†"></a>å·¥å…·é›†</h2><p><code>fastlane</code> å°†å¦‚ä¸‹çš„å·¥å…·å¥—ä»¶æœ‰æœºåœ°ç»“åˆèµ·æ¥,ä»ç®¡ç†è¯ä¹¦åˆ°å•å…ƒæµ‹è¯•,ä»ç¼–è¯‘æ‰“åŒ…åˆ°ä¸Šä¼ å‘å¸ƒ,éƒ½èƒ½é€šè¿‡å‘½ä»¤è¡Œè½»æ¾å®Œæˆ.è¯¥å¥—ä»¶æ”¯æŒä¸ <code>Jenkins</code> å’Œ <code>CocoaPods</code>ï¼Œ<code>xctools</code> ç­‰å…¶ä»–ç¬¬ä¸‰æ–¹å·¥å…·çš„é›†æˆ,å¹¶ä¸”èƒ½å¤Ÿå®šä¹‰å¤šä¸ªé€šé“ï¼ˆlanesï¼‰ä»¥æ”¯æŒä¸åŒçš„éƒ¨ç½²ç›®æ ‡ã€‚</p><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><ul><li><a href="https://github.com/fastlane/fastlane/tree/master/scan" target="_blank" rel="noopener">scan</a> =&gt; è‡ªåŠ¨è¿è¡Œæµ‹è¯•å·¥å…·ï¼Œå¹¶ä¸”å¯ä»¥ç”Ÿæˆæ¼‚äº®çš„ HTML æŠ¥å‘Š</li></ul><h3 id="è¯ä¹¦ï¼Œé…ç½®æ–‡ä»¶"><a href="#è¯ä¹¦ï¼Œé…ç½®æ–‡ä»¶" class="headerlink" title="è¯ä¹¦ï¼Œé…ç½®æ–‡ä»¶"></a>è¯ä¹¦ï¼Œé…ç½®æ–‡ä»¶</h3><ul><li><a href="https://github.com/fastlane/fastlane/tree/master/cert" target="_blank" rel="noopener">cert</a> =&gt; è‡ªåŠ¨åˆ›å»ºç®¡ç† iOS ä»£ç ç­¾åè¯ä¹¦</li><li><a href="https://github.com/fastlane/fastlane/tree/master/sigh" target="_blank" rel="noopener">sigh</a> =&gt; ä¸€å£°å¹æ¯å•Šï¼Œè¿™ä¹ˆå¤šå¹´å’Œ <code>Provisioning Profile</code>æˆ˜æ–—è¿‡æ— æ•°æ¬¡ã€‚æ€»æ˜¯æœ‰è¿™æ ·é‚£æ ·çš„é—®é¢˜å¯¼è‡´é…ç½®æ–‡ä»¶è¿‡æœŸæˆ–è€…å¤±æ•ˆã€‚<code>sigh</code> æ˜¯ç”¨æ¥åˆ›å»ºã€æ›´æ–°ã€ä¸‹è½½ã€ä¿®å¤ <code>Provisioning Profile</code> çš„å·¥å…·ã€‚</li><li><a href="https://github.com/fastlane/fastlane/tree/master/pem" target="_blank" rel="noopener">pem</a> =&gt; è‡ªåŠ¨ç”Ÿæˆã€æ›´æ–°æ¨é€é…ç½®æ–‡ä»¶</li><li><a href="https://github.com/fastlane/fastlane/tree/master/match" target="_blank" rel="noopener">match</a> =&gt; ä¸€ä¸ªæ–°çš„è¯ä¹¦å’Œé…ç½®æ–‡ä»¶ç®¡ç†å·¥å…·ã€‚æˆ‘ä¼šå¦å†™ä¸€ç¯‡æ–‡ç« ä¸“é—¨ä»‹ç»è¿™ä¸ªå·¥å…·ã€‚ä»–ä¼šæ‰€æœ‰éœ€è¦ç”¨åˆ°çš„è¯ä¹¦ä¼ åˆ° git ç§æœ‰åº“ä¸Šï¼Œä»»ä½•éœ€è¦é…ç½®çš„æœºå™¨ç›´æ¥ç”¨ <code>match</code> åŒæ­¥å›æ¥å°±ä¸ç”¨ç®¡è¯ä¹¦é—®é¢˜äº†ï¼Œå°å›¢é˜Ÿç¦éŸ³å•Šï¼</li></ul><h3 id="æˆªå›¾"><a href="#æˆªå›¾" class="headerlink" title="æˆªå›¾"></a>æˆªå›¾</h3><ul><li><a href="https://github.com/fastlane/fastlane/tree/master/snapshot" target="_blank" rel="noopener">snapshot</a> =&gt; ç”¨ <code>Xcode7</code> æ¨å‡ºçš„ <code>UI test</code> åŠŸèƒ½å®ç°è‡ªåŠ¨åŒ–æˆªå›¾</li><li><a href="https://github.com/fastlane/fastlane/tree/master/frameit" target="_blank" rel="noopener">frameit</a> =&gt; å¯ä»¥æŠŠæˆªçš„å›¾ç‰‡è‡ªåŠ¨å¥—ä¸Šä¸€å±‚å¤–è¾¹æ¡†</li></ul><h3 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h3><ul><li><a href="https://github.com/fastlane/fastlane/tree/master/produce" target="_blank" rel="noopener">produce</a> =&gt; å¦‚æœä½ çš„äº§å“è¿˜æ²¡åœ¨ iTunes Connect(iTC) æˆ–è€… Apple Developer Center(ADC) å»ºç«‹ï¼Œproduce å¯ä»¥è‡ªåŠ¨å¸®ä½ å®Œæˆè¿™äº›å·¥ä½œ</li><li><a href="https://github.com/fastlane/fastlane/tree/master/deliver" target="_blank" rel="noopener">deliver</a> =&gt; è‡ªåŠ¨ä¸Šä¼ æˆªå›¾ï¼ŒAPP çš„å…ƒæ•°æ®ï¼ŒäºŒè¿›åˆ¶ (ipa) æ–‡ä»¶åˆ° iTunes Connect</li></ul><h3 id="TestFlight-ç®¡ç†"><a href="#TestFlight-ç®¡ç†" class="headerlink" title="TestFlight ç®¡ç†"></a>TestFlight ç®¡ç†</h3><ul><li><a href="https://github.com/fastlane/fastlane/tree/master/pilot" target="_blank" rel="noopener">pilot</a> =&gt; ç®¡ç† <code>TestFlight</code> çš„æµ‹è¯•ç”¨æˆ·ï¼Œä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶</li><li><a href="https://github.com/fastlane/boarding" target="_blank" rel="noopener">boarding</a> =&gt; å»ºç«‹ä¸€ä¸ªæ·»åŠ æµ‹è¯•ç”¨æˆ·ç•Œé¢ï¼Œå‘ç»™æµ‹è¯•è€…ï¼Œå¯è‡ªè¡Œæ·»åŠ é‚®ä»¶åœ°å€ï¼Œå¹¶åŒæ­¥åˆ° <code>iTC</code></li></ul><h3 id="è¾…åŠ©å·¥å…·"><a href="#è¾…åŠ©å·¥å…·" class="headerlink" title="è¾…åŠ©å·¥å…·"></a>è¾…åŠ©å·¥å…·</h3><ul><li><a href="https://github.com/fastlane/fastlane/tree/master/spaceship" target="_blank" rel="noopener">spaceship</a> =&gt; ä¸º <code>pilot</code>ï¼Œ<code>boarding</code>å’Œ <code>deliver</code>ç­‰å·¥å…·æä¾›å’Œ iTC å’Œ ADC çš„äº¤äº’ APIã€‚<code>spaceship</code>æœ¬æ¥æ˜¯ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œåæ¥è¢« <code>Fastlane</code> æ”¶ç¼–è¿›æ¥</li><li><a href="https://github.com/fastlane/fastlane/tree/master/watchbuild" target="_blank" rel="noopener">WatchBuild</a> =&gt; æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ iTC ç›‘æ§å·¥å…·ï¼Œå¼€å¯ <code>WatchBuild</code> å¯ä»¥ç›‘æ§ iTC ä¸Šçš„æ–‡ä»¶çŠ¶æ€ï¼Œå¼¹å‡º MacOS è‡ªå¸¦çš„ Notification</li></ul><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><ul><li><a href="https://github.com/fastlane/fastlane/tree/master/supply#readme" target="_blank" rel="noopener">supply</a> =&gt; è‡ªåŠ¨ä¸Šä¼ åˆ° Google Play å·¥å…·</li><li><a href="https://github.com/fastlane/fastlane/tree/master/screengrab#readme" target="_blank" rel="noopener">screengrab</a> =&gt; Android çš„è‡ªåŠ¨æˆªå›¾å·¥å…·</li></ul><h2 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h2><p>fastlane å‘½ä»¤æ˜¯ä¸€ä¸ªæµç¨‹æ§åˆ¶çš„å‘½ä»¤è¡Œå·¥å…·(CLI)ï¼Œé€šè¿‡å†…éƒ¨é›†æˆ <code>action</code> å’Œç¬¬ä¸‰æ–¹çš„ <code>action</code> å®Œæˆä¸€ç³»åˆ—æ§åˆ¶æµç¨‹ã€‚è¿è¡Œ fastlane å‘½ä»¤è¡Œå·¥å…·ï¼Œä¼šè¯»å–å½“å‰ç›®å½•æˆ–è€… <code>./fastlane</code> ç›®å½•ä¸‹çš„ <code>Fastfile</code> é…ç½®æ–‡ä»¶ã€‚</p><p>åœ¨ <code>Fastfile</code> ä¸­ï¼š</p><ul><li><code>action</code> =&gt; Fastlane ä¸­çš„æ¯ä¸€æ¡å‘½ä»¤éƒ½æ˜¯ä¸€ä¸ªæ‰©å±•(action)ï¼Œä¸Šé¢æåˆ°çš„ <code>deliver</code>ï¼Œ<code>sigh</code>ä¹‹ç±»çš„å·¥å…·æœ¬èº«æ˜¯ CLIï¼Œä½†æ˜¯åœ¨ Fastlane ä¸­å†…åµŒäº†å¯¹ä»–ä»¬æ”¯æŒçš„ <code>action</code></li><li><code>lane</code> =&gt; Fastlane ä¸­æµç¨‹çš„åˆé›†ï¼Œæ¯ä¸€ä¸ªåŠ¨ä½œå³å¯ä»¥æ˜¯ <code>action</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„ <code>lane</code>ã€‚è¯­æ³•å’Œ ruby ä¸­çš„ rake éå¸¸åƒ</li></ul><p>ä¸€ä¸ªç®€å•çš„å‘å¸ƒæµç¨‹ï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">lane <span class="symbol">:deploy</span> <span class="keyword">do</span></span><br><span class="line">  <span class="comment"># æ‰§è¡Œ pod instasll</span></span><br><span class="line">  cocoapods</span><br><span class="line">  <span class="comment"># æ‰§è¡Œ carthage bootstrap</span></span><br><span class="line">  carthage</span><br><span class="line">  <span class="comment"># å¢åŠ buildç‰ˆæœ¬å·</span></span><br><span class="line">  increment_build_number</span><br><span class="line">  <span class="comment"># ç¼–è¯‘ä»£ç </span></span><br><span class="line">  gym</span><br><span class="line">  <span class="comment"># å‘å¸ƒåˆ°Apple Store</span></span><br><span class="line">  deliver(<span class="symbol">force:</span> <span class="literal">true</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>å¦‚æœ ruby ç‰ˆæœ¬æ»¡è¶³è¦æ±‚ï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… fastlane</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…fastlane</span></span><br><span class="line">sudo gem install -n /usr/<span class="built_in">local</span>/bin fastlane</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨çš„ç¯å¢ƒæ­å»ºå¥½äº†ï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥æ¥é…ç½® fastlane </p><h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><p>æ‰§è¡Œé»˜è®¤çš„åˆå§‹åŒ–</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd é¡¹ç›®ç›®å½•</span><br><span class="line">fastlane init</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„é¡¹ç›®åªæœ‰ä¸€ä¸ª bundle id ä¹Ÿåªæœ‰ä¸€ä¸ªå¼€å‘è€…è´¦å·çš„è¯ï¼Œå¯ä»¥ç›´æ¥éµå¾ªå®˜æ–¹çš„æ­¥éª¤é…ç½®ã€‚å¦åˆ™éœ€è¦æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ï¼Œé…ç½®ä¸åŒå‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Last login: Tue Aug  7 13:19:59 on ttys000</span><br><span class="line">yuhanle:360qws-G100 yuhanle$ fastlane init</span><br><span class="line">[âœ”] ğŸš€ </span><br><span class="line">[âœ”] Looking for iOS and Android projects in current directory...</span><br><span class="line">[13:33:35]: Created new folder './fastlane'.</span><br><span class="line">[13:33:35]: Detected an iOS/macOS project in the current directory: 'G100.xcworkspace'</span><br><span class="line">[13:33:35]: -----------------------------</span><br><span class="line">[13:33:35]: --- Welcome to fastlane ğŸš€ ---</span><br><span class="line">[13:33:35]: -----------------------------</span><br><span class="line">[13:33:35]: fastlane can help you with all kinds of automation for your mobile app</span><br><span class="line">[13:33:35]: We recommend automating one task first, and then gradually automating more over time</span><br><span class="line">[13:33:35]: What would you like to use fastlane for?</span><br><span class="line">1. ğŸ“¸  Automate screenshots</span><br><span class="line">2. ğŸ‘©â€âœˆï¸  Automate beta distribution to TestFlight</span><br><span class="line">3. ğŸš€  Automate App Store distribution</span><br><span class="line">4. ğŸ›   Manual setup - manually setup your project to automate your tasks</span><br><span class="line">?</span><br></pre></td></tr></table></figure><p>åœ¨æé—®äº†ä½ çš„ <code>Apple ID</code>ï¼Œ<code>Team</code> çš„é—®é¢˜ä¹‹åï¼Œfastlane ä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰ç›®å½•ä¸‹é¡¹ç›®çš„ <code>App Name</code> å’Œ <code>App Identifier</code>ã€‚å¦‚æœæ£€æµ‹çš„ä¸å¯¹ï¼Œé€‰æ‹© <code>n</code> è‡ªè¡Œè¾“å…¥ã€‚</p><p>æ¥ä¸‹æ¥ä¼šé—®ä½ è¿™ä¸ª app æ˜¯å¦éœ€è¦åœ¨ iTC å’Œ ADC ä¸­åˆ›å»º(ä¸Šä¸€æ­¥ä¸­å¦‚æœé€‰æ‹© <code>y</code> ä¼šè‡ªåŠ¨æ£€æµ‹æ˜¯å¦éœ€è¦åˆ›å»º)ï¼Œfastlane ä¼šè°ƒç”¨ <code>produce</code> è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœç°åœ¨è¿˜ä¸æƒ³åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ä¹‹åå†è¿è¡Œ <code>produce init</code> è¿›è¡Œè¿™ä¸ªæµç¨‹ã€‚å¦‚æœä¸æ‰§è¡Œ <code>produce</code> çš„æµç¨‹ï¼Œ<code>deliver</code> çš„æµç¨‹ä¹Ÿä¼šè¢«æ è¿‡ï¼Œå½“ç„¶ä¹‹åä¹Ÿå¯ä»¥ <code>deliver init</code> è¿è¡Œå®Œå…¨ä¸€æ ·çš„æµç¨‹ã€‚</p><p>åœ¨æ‰§è¡Œ <code>deliver init</code> çš„è¿‡ç¨‹ä¸­ï¼Œä¼šåŒæ­¥ iTC ä¸­çš„æ‰€æœ‰è¯­è¨€çš„å…ƒæ•°æ®å’Œæˆªå›¾ï¼Œå¹¶æŒ‰ç…§ç›®å½•ç»“æ„ç»„ç»‡å¥½ã€‚ç›®å½•ç»“æ„åº”è¯¥ç±»ä¼¼ä¸‹é¢ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">fastlane</span><br><span class="line">â”œâ”€â”€ Appfile</span><br><span class="line">â”œâ”€â”€ Deliverfile</span><br><span class="line">â”œâ”€â”€ Fastfile</span><br><span class="line">â”œâ”€â”€ metadata</span><br><span class="line">â”‚   â”œâ”€â”€ copyright.txt</span><br><span class="line">â”‚   â”œâ”€â”€ en-US</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ description.txt</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ keywords.txt</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ marketing_url.txt</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ name.txt</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ privacy_url.txt</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ release_notes.txt</span><br><span class="line">â”‚   â”‚   â””â”€â”€ support_url.txt</span><br><span class="line">â”‚   â”œâ”€â”€ primary_category.txt</span><br><span class="line">â”‚   â”œâ”€â”€ primary_first_sub_category.txt</span><br><span class="line">â”‚   â”œâ”€â”€ primary_second_sub_category.txt</span><br><span class="line">â”‚   â”œâ”€â”€ secondary_category.txt</span><br><span class="line">â”‚   â”œâ”€â”€ secondary_first_sub_category.txt</span><br><span class="line">â”‚   â”œâ”€â”€ secondary_second_sub_category.txt</span><br><span class="line">â”‚   â””â”€â”€ zh-Hans</span><br><span class="line">â”‚       â”œâ”€â”€ description.txt</span><br><span class="line">â”‚       â”œâ”€â”€ keywords.txt</span><br><span class="line">â”‚       â”œâ”€â”€ marketing_url.txt</span><br><span class="line">â”‚       â”œâ”€â”€ name.txt</span><br><span class="line">â”‚       â”œâ”€â”€ privacy_url.txt</span><br><span class="line">â”‚       â”œâ”€â”€ release_notes.txt</span><br><span class="line">â”‚       â””â”€â”€ support_url.txt</span><br><span class="line">â””â”€â”€ screenshots</span><br><span class="line">    â”œâ”€â”€ README.txt</span><br><span class="line">    â”œâ”€â”€ en-US</span><br><span class="line">    â”‚   â”œâ”€â”€ ä¸€å †pngå›¾ç‰‡</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè‚¯å®šä¼šè¢«åˆ›å»ºçš„æ˜¯ <code>Appfile</code> å’Œ <code>Fastfile</code>ã€‚å¦‚æœ <code>Deliverfile</code>ï¼Œ<code>screenshots</code> å’Œ <code>metadata</code> ç›®å½•æ²¡è¢«åˆ›å»ºï¼Œå¯ä»¥è¿è¡Œ <code>deliver init</code> æ¥åˆ›å»ºã€‚</p><ul><li>Fastfile =&gt; ç”¨æ¥å®šä¹‰æ‰€æœ‰çš„ lane ä»»åŠ¡ <a href="https://github.com/fastlane/fastlane/tree/master/fastlane/docs#fastfile" target="_blank" rel="noopener">Fastfileå¸®åŠ©</a></li><li>Appfile =&gt; æ˜¯ç”¨æ¥å­˜å‚¨ä¸€äº›å…¬å…±ä¿¡æ¯çš„ï¼Œæ¯”å¦‚ <code>app_identifier</code>ï¼Œ<code>apple_id</code>ï¼Œ<code>team_id</code>ï¼Œ<code>itc_team_id</code>ç­‰ã€‚<a href="https://github.com/fastlane/fastlane/blob/master/fastlane/docs/Appfile.md" target="_blank" rel="noopener">Appfileå¸®åŠ©</a></li><li>Deliverfile =&gt; <code>deliver</code> çš„é…ç½®æ–‡ä»¶ <a href="https://github.com/fastlane/fastlane/blob/master/deliver/Deliverfile.md" target="_blank" rel="noopener">Deliverfileå¸®åŠ©</a></li></ul><p><strong>PS</strong>:</p><ol><li>è¿™é‡Œæœ‰ä¸ªå°é—®é¢˜ï¼ŒiTC å’Œ ADC ä¸­çš„ <code>Team ID</code> æ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨ <code>fastlane init</code> ä¸­åªä¼šè‡ªåŠ¨åœ¨ Appfile é‡Œå†™å…¥ ADC çš„ <code>team_id</code>ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šä¸åœçš„é—®ä½  iTC çš„ <code>Team ID</code>ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºå®Œ Appfile åï¼Œæ‰‹åŠ¨åœ¨é‡Œé¢æ·»åŠ  <code>itc_team_id</code>ã€‚</li><li>è¿™ä¸ªé—®ç­”å¯¹ä¸åŒçš„é¡¹ç›®å¯èƒ½æœ‰å„ç§å„æ ·çš„åˆ†æ”¯ã€‚æˆ‘å·²ç»ç”¨ä¸åŒçš„é¡¹ç›®è¯•è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œä½†æ˜¯å¯èƒ½è¿˜ä¸æ˜¯å…¨éƒ¨ï¼Œæ‰€ä»¥ä½ è¿˜éœ€è¦è§æ‹›æ‹†æ‹›ã€‚</li><li>åœ¨è¿™é‡Œå¯ä»¥å®‰å¿ƒçš„è¾“å…¥å¯†ç ï¼Œæ‰€æœ‰çš„å¯†ç éƒ½åŠ å¯†ä¿å­˜åœ¨ç³»ç»Ÿçš„ Keychain é‡Œã€‚</li></ol><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p><img src="http://cdn.yuhanle.com/fastlane/QQ20180807-133643@2x.png" alt></p><p>fastlane å¯ä»¥é€šè¿‡é…ç½®  .env æ–‡ä»¶ã€Appfileã€Deliverfileã€Fastfile æ¥å®Œæˆå„ç§å·¥ä½œã€‚</p><p>å…¶ä¸­ Fastfile æ˜¯æœ€æ ¸å¿ƒçš„ç”¨æ¥æ§åˆ¶æµç¨‹èµ°å‘çš„é…ç½®æ–‡ä»¶ï¼Œ.env å’Œ Appfile å¯ä»¥è¾…åŠ© Fastfile æ¥è®¾ç½®ä¸€äº›å‚æ•°ï¼ŒDeliverfile å¯ç”¨äºé…ç½®æäº¤ iTunesConnect çš„ä¸€äº›å‚æ•°ã€‚</p><p>éœ€è¦æŸ¥çœ‹ï¼Œæ ·ä¾‹é…ç½®å¯ç›´æ¥å‰å¾€<a href="http://devhy.com/2018/01/23/26-fastlane-usage/#%E4%B8%8B%E8%BD%BD%E6%A0%B7%E4%BE%8B%E9%85%8D%E7%BD%AE" target="_blank" rel="noopener">ä¸‹è½½æ ·ä¾‹é…ç½®</a></p><h4 id="Appfile"><a href="#Appfile" class="headerlink" title="Appfile"></a>Appfile</h4><p>Appfileæ˜¯ç”¨æ¥é…ç½®ä¸€äº›ç±»ä¼¼äº AppleIDã€BundleID å‚æ•°(å‚æ•°æ˜¯ fastlane å·²ç»å®šä¹‰å¥½çš„ï¼Œæ–°å¢çš„å¹¶æ²¡æœ‰ç”¨ï¼Œå¦‚æœæƒ³æ–°å¢å˜é‡éœ€è¦ä½¿ç”¨ .env æ–¹å¼)ï¼Œå¯ä»¥åœ¨ Fastfile ä¸­ä½¿ç”¨ï¼ŒAppleIDã€BundleID ç­‰å…¶å®ä¼šè¢«ä¸€äº› actions ç›´æ¥è°ƒç”¨ï¼Œå¹¶ä¸éœ€è¦å†™å‡ºæ¥ä¼ é€’ã€‚</p><h5 id="æ™®é€šé…ç½®æ–¹å¼"><a href="#æ™®é€šé…ç½®æ–¹å¼" class="headerlink" title="æ™®é€šé…ç½®æ–¹å¼"></a>æ™®é€šé…ç½®æ–¹å¼</h5><p>ç›´æ¥åœ¨ Appfile é‡Œå¡«å†™ app_identifierã€apple_idã€team_id ç­‰ï¼Œç„¶åæ ¹æ® lane çš„ä¸åŒå¯ä»¥è®¾ç½®æˆä¸åŒã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤é…ç½®</span></span><br><span class="line">app_identifier <span class="string">"com.xxxxxxxxxx.test"</span></span><br><span class="line">apple_id <span class="string">"xxxxxxxxxx@xxxx.com"</span></span><br><span class="line">team_id <span class="string">"xxxxxxxxxx"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœlaneæ˜¯entæ¢æˆDevçš„é…ç½®</span></span><br><span class="line">for_lane <span class="symbol">:ent</span> <span class="keyword">do</span></span><br><span class="line">  app_identifier <span class="string">"com.xxxxxxxxxx.testDev"</span></span><br><span class="line">  apple_id <span class="string">"xxxxxxxxxx@xxxx.com"</span></span><br><span class="line">  TEAM_ID <span class="string">"xxxxxxxxxx"</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨-env-é…ç½®æ–¹å¼"><a href="#ä½¿ç”¨-env-é…ç½®æ–¹å¼" class="headerlink" title="ä½¿ç”¨ .env é…ç½®æ–¹å¼"></a>ä½¿ç”¨ .env é…ç½®æ–¹å¼</h5><p><a href="https://docs.fastlane.tools/advanced/#environment-variables" target="_blank" rel="noopener">.env</a> è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨æ˜¯ä½œä¸ºç¯å¢ƒå˜é‡çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨ fastlane init è¿›è¡Œåˆå§‹åŒ–åå¹¶ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œå¦‚æœéœ€è¦å¯ä»¥è‡ªå·±åˆ›å»ºã€‚</p><p>æ‰§è¡Œæ—¶é»˜è®¤ä¼šè¯»å– <code>.env</code> å’Œ <code>.env.default</code> æ–‡ä»¶é‡Œçš„é…ç½®ã€‚é€šè¿‡æ‰§è¡Œ <code>fastlane [lane-name] --env [envName]</code> æ¥æŒ‡å®šä½¿ç”¨é…ç½®æ–‡ä»¶ <code>.env.[envName]</code>ï¼Œè¯»å–é¡ºåºæ˜¯ <code>.env -&gt; .env.default -&gt; .env.&lt;envName&gt;</code>ï¼Œç›¸åŒçš„å˜é‡åä¼šè¢«åé¢çš„è¦†ç›–ã€‚</p><p>å¦‚æˆ‘å»ºäº†æ–‡ä»¶ .env.myDevï¼Œé‡Œé¢å†™äº†ä¸€äº›å‚æ•°ï¼Œé‚£åœ¨æ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨ <code>fastlane [lane-name] --env myDev</code> å³å¯ï¼Œæƒ³åœ¨ Appfileã€Deliverfileã€Fastfile ç­‰è°ƒç”¨ï¼Œç›´æ¥ä½¿ç”¨ <code>ENV[&#39;keyName&#39;]</code> å³å¯</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env.myDevæ–‡ä»¶</span></span><br><span class="line"><span class="comment"># bundle id</span></span><br><span class="line">App_Identifier = <span class="string">"com.xxxxxxxxxx.testDev"</span></span><br><span class="line"><span class="comment"># å¼€å‘è€…è´¦å·</span></span><br><span class="line">Apple_Id = <span class="string">"xxxxxxxxxx@xxxx.com"</span></span><br><span class="line"><span class="comment"># å¼€å‘è€…TeamId</span></span><br><span class="line">Team_Id  = <span class="string">"xxxxxxxxxx"</span></span><br><span class="line"><span class="comment"># projectçš„target schemeåç§°</span></span><br><span class="line">Scheme   = <span class="string">"xxxxxxxxxx"</span></span><br></pre></td></tr></table></figure><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Appfileä½¿ç”¨.envæ–¹å¼ç›´æ¥è¯»å–å˜é‡å³å¯</span></span><br><span class="line">app_identifier ENV[<span class="string">'App_Identifier'</span>]</span><br><span class="line">apple_id  ENV[<span class="string">'Apple_Id'</span>]</span><br><span class="line">team_id ENV[<span class="string">'Team_Id'</span>]</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šå› ä¸ºæ˜¯ .env æ–‡ä»¶æ˜¯.å¼€å¤´æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯åœ¨ finder ä¸­éšè—çš„ï¼Œéœ€è¦é€šè¿‡æ‰§è¡Œä¸€ä¸‹å‘½ä»¤æ¥æ˜¾ç¤º</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®éšè—æ–‡ä»¶å¯è§</span></span><br><span class="line">defaults write com.apple.finder AppleShowAllFiles TRUE</span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯finderæœåŠ¡ä»¥ç”Ÿæ•ˆ</span></span><br><span class="line">killall Finder</span><br></pre></td></tr></table></figure><h5 id="é…ç½®æ–¹å¼å¯¹æ¯”"><a href="#é…ç½®æ–¹å¼å¯¹æ¯”" class="headerlink" title="é…ç½®æ–¹å¼å¯¹æ¯”"></a>é…ç½®æ–¹å¼å¯¹æ¯”</h5><ul><li>æ™®é€šé…ç½®æ–¹å¼ï¼šç®€å•æ˜“æ‡‚ï¼Œä½†ä¸èƒ½è‡ªå®šä¹‰å˜é‡ï¼Œä¸”æ¯ä¸ª lane æƒ³ä¸ä¸€æ ·éƒ½è¦å†™ä¸€ä¸ª for_lane</li><li>.env é…ç½®æ–¹å¼ï¼šåŠŸèƒ½æ€§å¼ºï¼Œä½†é…ç½®èµ·æ¥ç¨å¾®éº»çƒ¦ä¸€ç‚¹</li></ul><h4 id="Fastfile"><a href="#Fastfile" class="headerlink" title="Fastfile"></a>Fastfile</h4><p>Fastfile æ˜¯å¯¹æµç¨‹è¿›è¡Œæ§åˆ¶çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œéœ€è¦è®¾å®šæ”¯æŒçš„å¹³å°å’Œåœ¨ä¸€äº›ç¯èŠ‚é‡Œéœ€è¦åšçš„äº‹æƒ…ï¼Œæ˜¯æˆ‘ä»¬è„šæœ¬çš„å…¥å£ï¼Œæ‰€æœ‰çš„äº‹ä»¶é©±åŠ¨éƒ½æ˜¯åœ¨è¿™ä¸ªæ–‡ä»¶æ¥è°ƒåº¦çš„ã€‚</p><h5 id="Lane"><a href="#Lane" class="headerlink" title="Lane"></a><a href="https://github.com/fastlane/fastlane/tree/master/lane" target="_blank" rel="noopener">Lane</a></h5><p>æœ‰äº† <code>Fastfile</code>ï¼Œå°±å¯ä»¥æ·»åŠ è‡ªå·±çš„å‘å¸ƒæµç¨‹äº†ã€‚æ‰“å¼€Fastfileæ–‡ä»¶(è¿™é‡Œæˆ‘ç”¨Sublime è®¾å®šè¯­æ³•ä¸ºRuby)ï¼Œå¦‚æœä¸å‡ºæ„å¤–çš„è¯ä½ ç”Ÿæˆçš„Fastfileå’Œæˆ‘åº”è¯¥å·®ä¸å¤šã€‚è¿™é‡Œæˆ‘å°±ä¸è´´å‡ºæ¥äº†ã€‚</p><p>æœ€å¼€å§‹å®šä¹‰äº†</p><ul><li><code>fastlane_version</code> =&gt; æŒ‡å®šfastlaneæœ€å°ç‰ˆæœ¬</li><li><code>default_platform</code> =&gt; æŒ‡å®šå½“å‰å¹³å°ï¼Œå¯é€‰ <code>ios,android,mac</code></li></ul><p>åœ¨ <code>platform</code> ä¸­å°±æ˜¯éœ€è¦ä¿®æ”¹çš„é‡ç‚¹ã€‚å…ˆå¿½ç•¥ <code>before_all</code>ï¼Œ<code>after_all</code>ï¼Œ<code>error</code> è¿™äº›æ–¹æ³•ï¼Œè¿™é‡Œçš„ <code>lane</code> å°±æ˜¯ä¸€ç»„ä»»åŠ¡ï¼Œä¸Šä¼ åˆ° Firim çš„ä»»åŠ¡å¦‚ä¸‹</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">lane <span class="symbol">:to_firim</span> <span class="keyword">do</span></span><br><span class="line">  <span class="comment"># å¦‚æœä½ ç”¨ pod install æ³¨æ„å‚æ•° -&gt; å¦åˆ™ä¼šå‡ºé”™</span></span><br><span class="line">  cocoapods(<span class="symbol">use_bundle_exec:</span> <span class="literal">false</span>)</span><br><span class="line">  <span class="comment"># å¦‚æœä½ æ²¡æœ‰ç”³è¯·adhocè¯ä¹¦ï¼Œsighä¼šè‡ªåŠ¨å¸®ä½ ç”³è¯·ï¼Œå¹¶ä¸”æ·»åŠ åˆ°Xcodeé‡Œ</span></span><br><span class="line">  sigh(<span class="symbol">adhoc:</span> <span class="literal">true</span>)</span><br><span class="line">  <span class="comment"># ä»¥ä¸‹ä¸¤ä¸ªactionæ¥è‡ªfastlane-plugin-versioningï¼Œ</span></span><br><span class="line">  <span class="comment"># ç¬¬ä¸€ä¸ªé€’å¢ Buildï¼Œç¬¬äºŒä¸ªè®¾å®šVersionã€‚</span></span><br><span class="line">  <span class="comment"># å¦‚æœä½ æœ‰å¤šä¸ªtargetï¼Œå°±å¿…é¡»æŒ‡å®štargetçš„å€¼ï¼Œå¦åˆ™å®ƒä¼šç›´æ¥æ‰¾æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªplistä¿®æ”¹</span></span><br><span class="line">  <span class="comment"># åœ¨è¿™é‡Œæˆ‘å»ºè®®æ¯ä¸€ä¸ªæ‰“çš„åŒ…çš„Buildéƒ½è¦ä¸ä¸€æ ·ï¼Œè¿™æ ·crashäº†æ‹¿åˆ°æ—¥å¿—ï¼Œå¯ä»¥å¯¹åº”åˆ°ipaä¸Š</span></span><br><span class="line">  increment_build_number_in_plist(<span class="symbol">target:</span> [target_name])</span><br><span class="line">  increment_version_number_in_plist(</span><br><span class="line">    <span class="symbol">target:</span> [target_name],</span><br><span class="line">    <span class="symbol">version_number:</span> <span class="string">'7.1.3'</span></span><br><span class="line">    )</span><br><span class="line">  <span class="comment"># gymç”¨æ¥ç¼–è¯‘ipa</span></span><br><span class="line">  gym(</span><br><span class="line">    <span class="symbol">output_directory:</span> <span class="string">'./firim'</span>,</span><br><span class="line">    <span class="symbol">export_options:</span> &#123;</span><br><span class="line">      <span class="symbol">method:</span> <span class="string">"ad-hoc"</span>, <span class="comment"># è¿™å¯ä»¥ä¸æŒ‡å®š</span></span><br><span class="line">      <span class="symbol">thinning:</span> <span class="string">"&lt;none&gt;"</span></span><br><span class="line">    &#125;</span><br><span class="line">    )</span><br><span class="line">  <span class="comment"># ä¸Šä¼ ipaåˆ°fir.imæœåŠ¡å™¨ï¼Œåœ¨fir.imè·å–firim_api_token</span></span><br><span class="line">  firim(<span class="symbol">firim_api_token:</span> [firim_api_token])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h5 id="Sigh"><a href="#Sigh" class="headerlink" title="Sigh"></a><a href="https://github.com/fastlane/fastlane/tree/master/sigh" target="_blank" rel="noopener">Sigh</a></h5><p>å¦‚æœä½ ä¸ç¡®å®šè¯ä¹¦ç›®å‰æ˜¯å¦å¯ç”¨ï¼Œå¯ä»¥ç”¨ Sigh è‡ªåŠ¨ç”Ÿæˆè·å–è¯ä¹¦ã€‚Sigh ä¼šè‡ªåŠ¨æ ¹æ® Appfile é‡Œè®¾ç½®çš„ <code>app_identifier</code>ä» ADC (è‹¹æœå¼€å‘è€…ä¸­å¿ƒ)ç”Ÿæˆè¯ä¹¦ï¼Œå¹¶ä¸‹è½½åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹(ä¸æ˜¯ fastlane ç›®å½•)ï¼Œä¸‹è½½åè‡ªåŠ¨å®‰è£…ã€‚ä½ å¯ä»¥é€šè¿‡æŒ‡å®š <code>output_path</code> æŒ‡å®šè¯ä¹¦ä¸‹è½½ä½ç½®ã€‚</p><p>PSï¼šå»ºè®®ä¸è¦æŠŠè¿™ä¸ªæ–‡ä»¶å¤¹åŒæ­¥åˆ°é¡¹ç›®çš„ git ä¸­( Fastlane æä¾›äº† <code>match</code> ä¸“é—¨ç®¡ç†æ‰€æœ‰è¯ä¹¦)ã€‚å¯ä»¥åœ¨ .gitignore ä¸­å¯ä»¥å¿½ç•¥è¿™ä¸ªæ–‡ä»¶å¤¹ã€‚</p><p>Sigh å¸¸ç”¨çš„é…ç½®é¡¹ï¼š</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td>adhoc</td><td>bool</td><td>è·å–adhocè¯ä¹¦</td><td>fasle</td></tr><tr><td>development</td><td>bool</td><td>æ›´æ–°å¼€å‘è¯ä¹¦ï¼Œä¸æ›´æ–°<code>production</code>è¯ä¹¦</td><td>false</td></tr><tr><td>force</td><td>bool</td><td>å¼ºåˆ¶æ›´æ–°è¯ä¹¦ï¼Œä¸ç®¡è¯ä¹¦æ˜¯å¦åœ¨ADCä¸­å­˜åœ¨</td><td>false</td></tr></tbody></table><p>iOS é‡Œ code æ‰“åŒ…è¯ä¹¦æœ‰ 4 ç§ï¼Œadhocï¼Œinhouseï¼Œappstoreï¼Œdevelopment è¯ä¹¦ã€‚</p><table><thead><tr><th></th><th>ä»·æ ¼</th><th>AppStore è¯ä¹¦</th><th>In-House è¯ä¹¦</th><th>AdHoc è¯ä¹¦</th><th>Development è¯ä¹¦</th></tr></thead><tbody><tr><td>ä¼ä¸šå¸æˆ·</td><td>$299</td><td></td><td>âˆš</td><td>âˆš</td><td>âˆš</td></tr><tr><td>å…¬å¸è´¦å·</td><td>$99</td><td>âˆš</td><td></td><td>âˆš</td><td>âˆš</td></tr><tr><td>ä¸ªäººè´¦æˆ·</td><td>$99</td><td>âˆš</td><td></td><td>âˆš</td><td>âˆš</td></tr></tbody></table><p>å…¶ä¸­ <code>In-House</code> çš„æ–¹å¼æ‰“åŒ…çš„ipaå®‰è£…æ²¡æœ‰è®¾å¤‡çš„é™åˆ¶ã€‚<code>AdHoc</code> æ‰“åŒ…çš„ ipa å¿…é¡»æå‰æŠŠè®¾å¤‡çš„ UDID æ·»åŠ åˆ°è¯ä¹¦ä¸­ï¼Œå¹¶ä¸”æœ‰ 100 å°è®¾å¤‡é™åˆ¶ã€‚</p><p>æ‰€ä»¥å¦‚æœä½ ä¸æŒ‡å®š <code>adhoc</code> ä¸º <code>true</code>ï¼ŒSigh ä¼šè¯†åˆ«å¸æˆ·ç±»å‹ï¼Œä¼ä¸šå¸æˆ·é»˜è®¤ç”Ÿæˆ <code>In-House</code> è¯ä¹¦ï¼Œå…¬å¸è´¦å·å’Œä¸ªäººå¸æˆ·é»˜è®¤ç”Ÿæˆ AppStore è¯ä¹¦ã€‚</p><h5 id="Gym"><a href="#Gym" class="headerlink" title="Gym"></a><a href="https://github.com/fastlane/fastlane/tree/master/gym" target="_blank" rel="noopener">Gym</a></h5><p>Gym å¸¸ç”¨é…ç½®é¡¹ï¼š</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td>scheme</td><td>string</td><td>æŒ‡å®šéœ€è¦ç¼–è¯‘çš„scheme</td><td></td></tr><tr><td>clean</td><td>bool</td><td>æ˜¯å¦åœ¨ç¼–è¯‘å‰clean</td><td>false</td></tr><tr><td>output_directory</td><td>string</td><td>å¯¼å‡ºç›®å½•</td><td><code>./</code></td></tr><tr><td>output_name</td><td>string</td><td>å¯¼å‡ºipaåå­—</td><td>[app_name].ipa</td></tr><tr><td>export_options</td><td>hash/string</td><td>è¿™é‡ŒæŒ‡å®šXcode APIçš„å¤–éƒ¨é…ç½®æ–‡ä»¶åœ°å€ï¼Œæˆ–è€…é…ç½®hashï¼Œè§ä¸‹æ–‡</td><td></td></tr><tr><td>export_method</td><td>string</td><td>æ‰“åŒ…æ–¹å¼ï¼Œå¯é€‰é¡¹<code>app-store</code> <code>ad-hoc`</code>package<code></code>enterprise<code>development</code>developer-id`</td><td>å¦‚æœåœ¨fastlaneä¸­ä½¿ç”¨äº†sighï¼Œè¿™ä¸ªå€¼ä¼šä»ä¸Šä¸‹æ–‡è·å–</td></tr><tr><td>include_bitcode</td><td>bool</td><td>æ˜¯å¦å¼€å¯<code>bitcode</code></td><td>Xcode API é»˜è®¤å€¼ä¸ºtrue</td></tr><tr><td>include_symbols</td><td>bool</td><td>æ˜¯å¦ç”Ÿæˆç¬¦å·è¡¨</td><td>Xcode API é»˜è®¤å€¼ä¸ºtrue</td></tr></tbody></table><p>Xcode7 ä¹‹åï¼ŒXcode API å…è®¸æˆ‘ä»¬æŒ‡å®šä¸€ä¸ª <code>plist</code> æ–‡ä»¶ä½œä¸ºé¢å¤–çš„é…ç½®æ–‡ä»¶ã€‚gym é»˜è®¤ä¼šå¸®ä½ åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œä½ å¯ä»¥ç›´æ¥æŒ‡å®šé…ç½®ã€‚æ›´å¤šå…³äº plist å¯é…ç½®é¡¹ï¼Œæ‰§è¡Œ <code>xcodebuild -help</code> æŸ¥çœ‹ <code>Available keys for -exportOptionsPlist</code>ã€‚</p><p><code>export_method</code>ï¼Œ <code>include_symbols</code>ï¼Œå’Œ <code>include_bitcode</code>  è¿™äº›å‚æ•°éƒ½æ˜¯ <code>exportOptionsPlist</code> çš„é…ç½®ï¼Œå¯¹åº” <code>method</code>ï¼Œ<code>uploadSymbols</code> å’Œ <code>uploadBitcode</code>ã€‚</p><p>Gym å¯ä»¥æŒ‡å®šé…ç½®æ–‡ä»¶ <a href="https://github.com/fastlane/fastlane/tree/master/gym#gymfile" target="_blank" rel="noopener"><code>Gymfile</code></a>ã€‚ </p><p>åˆå§‹åŒ–ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gym init</span><br></pre></td></tr></table></figure><h4 id="Multi-Target"><a href="#Multi-Target" class="headerlink" title="Multi-Target"></a>Multi-Target</h4><p>å¦‚æœæˆ‘ä»¬éœ€è¦é…ç½®å¤šä¸ª target è¿›è¡Œæ‰“åŒ…çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://link.juejin.im?target=https%3A%2F%2Fdocs.fastlane.tools%2Fadvanced%2F%23environment-variables" target="_blank" rel="noopener">ç¯å¢ƒå˜é‡</a>ï¼Œæ¥è¿›è¡Œé…ç½®ã€‚å‡å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ª <code>target</code>ï¼Œ<code>targetA</code> å’Œ <code>targetB</code>ï¼Œåˆ™æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸¤ä¸ª <code>.env</code> æ–‡ä»¶ï¼Œä¾‹å¦‚ <code>.env.targetA</code>ï¼Œ<code>.env.targetB</code>ï¼Œæ”¾åœ¨ <code>Fastfile</code> æ–‡ä»¶åŒçº§ç›®å½•ä¸‹</p><p>åœ¨ <code>.env</code> æ–‡ä»¶é‡Œé¢æˆ‘ä»¬å¯ä»¥é…ç½®ä¸€äº›ä¸åŒçš„å†…å®¹ï¼ˆéå…¬å…±ï¼‰ï¼Œæ¯”å¦‚ <code>app_identifier</code>ï¼Œ<code>release_notes</code> ç­‰ç­‰ã€‚æˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="http://cdn.yuhanle.com/fastlane/QQ20180807-142523@2x.png" alt></p><p>åœ¨ <code>Appfile</code>ï¼Œ<code>Deliverfile</code>ï¼Œ<code>Fastfile</code> ç­‰æ–‡ä»¶ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>.env</code> æ–‡ä»¶é‡Œé¢çš„å†…å®¹ã€‚</p><p>Appfile</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Appfile</span><br><span class="line"></span><br><span class="line">#The bundle identifier of your app</span><br><span class="line">app_identifier ENV[&apos;APP_IDENTIFIER&apos;]</span><br><span class="line"></span><br><span class="line"># Your Apple email address</span><br><span class="line">apple_id ENV[&apos;APPLE_ID&apos;] </span><br><span class="line"></span><br><span class="line"># Developer Portal Team ID</span><br><span class="line">team_id ENV[&apos;TEAM_ID&apos;]</span><br><span class="line"></span><br><span class="line">å¤åˆ¶ä»£ç </span><br></pre></td></tr></table></figure><p>Deliverfileï¼Œ<strong>è¯·åœ¨è®¾ç½® release_noresã€support_urlã€private_url ç­‰é…ç½®çš„æ—¶å€™ï¼Œé‡‡ç”¨ hash çš„æ–¹å¼å†™ã€‚</strong></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app_identifier</span></span><br><span class="line">app_identifier ENV[<span class="string">'APP_IDENTIFIER'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·å,Apple IDç”µå­é‚®ä»¶åœ°å€</span></span><br><span class="line">username ENV[<span class="string">'APPLE_ID'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›¢é˜ŸID</span></span><br><span class="line">team_id ENV[<span class="string">'TEAM_ID'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›¢é˜Ÿname</span></span><br><span class="line">team_name ENV[<span class="string">'TEAM_NAME'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># copyright</span></span><br><span class="line">copyright ENV[<span class="string">'COPYRIGHT'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é”®å­—</span></span><br><span class="line">keywords(</span><br><span class="line"><span class="string">'zh-Hans'</span> =&gt; ENV[<span class="string">'KEYWORDS'</span>],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°ç‰ˆæœ¬ä¿®æ”¹è®°å½•</span></span><br><span class="line">release_notes(</span><br><span class="line"><span class="comment"># ä¸­å›½</span></span><br><span class="line"><span class="string">'zh-Hans'</span> =&gt; ENV[<span class="string">'RELEASE_NOTES'</span>],</span><br><span class="line"><span class="comment"># æ¾³å¤§åˆ©äºš</span></span><br><span class="line"><span class="string">'en-au'</span> =&gt; ENV[<span class="string">'RELEASE_NOTES_AU'</span>],</span><br><span class="line"><span class="comment"># ç¾å›½</span></span><br><span class="line"><span class="string">'en-us'</span> =&gt; ENV[<span class="string">'RELEASE_NOTES_US'</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¯æŒç½‘å€</span></span><br><span class="line">support_url(</span><br><span class="line"><span class="comment"># ä¸­å›½</span></span><br><span class="line"><span class="string">'zh-Hans'</span> =&gt; ENV[<span class="string">'SUPPORT_URL'</span>],</span><br><span class="line"><span class="comment"># æ¾³å¤§åˆ©äºš</span></span><br><span class="line"><span class="string">'en-au'</span> =&gt; ENV[<span class="string">'SUPPORT_URL_AU'</span>],</span><br><span class="line"><span class="comment"># ç¾å›½</span></span><br><span class="line"><span class="string">'en-us'</span> =&gt; ENV[<span class="string">'SUPPORT_URL_US'</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># éšç§æ”¿ç­–ç½‘å€ å›½å®¶ä»£ç  https://www.cnblogs.com/Mien/archive/2008/08/22/1273950.html</span></span><br><span class="line">privacy_url(</span><br><span class="line"><span class="comment"># ä¸­å›½</span></span><br><span class="line"><span class="string">'zh-Hans'</span> =&gt; ENV[<span class="string">'PRIVACY_URL'</span>],</span><br><span class="line"><span class="comment"># æ¾³å¤§åˆ©äºš</span></span><br><span class="line"><span class="string">'en-au'</span> =&gt; ENV[<span class="string">'PRIVACY_URL_AU'</span>],</span><br><span class="line"><span class="comment"># ç¾å›½</span></span><br><span class="line"><span class="string">'en-us'</span> =&gt; ENV[<span class="string">'PRIVACY_URL_US'</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ å®Œæˆåæäº¤æ–°ç‰ˆæœ¬è¿›è¡Œå®¡æŸ¥</span></span><br><span class="line">submit_for_review <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·³è¿‡HTMLæŠ¥å‘Šæ–‡ä»¶éªŒè¯</span></span><br><span class="line">force <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ç”¨iTCçš„åˆ†é˜¶æ®µå‘å¸ƒåŠŸèƒ½ ç°åº¦å‘å¸ƒ</span></span><br><span class="line">phased_release <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨å®¡æ ¸å°ç»„çš„è”ç³»ä¿¡æ¯ app å®¡æ ¸ä¿¡æ¯</span></span><br><span class="line">app_review_information(</span><br><span class="line">  <span class="symbol">first_name:</span> <span class="string">"xx"</span>,</span><br><span class="line">  <span class="symbol">last_name:</span> <span class="string">"xx"</span>,</span><br><span class="line">  <span class="symbol">phone_number:</span> <span class="string">"+86 18888888888"</span>,</span><br><span class="line">  <span class="symbol">email_address:</span> <span class="string">"xxxx"</span>,</span><br><span class="line">  <span class="symbol">demo_user:</span> <span class="string">"test1@test.com"</span>,</span><br><span class="line">  <span class="symbol">demo_password:</span> <span class="string">"test123"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="Deliver"><a href="#Deliver" class="headerlink" title="Deliver"></a><a href="https://github.com/fastlane/fastlane/tree/master/deliver" target="_blank" rel="noopener">Deliver</a></h4><p>Deliver å¯ä»¥å®Œå…¨ç®¡ç†ä¸ iTC çš„äº¤äº’ã€‚å…¶ä¸­åŒ…æ‹¬ï¼š</p><ul><li>ä¸Šä¼ å’Œä¸‹è½½å¤šè¯­è¨€æˆªå›¾</li><li>ä¸Šä¼ å’Œä¸‹è½½å¤šè¯­è¨€å…ƒæ•°æ®</li><li>ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶</li></ul><p>è¿˜è®°å¾—ä¸Šé¢<a href="https://whlsxl.github.io/fastlane1/#init" target="_blank" rel="noopener">åˆå§‹åŒ–</a>çš„æ—¶å€™åˆå§‹åŒ–çš„ <code>metadata</code>ï¼Œ<code>screenshots</code> ç›®å½•ä¹ˆï¼ŸiTC ä¸­çš„æ‰€æœ‰çš„å…ƒæ•°æ®ä¿¡æ¯éƒ½è¢«ä¿å­˜åœ¨ <code>metadata</code> ä¸­ï¼Œæ‰€æœ‰çš„æˆªå›¾ä¿¡æ¯éƒ½è¢«ä¿å­˜åœ¨ <code>screenshots</code> ä¸­ã€‚</p><p>metadataï¼š</p><ul><li>å¯ä»¥å¾ˆå®¹æ˜“çš„ç®¡ç†å¯¹åº”ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œ iTC åå°çš„è¡¨å•é¡¹ï¼Œåœ¨æ‰§è¡Œ <code>deliver</code> æ—¶ä¼šè‡ªåŠ¨è¢«ä¼ åˆ° iTCã€‚</li><li>åœ¨ <code>metadata</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¦‚ <code>copyright.txt</code>ï¼Œæ˜¯æ²¡æœ‰æœ¬åœ°åŒ–çš„ï¼Œåœ¨äºŒå±‚ç›®å½•ä¸­çš„æ–‡ä»¶éƒ½æ˜¯éœ€è¦å¯¹åº”ä¸åŒè¯­è¨€çš„è¡¨å•é¡¹ã€‚</li><li>å¦‚æœä½ ä¸æƒ³ä¿®æ”¹æŸäº›é¡¹çš„ä¿¡æ¯ï¼Œç›´æ¥æŠŠå¯¹åº”çš„æ–‡ä»¶åˆ é™¤å³å¯ã€‚</li><li>æ‰€æœ‰è¿™äº›è¡¨å•é¡¹ä¹Ÿå¯ä»¥åœ¨ <code>Deliverfile</code> ä¸­æŒ‡å®šï¼Œ<code>Deliverfile</code> ä¸­æŒ‡å®šçš„é¡¹ä¼˜å…ˆçº§æ¯”æ–‡ä»¶é«˜</li></ul><p>screenshotsï¼š</p><ul><li>å¦‚æœä¸æƒ³æ›´æ”¹æˆªå›¾ï¼Œå¯ä»¥æŠŠæ•´ä¸ªæˆªå›¾ç›®å½•åˆ é™¤</li><li>å¦‚æœä¸ä½¿ç”¨ <code>snapshot</code> (è‡ªåŠ¨åŒ–æˆªå›¾)ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æˆªå›¾æ”¾åˆ°å¯¹åº”ç›®å½•ä¸‹ï¼Œæ¯”ä¸€å¼ ä¸€å¼ ä¸Šä¼  iTC å¿«çš„å¤šã€‚æˆªå›¾åœ¨iTC ä¸­çš„æ’åˆ—é¡ºåºå°±æ˜¯æœ¬åœ°æ–‡ä»¶åçš„ã€Œå­—æ¯è¡¨é¡ºåºã€(åœ¨ç›®å½•ä¸­å³å‡»ï¼ŒæŒ‰æ–‡ä»¶åæ’åº)ã€‚<code>deliver</code>ä¼šè¯†åˆ«å›¾ç‰‡åˆ†è¾¨ç‡ï¼Œä¸Šä¼ åˆ°å¯¹åº”è®¾å¤‡ä¸­ã€‚</li></ul><p>å¦‚æœè¦é€šè¿‡ <code>deliver</code> ä¿®æ”¹å…ƒæ•°æ®æˆ–æˆªå›¾ï¼Œä½ å¿…é¡»æä¾›æ‰€æœ‰ iTC ä¸­æœ‰çš„è¯­è¨€ã€‚æ¯”å¦‚åå°ä¸­æœ‰ã€Œç®€ä½“ä¸­æ–‡ã€å’Œã€Œè‹±æ–‡ã€ï¼Œä½ ä¹Ÿå¿…é¡»æä¾›å¯¹åº”çš„ <code>zh-Hans</code> å’Œ <code>en-US</code> æ–‡ä»¶ï¼Œå¦åˆ™ <code>deliver</code> ä¼šæŠ¥ç¼ºå°‘è¯­è¨€çš„é”™è¯¯ã€‚å¯ä»¥åœ¨ iTC åå°æäº¤çš„ç‰ˆæœ¬ä¸­åˆ é™¤è¯­è¨€ã€‚</p><p>Deliver å¸¸ç”¨é…ç½®é¡¹ï¼š</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td>ipa</td><td>string</td><td><code>ipa</code>åœ°å€</td><td>å¦‚æœä½¿ç”¨<code>gym</code>ï¼Œå¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡è·å–</td></tr><tr><td>metadata_path</td><td>string</td><td>æŒ‡å®š<code>metadata</code>ç›®å½•åœ°å€</td><td>å¦‚æœåœ¨<code>fastlane</code>ä¸­<code>./fastlane/metadata</code>ï¼Œå¦‚æœä½œä¸ºç‹¬ç«‹çš„å‘½ä»¤è¡Œåº”ç”¨<code>./metadata</code></td></tr><tr><td>screenshots_path</td><td>string</td><td>æŒ‡å®š<code>screenshots</code>ç›®å½•åœ°å€</td><td>å¦‚æœåœ¨<code>fastlane</code>ä¸­<code>./fastlane/screenshots</code>ï¼Œå¦‚æœä½œä¸ºç‹¬ç«‹çš„å‘½ä»¤è¡Œåº”ç”¨<code>./screenshots</code></td></tr><tr><td>skip_binary_upload</td><td>bool</td><td>è·³è¿‡äºŒè¿›åˆ¶æ–‡ä»¶ä¸Šä¼ ï¼Œé€‚ç”¨äºåªæƒ³æ”¹<code>metadata</code></td><td>false</td></tr><tr><td>skip_screenshots</td><td>bool</td><td>è·³è¿‡æˆªå›¾ä¸Šä¼ ï¼Œå¦‚æœæˆªå›¾æ²¡æœ‰å˜åŒ–ï¼Œå¼€å¯è¿™é¡¹èŠ‚çº¦æ—¶é—´</td><td>false</td></tr><tr><td>skip_metadata</td><td>bool</td><td>è·³è¿‡å…ƒæ•°æ®ä¸Šä¼ </td><td>false</td></tr><tr><td>force</td><td>bool</td><td><code>deliver</code>ä¼šåœ¨ä¸Šä¼ æ—¶æ±‡æ€»ä¿¡æ¯ç”ŸæˆHTMLä¹Ÿï¼Œç­‰å¾…ä½ å®¡æ ¸ã€‚è·³è¿‡è¿™é¡¹å®¡æ ¸æ­¤é¡¹è®¾ä¸º<code>true</code></td><td>false</td></tr><tr><td>submit_for_review</td><td>bool</td><td>ä¸Šä¼ å®Œæˆæ˜¯å¦è‡ªåŠ¨æäº¤å®¡æ ¸</td><td>false</td></tr><tr><td>automatic_release</td><td>bool</td><td>å®¡æ ¸é€šè¿‡æ˜¯å¦è‡ªåŠ¨é‡Šæ”¾</td><td>false</td></tr><tr><td>price_tier</td><td>int</td><td>Appä»·æ ¼çº§åˆ«ã€‚<strong>æ³¨æ„ï¼šè¿™é¡¹æäº¤å½“æ—¶å°±ä¼šç”Ÿæ•ˆ</strong>ï¼Œæ‰€ä»¥æ›´æ”¹ä»·æ ¼è¿˜æ˜¯åœ¨åå¤©æ‰‹åŠ¨æ“ä½œ</td><td></td></tr><tr><td>submission_information</td><td>hash</td><td>è¿™æ˜¯åœ¨iTCä¸Šç‚¹å‡»æäº¤ä¹‹åçš„é—®ç­”è¡¨æ ¼ï¼Œ<a href="https://github.com/fastlane/fastlane/blob/master/spaceship/lib/spaceship/tunes/app_submission.rb#L18-L69" target="_blank" rel="noopener">å¯é€‰é¡¹</a></td><td></td></tr><tr><td>app_review_information</td><td>hash</td><td>æä¾›å®¡æ ¸æ—¶çš„ä¿¡æ¯ï¼Œ<a href="https://github.com/fastlane/fastlane/blob/master/deliver/Deliverfile.md#app_review_information" target="_blank" rel="noopener">è¯¦æƒ…</a></td><td></td></tr><tr><td>app_icon</td><td>string</td><td>æŒ‡å®š<code>icon</code>å›¾ç‰‡åœ°å€ï¼Œå¿…é¡»ä¸º<code>png</code>æ ¼å¼</td></tr></tbody></table><ul><li><p>submission_information =&gt;</p><ul><li><p>å‰ç¼€ <code>export_compliance</code> =&gt; å¯¹åº”ã€Œå‡ºå£åˆè§„ä¿¡æ¯ã€ï¼Œæ²¡æœ‰ç‰¹æ®Šæƒ…å†µéƒ½é€‰ <code>false</code> å°±å¯ä»¥ã€‚</p></li><li><p>å‰ç¼€ <code>content_rights</code> =&gt; é—®ä½ æ˜¯å¦åŒ…å«ï¼Œæ˜¾ç¤ºï¼Œè®¿é—®ç¬¬ä¸‰æ–¹å†…å®¹(è¿™é¡¹æˆ‘æ²¡åœ¨æˆ‘æäº¤è¿‡ç¨‹ä¸­æ‰¾åˆ°)ï¼Œæ²¡æœ‰ç‰¹æ®Šæƒ…å†µä¹Ÿéƒ½é€‰ <code>false</code> å°±å¯ä»¥ã€‚</p></li><li><p>å‰ç¼€ <code>add_id_info</code> =&gt; å¯å°±å…³é”®äº†ï¼Œå¯¹åº”ã€Œå¹¿å‘Šæ ‡è¯†ç¬¦ã€ï¼Œå¦‚æœä½ åœ¨ App ä¸­ä½¿ç”¨äº† <code>IDFA</code>ã€‚ä½ å¿…é¡»åœ¨è¿™ç»™ä¸ªç†ç”±ï¼Œè€Œä¸èƒ½ç›´æ¥é€‰ <code>false</code>ã€‚</p><p>ä¸‹å›¾ç­‰ä»·ä¸‹è¡¨ï¼ŒApp ä¸­æŠ•æ”¾äº†å¹¿å‘Šã€‚</p></li></ul></li></ul><p><img src="http://cdn.yuhanle.com/fastlane/submission_information.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">submission_information(&#123;</span><br><span class="line">  export_compliance_available_on_french_store: &quot;false&quot;,</span><br><span class="line">  export_compliance_contains_proprietary_cryptography: &quot;false&quot;,</span><br><span class="line">  export_compliance_contains_third_party_cryptography: &quot;false&quot;,</span><br><span class="line">  export_compliance_is_exempt: &quot;false&quot;,</span><br><span class="line">  export_compliance_uses_encryption: &quot;false&quot;,</span><br><span class="line">  export_compliance_app_type: nil,</span><br><span class="line">  export_compliance_encryption_updated: &quot;false&quot;,</span><br><span class="line">  export_compliance_compliance_required: &quot;false&quot;,</span><br><span class="line">  export_compliance_platform: &quot;ios&quot;,</span><br><span class="line">  content_rights_contains_third_party_content: &quot;false&quot;,</span><br><span class="line">  content_rights_has_rights: &quot;false&quot;,</span><br><span class="line">  add_id_info_limits_tracking: &quot;true&quot;,</span><br><span class="line">  add_id_info_serves_ads: &quot;true&quot;,</span><br><span class="line">  add_id_info_tracks_action: &quot;false&quot;,</span><br><span class="line">  add_id_info_tracks_install: &quot;false&quot;,</span><br><span class="line">  add_id_info_uses_idfa: &quot;true&quot;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>deliver</code> çš„ <code>CLI</code> å·¥å…·ï¼š</p><ul><li>ä¸‹è½½ iTC ä¸Šçš„æˆªå›¾ <code>deliver download_screenshots</code></li><li><p>ä¸‹è½½ iTC ä¸Šçš„å…ƒæ•°æ®  <code>deliver download_metadata</code></p><p>é…ç½®å®Œä»¥ä¸Šçš„è®¾ç½®ï¼Œæœ€ååªéœ€è¦ä¸€æ¡å‘½ä»¤å‘å¸ƒ</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastlane ios deploy</span><br></pre></td></tr></table></figure><h2 id="ç³»ç»Ÿçº§-lane"><a href="#ç³»ç»Ÿçº§-lane" class="headerlink" title="ç³»ç»Ÿçº§ lane"></a>ç³»ç»Ÿçº§ lane</h2><p><code>fastlane</code> é»˜è®¤æœ‰ laneã€‚</p><ul><li><code>before_all</code>ï¼Œå°±æ˜¯åœ¨æ‰§è¡Œä¸€æ¬¡è„šæœ¬ä¹‹å‰é¦–å…ˆæ‰§è¡Œçš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œé¢æ‰§è¡Œä¸€äº›å…¬å…±çš„ä¸œè¥¿ï¼Œæ¯”å¦‚<code>git_pull</code>ï¼Œ<code>cocoapods</code>ã€‚</li></ul><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">before_all <span class="keyword">do</span></span><br><span class="line">  <span class="comment"># æ£€å‡ºåˆ° Developer åˆ†æ”¯</span></span><br><span class="line">  sh <span class="string">'git checkout Developer'</span></span><br><span class="line">  git_pull</span><br><span class="line">  cocoapods(<span class="symbol">repo_update:</span> <span class="literal">true</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ul><li><p><code>after_all</code>ï¼Œ æˆåŠŸç»“æŸä¹‹åï¼Œå¤„ç†å…±æœ‰çš„åç½®é€»è¾‘ã€‚</p></li><li><p><code>before_each</code>ï¼Œæ¯æ¬¡æ‰§è¡Œ lane ä¹‹å‰éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p></li><li><p><code>after_each</code>ï¼Œæ¯æ¬¡æ‰§è¡Œ lane ä¹‹åéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p></li><li><p><code>error</code>ï¼Œåœ¨æ‰§è¡Œä¸Šè¿°æƒ…å†µä»»æ„ç¯å¢ƒæŠ¥é”™éƒ½ä¼šä¸­æ­¢å¹¶æ‰§è¡Œä¸€æ¬¡ã€‚</p></li></ul><h3 id="æ‰§è¡Œé¡ºåº"><a href="#æ‰§è¡Œé¡ºåº" class="headerlink" title="æ‰§è¡Œé¡ºåº"></a>æ‰§è¡Œé¡ºåº</h3><table><thead><tr><th>æ‰§è¡Œé¡ºåº</th><th>æ–¹æ³•å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>1</td><td>before_all</td><td>åœ¨æ‰§è¡Œ lane ä¹‹å‰åªæ‰§è¡Œä¸€æ¬¡ã€‚</td></tr><tr><td>2</td><td>before_each</td><td>æ¯æ¬¡æ‰§è¡Œ lane ä¹‹å‰éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</td></tr><tr><td>3</td><td>lane</td><td>è‡ªå®šä¹‰çš„ä»»åŠ¡ã€‚</td></tr><tr><td>4</td><td>after_each</td><td>æ¯æ¬¡æ‰§è¡Œ lane ä¹‹åéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</td></tr><tr><td>5</td><td>after_all</td><td>åœ¨æ‰§è¡Œ lane æˆåŠŸç»“æŸä¹‹åæ‰§è¡Œä¸€æ¬¡ã€‚</td></tr><tr><td>6</td><td>error</td><td>åœ¨æ‰§è¡Œä¸Šè¿°æƒ…å†µä»»æ„ç¯å¢ƒæŠ¥é”™éƒ½ä¼šä¸­æ­¢å¹¶æ‰§è¡Œä¸€æ¬¡ã€‚</td></tr></tbody></table><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><ul><li>å‡ºç° <code>Command timed out after 10 seconds on try 1 of 4, trying again...</code>ï¼Œåœ¨ <code>fastlane</code> æ–‡ä»¶å¼€å¤´åŠ ä¸Šï¼š</li></ul><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ENV[<span class="string">"FASTLANE_XCODEBUILD_SETTINGS_TIMEOUT"</span>] = <span class="string">"180"</span></span><br><span class="line">ENV[<span class="string">"FASTLANE_XCODE_LIST_TIMEOUT"</span>] = <span class="string">"180"</span></span><br></pre></td></tr></table></figure><h2 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h2><p>Fastlane çš„æ’ä»¶æ˜¯ä¸€ä¸ªæˆ–è€…ä¸€ç»„ <code>action</code> çš„æ‰“åŒ…ï¼Œå•ç‹¬å‘å¸ƒåœ¨ fastlane ä¹‹å¤–ã€‚<a href="https://github.com/fastlane/fastlane/blob/master/fastlane/docs/Plugins.md" target="_blank" rel="noopener">Fastlane Plugin æŒ‡å—</a></p><p>è‡ªä» 16 å¹´ 5 æœˆä»½æ¨å‡ºæ’ä»¶ç³»ç»Ÿä»¥æ¥ï¼Œç°åœ¨å·²ç»æœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹çš„æ’ä»¶å¯ä»¥ä½¿ç”¨ã€‚æŸ¥çœ‹æ‰€æœ‰æ’ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastlane search_plugins</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä»‹ç»ä¸¤ä¸ªä¸‹æ–‡ä¼šç”¨åˆ°çš„æ’ä»¶ï¼š</p><ol><li><p>fastlane-plugin-versioning =&gt; ç”¨æ¥ä¿®æ”¹ build ç‰ˆæœ¬å·å’Œ version ç‰ˆæœ¬å·ã€‚</p><p>Fastlane å†…åµŒçš„ action <code>increment_build_number</code>ä½¿ç”¨çš„æ˜¯è‹¹æœæä¾›çš„ <code>agvtool</code>ï¼Œ<code>agvtool</code> åœ¨æ›´æ”¹ Build çš„æ—¶å€™ä¼šæ”¹å˜æ‰€æœ‰targetçš„ç‰ˆæœ¬å·ã€‚è¿™æ—¶å¦‚æœä½ åœ¨ä¸€ä¸ªå·¥ç¨‹é‡Œæœ‰å¤šä¸ªäº§å“çš„è¯ï¼Œæ¯æ¬¡ç¼–è¯‘ï¼Œæ‰€æœ‰çš„Buildéƒ½è¦åŠ 1ï¼Œæœ€åå°±ä¸çŸ¥é“é«˜åˆ°å“ªé‡Œå»äº†ã€‚</p><p>æœ‰äº† <code>fastlane-plugin-versioning</code> ä¸ä»…å¯ä»¥æŒ‡å®š target å¢åŠ  Buildï¼Œè€Œä¸”å¯ä»¥æŒ‰ç…§ã€Œ<a href="http://semver.org/lang/zh-CN/" target="_blank" rel="noopener">è¯­ä¹‰åŒ–ç‰ˆæœ¬</a>ã€è§„èŒƒå¢åŠ  Versionï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è®¾å®š Versionã€‚</p><p>PSï¼šæœ€å¼€å§‹å†™ iOS æ—¶ä¸çŸ¥é“æ€ä¹ˆå®šä¹‰ Buildã€‚ç°åœ¨æˆ‘ä¸€èˆ¬éƒ½ç›´æ¥å®šä¹‰æˆçº¯æ•°å­—ï¼Œæ¯”å¦‚ 100 èµ·,æ¯æ¬¡ç¼–è¯‘çš„æ—¶å€™è®©ä»–è‡ªåŠ¨åŠ ä¸€ã€‚</p></li><li><p><a href="https://github.com/whlsxl/firim/tree/master/fastlane-plugin-firim" target="_blank" rel="noopener">fastlane-plugin-firim</a> =&gt; ç›´æ¥æŠŠ AdHoc æˆ–è€… InHouse æ‰“åŒ…çš„ ipa ä¸Šä¼ åˆ° fir.imï¼Œä¾›æµ‹è¯•ä¸‹è½½ã€‚</p></li></ol><p>å®‰è£…ä¸Šé¢çš„æ’ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fastlane add_plugin [name] # å®‰è£…æ–¹æ³•</span><br><span class="line">fastlane add_plugin versioning</span><br><span class="line">fastlane add_plugin firim</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://juejin.im/post/5a7b10bb6fb9a0636263bfd5" target="_blank" rel="noopener">iOS æŒç»­äº¤ä»˜ä¹‹ Fastlane</a></p><p><a href="http://devhy.com/2018/01/23/26-fastlane-usage/" target="_blank" rel="noopener">å’Œé‡å¤åŠ³åŠ¨è¯´å†è§-ä½¿ç”¨fastlaneè¿›è¡ŒiOSæ‰“åŒ…</a></p><p><a href="https://whlsxl.github.io/fastlane1/" target="_blank" rel="noopener">å°å›¢é˜Ÿçš„è‡ªåŠ¨åŒ–å‘å¸ƒï¼Fastlaneå¸¦æ¥çš„å…¨è‡ªåŠ¨åŒ–å‘å¸ƒ</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://docs.fastlane.tools/img/fastlane_text.png&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://fastlane.tools/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;fastlane&lt;/a&gt; æ˜¯ä¸€ä¸ªé€šè¿‡ç®€å•å‘½ä»¤æ¥å®Œæˆè¯¸å¦‚æˆªå›¾ã€è·å–è¯ä¹¦ã€ç¼–è¯‘ã€å¯¼å‡ºå®‰è£…åŒ…ã€æäº¤ iTunesConnect ç­‰ä¸€ç³»åˆ—æ“ä½œçš„å·¥å…·ï¼Œå®ƒåŒæ—¶æ”¯æŒ iOS å’Œ Androidã€‚ &lt;/p&gt;
    
    </summary>
    
      <category term="fastlane" scheme="https://blog.yuhanle.com/categories/fastlane/"/>
    
    
      <category term="fastlane" scheme="https://blog.yuhanle.com/tags/fastlane/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®åºåˆ—åŒ–æ¡†æ¶åœ¨ Swift æ—¥å¸¸å¼€å‘ä¸­çš„åº”ç”¨</title>
    <link href="https://blog.yuhanle.com/2018/07/05/json-analysis-in-swift/"/>
    <id>https://blog.yuhanle.com/2018/07/05/json-analysis-in-swift/</id>
    <published>2018-07-05T01:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.337Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://user-images.githubusercontent.com/10498756/42311471-7fec973a-8070-11e8-80cb-cf2719b0ab7a.png" alt="image"></p><a id="more"></a><p>åˆ°äº† Swift å¹´ä»£ï¼Œç¬¬ä¸‰æ–¹åº“ SwiftyJSON å’Œ ObjectMapper éƒ½æ›¾ç»ä½œä¸º JSON è½¬æ¢çš„ä¸­æµç ¥æŸ±ï¼Œåªæ˜¯è¿™ä¸¤è€…è¿˜æ˜¯å…ä¸äº†â€œæ‰‹åŠ¨æŒ‡å®šå­—æ®µå’ŒJSONå­—å…¸æ˜ å°„å…³ç³»â€çš„å·¥ä½œã€‚äºæ˜¯é˜¿é‡Œæƒ³äº†ä¸ªé»‘ç§‘æŠ€ï¼ˆ<a href="https://github.com/alibaba/HandyJSON" target="_blank" rel="noopener">HandyJSON</a>ï¼‰ï¼Œé€šè¿‡åˆ†æSwiftæ•°æ®ç»“æ„åœ¨å†…å­˜ä¸­çš„å¸ƒå±€ï¼Œè‡ªåŠ¨åˆ†æå‡ºæ˜ å°„å…³ç³»ï¼Œè¿›ä¸€æ­¥é™ä½å¼€å‘è€…ä½¿ç”¨çš„æˆæœ¬ã€‚</p><p>å¦‚ä»Šæˆ‘ä»¬å°±æœ‰å¤šä¸ªé€‰æ‹©ï¼šObjectMapperã€HandyJSONã€SwiftyJSONã€MJExtension ç­‰</p><p>å…¶å®æˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¯¹äº JSON æ•°æ®çš„å¤„ç†æœ‰ä¸¤å¤§éœ€æ±‚ï¼š</p><ol><li>json å’Œ model äº’ç›¸è½¬æ¢ï¼ˆAndroid Studioæœ‰ Gson format æ’ä»¶ï¼Œä½†Xcodeæ²¡æœ‰ç±»ä¼¼åŠŸèƒ½ï¼‰</li><li>æœåŠ¡ç«¯è¿”å›çš„ json é‡Œå¯èƒ½æœ‰ nullï¼Œä½†æ˜¯ Swift è¯­è¨€çš„ç©ºæ˜¯ç”¨ nil è¡¨ç¤ºï¼Œéœ€è¦ç©ºå€¼å¤„ç†(å¯¹è±¡ Optional ç±»å‹)</li></ol><h2 id="æ¡†æ¶ç®€ä»‹"><a href="#æ¡†æ¶ç®€ä»‹" class="headerlink" title="æ¡†æ¶ç®€ä»‹"></a>æ¡†æ¶ç®€ä»‹</h2><h3 id="ObjectMapper"><a href="#ObjectMapper" class="headerlink" title="ObjectMapper"></a>ObjectMapper</h3><p>å…ˆçœ‹ <a href="https://github.com/Hearst-DD/ObjectMapper" target="_blank" rel="noopener">ObjectMapper</a> ï¼š Model ç±»å¿…é¡»å®ç° Mappable åè®®ï¼Œå³å®ç° init å’Œ mapping å‡½æ•°ï¼›é€‚åˆè·Ÿ Alamofire é…åˆã€‚ä½†æ˜¯ mapping å‡½æ•°å®ç°èµ·æ¥è¿‡äºè‡ƒè‚¿è€—æ—¶ï¼Œåªèƒ½å€ŸåŠ©<a href="https://github.com/quicktype/quicktype-xcode" target="_blank" rel="noopener">æ’ä»¶</a>æ¥å¿«é€Ÿå®Œæˆã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ObjectMapper</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonOBM</span>: <span class="title">Mappable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> username: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> age: <span class="type">Int</span>?</span><br><span class="line">    <span class="keyword">var</span> weight: <span class="type">Double</span>!</span><br><span class="line">    <span class="keyword">var</span> sex: <span class="type">Bool</span>!</span><br><span class="line">    <span class="keyword">var</span> location: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> three_day_forecast: [<span class="type">ForecastOBM</span>]?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(<span class="built_in">map</span>: <span class="type">Map</span>) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mapping</span><span class="params">(<span class="built_in">map</span>: Map)</span></span> &#123;</span><br><span class="line">        username    &lt;- <span class="built_in">map</span>[<span class="string">"username"</span>]</span><br><span class="line">        age         &lt;- <span class="built_in">map</span>[<span class="string">"age"</span>]</span><br><span class="line">        weight      &lt;- <span class="built_in">map</span>[<span class="string">"weight"</span>]</span><br><span class="line">        sex         &lt;- <span class="built_in">map</span>[<span class="string">"sex"</span>]</span><br><span class="line">        location    &lt;- <span class="built_in">map</span>[<span class="string">"location"</span>]</span><br><span class="line">        three_day_forecast &lt;- <span class="built_in">map</span> [<span class="string">"three_day_forecast"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForecastOBM</span>: <span class="title">Mappable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> conditions: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> day: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> temperature: <span class="type">Double</span>!</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(<span class="built_in">map</span>: <span class="type">Map</span>) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mapping</span><span class="params">(<span class="built_in">map</span>: Map)</span></span> &#123;</span><br><span class="line">        conditions      &lt;- <span class="built_in">map</span>[<span class="string">"conditions"</span>]</span><br><span class="line">        day             &lt;- <span class="built_in">map</span>[<span class="string">"day"</span>]</span><br><span class="line">        temperature     &lt;- <span class="built_in">map</span>[<span class="string">"temperature"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://dotnet.ctolib.com/j2s.html" target="_blank" rel="noopener">j2s æ˜¯ä¸€ä¸ª macOS app èƒ½å¤Ÿå°† JSON å¯¹è±¡è½¬æˆ Swift ç»“æ„ä½“</a></p><h3 id="HandyJSON"><a href="#HandyJSON" class="headerlink" title="HandyJSON"></a>HandyJSON</h3><p>å†çœ‹ <a href="https://github.com/alibaba/handyjson" target="_blank" rel="noopener">HandyJSON</a>ï¼Œ å†™èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ï¼Œç±»å’Œç»“æ„ä½“è¦æ±‚ç»§æ‰¿äº HandyJSONã€æšä¸¾è¦ç»§æ‰¿äº HandyJSONEnumã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> HandyJSON</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonHJ</span>: <span class="title">HandyJSON</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> username: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> age: <span class="type">Int</span>?</span><br><span class="line">    <span class="keyword">var</span> weight: <span class="type">Double</span>!</span><br><span class="line">    <span class="keyword">var</span> sex: <span class="type">Bool</span>!</span><br><span class="line">    <span class="keyword">var</span> locatoin: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> three_day_forecast: [<span class="type">ForecastHJ</span>]?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForecastHJ</span>: <span class="title">HandyJSON</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> conditions: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> day: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> temperature: <span class="type">Double</span>!</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”ObjectMapperä½¿ç”¨ä¸Šè¦ç®€å•ï¼Œ ä¸ç”¨å†™mappingå‡½æ•°é‚£ä¹ˆå¤šä»£ç äº†ã€‚</p><h3 id="SwiftyJSON"><a href="#SwiftyJSON" class="headerlink" title="SwiftyJSON"></a>SwiftyJSON</h3><p>çœ‹ <a href="https://github.com/SwiftyJSON/SwiftyJSON" target="_blank" rel="noopener">SwiftyJSON</a>ï¼šå–å­—æ®µå€¼ä½¿ç”¨æ¯”è¾ƒæ–¹ä¾¿ï¼Œ ä½†æ˜¯ç„¶å¹¶åµï¼Ÿ SwiftyJSON ä¸æ”¯æŒè½¬ Modelï¼Œå¦‚æœä½ åªæ˜¯æƒ³è¦è§£ææŸå‡ ä¸ªå­—æ®µï¼Œé‚£ä¹ˆ SwiftyJSON æ˜¯ä¸äºŒé€‰æ‹©ï¼Œ è€Œä¸”é€‚ç”¨äº Alamofireã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> jsonString: <span class="type">String</span> = <span class="string">"&#123;\"username\":\"yuhanle\",\"age\":18,\"weight\":65.4,\"sex\":1,\"location\":\"Toronto, Canada\",\"three_day_forecast\":[&#123;\"conditions\":\"Partly cloudy\",\"day\":\"Monday\",\"temperature\":20&#125;,&#123;\"conditions\":\"Showers\",\"day\":\"Tuesday\",\"temperature\":22&#125;,&#123;\"conditions\":\"Sunny\",\"day\":\"Wednesday\",\"temperature\":28&#125;]&#125;"</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">let</span> dataFromString = jsonString.data(using: .utf8, allowLossyConversion: <span class="literal">false</span>)</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> json = <span class="keyword">try</span> <span class="type">JSON</span>(data: dataFromString!)</span><br><span class="line">    <span class="built_in">print</span>(json[<span class="string">"username"</span>], json[<span class="string">"weight"</span>], json[<span class="string">"three_day_forecast"</span>][<span class="number">0</span>][<span class="string">"conditions"</span>])</span><br><span class="line">&#125; <span class="keyword">catch</span> <span class="keyword">let</span> error <span class="keyword">as</span> <span class="type">NSError</span> &#123;</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">"Error: <span class="subst">\(error.domain)</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="MJExtension"><a href="#MJExtension" class="headerlink" title="MJExtension"></a>MJExtension</h3><p>æœ€åçœ‹ä¸‹ä¸€ä¸‹ <a href="https://github.com/CoderMJLee/MJExtension" target="_blank" rel="noopener">MJExtension</a>ï¼Œä½œä¸ºä¸€ä¸ªä» ObjC å¹´ä»£å°±å¼€å§‹æµç¨‹çš„è½¬æ¢æ¡†æ¶ï¼Œåœ¨å¦‚ä»Šä½¿ç”¨çš„äººä»ç„¶å¾ˆå¤šï¼Œä½†æ˜¯å¯¹äº Swift çš„é›†æˆå´ä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œå®˜æ–¹ issue åˆ—è¡¨ä¸­ç»å¸¸éƒ½ä¼šæœ‰ç”³è¯·æ”¯æŒ swift çš„å‘¼å£°ï¼</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MJExtension</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonMJ</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> username: <span class="type">String</span>?</span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> age = <span class="number">0</span></span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> weight = <span class="number">0.0</span></span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> sex = <span class="literal">false</span></span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> location: <span class="type">String</span>?</span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> three_day_forecast: [<span class="type">ForecastMJ</span>]?</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForecastMJ</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> conditions: <span class="type">String</span>?</span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> day: <span class="type">String</span>?</span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">var</span> temperature = <span class="number">0.0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°½ç®¡åœ¨æ”¯æŒä¸Šä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œä½†æ˜¯åœ¨è‡ªå®šä¹‰ Model çš„è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥æ˜¯æœ€è½»æ¾çš„ä¸€æ¬¾ï¼Œä½†æ˜¯åœ¨å‡çº§ Swift 4 ä¹‹åï¼Œéœ€è¦åœ¨å±æ€§å‰æ·»åŠ  @objc æ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œå¦åˆ™è½¬æ¢å¤±è´¥ã€‚å…·ä½“æƒ…å†µå¯å‚è€ƒï¼š<a href="https://github.com/CoderMJLee/MJExtension/issues/582" target="_blank" rel="noopener">Swift 4 å­—å…¸è½¬æ¨¡å‹å¤±è´¥</a></p><p>å¦å¤–è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯å…³äºæ•´å‹å±æ€§ï¼Œéœ€è¦ç»™å®šåˆè¯•å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒMJExtension æ— æ³•åºåˆ—åŒ–/ååºåˆ—åŒ–æ•´å‹ã€‚è§£å†³åŠæ³•å¾ˆç®€å•ï¼Œ å°±æ˜¯èµ‹ä¸ªé»˜è®¤å€¼ï¼Œ å³å°†Optionalæ•´å‹å˜ä¸ºæ•´å‹å°±å¯ä»¥ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> age: <span class="type">Int</span>?   <span class="comment">// è¯·æ³¨æ„ï¼šMJExtensionä¸èƒ½è§£æOptional Intç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">0</span> <span class="comment">// æ­£ç¡®</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œè€—æ—¶"><a href="#è¿è¡Œè€—æ—¶" class="headerlink" title="è¿è¡Œè€—æ—¶"></a>è¿è¡Œè€—æ—¶</h2><p>æˆ‘ä»¬å‡†å¤‡äº†ä¸€å°æ®µ JSON æ•°æ®ï¼Œå¾ªç¯è§£æ 10000 æ¬¡ï¼Œæ¥åˆ†æå‡ å¤§æ¡†æ¶çš„è¿è¡Œè€—æ—¶ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"username"</span>: <span class="string">"yuhanle"</span>,</span><br><span class="line">    <span class="attr">"age"</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">"weight"</span>: <span class="number">65.4</span>,</span><br><span class="line">    <span class="attr">"sex"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"location"</span>: <span class="string">"Toronto, Canada"</span>,</span><br><span class="line">    <span class="attr">"three_day_forecast"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"conditions"</span>: <span class="string">"Partly cloudy"</span>,</span><br><span class="line">            <span class="attr">"day"</span>: <span class="string">"Monday"</span>,</span><br><span class="line">            <span class="attr">"temperature"</span>: <span class="number">20</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"conditions"</span>: <span class="string">"Showers"</span>,</span><br><span class="line">            <span class="attr">"day"</span>: <span class="string">"Tuesday"</span>,</span><br><span class="line">            <span class="attr">"temperature"</span>: <span class="number">22</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"conditions"</span>: <span class="string">"Sunny"</span>,</span><br><span class="line">            <span class="attr">"day"</span>: <span class="string">"Wednesday"</span>,</span><br><span class="line">            <span class="attr">"temperature"</span>: <span class="number">28</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ HandyJSON ä¸ºä¾‹ï¼Œåœ¨å¼€å§‹å¤„ç†æ•°æ®å’Œç»“æŸæ—¶ï¼Œè®°å½•æ—¶é—´å·®ï¼Œæ—¶é—´å·®çš„ç»“æœæ¯æ¬¡ä¼šæœ‰æ³¢åŠ¨</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> maxCount = <span class="number">10000</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testHandyJSON</span><span class="params">(json: String)</span></span> -&gt; <span class="type">Void</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> start = <span class="type">CFAbsoluteTimeGetCurrent</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> people: <span class="type">PersonHJ</span> = <span class="type">PersonHJ</span>()</span><br><span class="line">    <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;maxCount &#123;</span><br><span class="line">        people = <span class="type">PersonHJ</span>.deserialize(from: json)!</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> executionTime = <span class="type">CFAbsoluteTimeGetCurrent</span>() - start</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"HandyJSON deserialize time totals: "</span>, executionTime)</span><br><span class="line"></span><br><span class="line">    start = <span class="type">CFAbsoluteTimeGetCurrent</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;maxCount &#123;</span><br><span class="line">        res = people.toJSONString()!</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    executionTime = <span class="type">CFAbsoluteTimeGetCurrent</span>() - start</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"HandyJSON toJSONString time totals: "</span>, executionTime)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆè®°å½•å¾—åˆ°çš„ç»“æœå¯¹æ¯”å›¾</p><table><thead><tr><th><strong>æµ‹è¯•é¡¹</strong></th><th><strong>JSON -&gt; MODEL</strong></th><th><strong>MODEL -&gt; JSON</strong></th></tr></thead><tbody><tr><td>HandyJSON</td><td>3.0839329957962</td><td>4.97446703910828</td></tr><tr><td>ObjeceMapper</td><td>1.40153098106384</td><td>1.2123589515686</td></tr><tr><td>SwiftJSON</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>MJExtension</td><td>0.417935013771057</td><td>0.418874025344849</td></tr></tbody></table><p><img src="https://user-images.githubusercontent.com/10498756/42310902-2010687e-806f-11e8-9365-c3d1a3958677.png" alt="image"></p><p>ç»“æœæœ‰ç‚¹å‡ºä¹æ„æ–™ï¼ŒHandyJSON çš„é»‘é­”æ³•çºµç„¶å¾ˆå¼ºå¤§ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†è€—æ—¶çš„é—®é¢˜ï¼Œç›¸æ¯”è¾ƒè€Œè¨€ï¼Œä¸å¤ªå‹å¥½çš„  MJExtension é€Ÿåº¦æœ€å¿«ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¯¹äºåº”ç”¨å¼€å‘æ¥è¯´ï¼ŒJSON æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—å·çš„æ“ä½œå¿…ä¸å¯å°‘ï¼Œä¸Šè¿°åˆ†æçš„æ•ˆç‡å’Œæ€§èƒ½é—®é¢˜ï¼Œä¹Ÿåº”è¯¥å¤šè€ƒè™‘ï¼Œé€‰æ‹©åˆé€‚çš„æ¡†æ¶å¾ˆé‡è¦ï¼Œå­¦ä¹ å’Œè¸©å‘ä¹Ÿæ˜¯å¹¶å­˜çš„ã€‚</p><p>å¦å¤–ï¼ŒSwift æ”¯æŒ Codable åè®®ï¼Œå¯¹è¿™ä¸ªéœ€æ±‚çš„å¤„ç†ä¹Ÿæœ‰å¾ˆå¤§çš„æ”¯æŒï¼</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://medium.com/@jasonyuh/%E5%BA%94%E8%AF%A5%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8codable-f99d6ac5810" target="_blank" rel="noopener">åº”è¯¥ä»€ä¹ˆæ—¶å€™ä½¿ç”¨Codable</a></li><li><a href="http://www.cnblogs.com/yajunLi/p/7121950.html" target="_blank" rel="noopener">Swiftå®ç°JSONè½¬Model - HandyJSONä½¿ç”¨è®²è§£</a></li><li><a href="https://blog.csdn.net/brycegao321/article/details/75349045" target="_blank" rel="noopener">iOS JSONåºåˆ—åŒ–/ååºåˆ—åŒ–å“ªå®¶å¼ºï¼Ÿ</a></li><li><a href="https://medium.com/@wenchenx/swift-4-codable-%E8%AE%93%E5%BA%8F%E5%88%97%E5%8C%96%E8%AE%8A%E5%BE%97%E6%9B%B4%E7%B0%A1%E5%96%AE-73e55042f077" target="_blank" rel="noopener">Swift 4 Codable è®“åºåˆ—åŒ–è®Šå¾—æ›´ç°¡å–®</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/10498756/42311471-7fec973a-8070-11e8-80cb-cf2719b0ab7a.png&quot; alt=&quot;image&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="swift" scheme="https://blog.yuhanle.com/categories/swift/"/>
    
    
      <category term="swift" scheme="https://blog.yuhanle.com/tags/swift/"/>
    
      <category term="JSON" scheme="https://blog.yuhanle.com/tags/JSON/"/>
    
      <category term="HandyJSON" scheme="https://blog.yuhanle.com/tags/HandyJSON/"/>
    
  </entry>
  
  <entry>
    <title>RAC åœ¨ MVVM ä¸­çš„å¸¸è§ç”¨æ³•</title>
    <link href="https://blog.yuhanle.com/2018/05/13/rac-in-mvvm/"/>
    <id>https://blog.yuhanle.com/2018/05/13/rac-in-mvvm/</id>
    <published>2018-05-13T01:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.339Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼€ç¯‡"><a href="#å¼€ç¯‡" class="headerlink" title="å¼€ç¯‡"></a>å¼€ç¯‡</h2><p>åœ¨ iOS å¼€å‘ä¸­ï¼Œæˆ–å¤šæˆ–å°‘éƒ½ä¼šè§è¿‡ RAC çš„èº«å½±ï¼Œå®ƒä¸ºæé«˜å¼€å‘æ•ˆç‡è€Œç”Ÿï¼Œåœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹å¼€å‘æ—¶å¯ä»¥å¤§å¤§ç®€åŒ–ä»£ç ï¼Œå¹¶ä¸”ç›®å‰æ¥çœ‹å®‰å…¨å¯é ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰æ¥è§¦ RACï¼Œå»ºè®®ä½ å·¥ä½œä¹‹ä½™ç¨ä½œç ”ç©¶ï¼Œå¹¶å°è¯•ä½“éªŒä¸€ä¸‹ã€‚<br><a id="more"></a></p><p>å…³äº RAC çš„è§£é‡Šï¼Œå®˜æ–¹çš„è¯´ï¼Œ<a href="https://github.com/ReactiveCocoa/ReactiveCocoa" target="_blank" rel="noopener">ReactiveCocoa</a>ï¼ˆå…¶ç®€ç§°ä¸ºRACï¼‰æ˜¯ç”± GitHub å¼€æºçš„ä¸€ä¸ªåº”ç”¨äº iOS å’Œ OS X å¼€å‘çš„æ–°æ¡†æ¶ï¼Œå…¶å…·æœ‰ <a href="https://zh.wikipedia.org/wiki/%E5%87%BD%E6%95%B8%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80" target="_blank" rel="noopener">å‡½æ•°å¼ç¼–ç¨‹</a> å’Œ <a href="https://zh.wikipedia.org/wiki/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B" target="_blank" rel="noopener">å“åº”å¼ç¼–ç¨‹</a> çš„ç‰¹æ€§ã€‚</p><p>è¿™æ˜¯æ‘˜è‡ªèŠ±ç“£ç½‘å·¥ç¨‹å¸ˆåšå®¢çš„ä¸€å¹…å›¾ï¼Œå¯ä»¥ç›´è§‚çš„çœ‹åˆ°å„ä¸ªç±»ä¹‹é—´çš„å…³ç³»</p><p><img src="http://cdn.yuhanle.com/rac/FRP_ReactiveCocoa_large.png" alt></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ç»“åˆ RAC ä¸­çš„ç±»ä»¥åŠå®é™…ä½¿ç”¨åœºæ™¯ï¼Œæ¥æè¿°ä¸€ä¸‹ä»–çš„åŸºæœ¬ç”¨æ³•ï¼š</p><ul><li>RACSignal</li><li>RACSubject</li><li>RACSequence</li><li>RACMulticastConnection</li><li>RACCommand</li><li>RAC å¸¸ç”¨å®</li><li>RAC-bind</li><li>RAC-è¿‡æ»¤</li><li>RAC-æ˜ å°„</li><li>RAC-ç»„åˆ</li></ul><h2 id="æ­£é¢˜"><a href="#æ­£é¢˜" class="headerlink" title="æ­£é¢˜"></a>æ­£é¢˜</h2><h3 id="åŸºç¡€ç”¨æ³•"><a href="#åŸºç¡€ç”¨æ³•" class="headerlink" title="åŸºç¡€ç”¨æ³•"></a>åŸºç¡€ç”¨æ³•</h3><h4 id="RACSignal"><a href="#RACSignal" class="headerlink" title="RACSignal"></a>RACSignal</h4><p><strong>ä¿¡å·ç±»</strong>ï¼ŒSignal æ˜¯ RAC ä¸­çš„æ ¸å¿ƒæ¦‚å¿µã€‚å½“æ•°æ®æ”¹å˜æ—¶ï¼Œä¿¡å·å†…éƒ¨å°±ä¼šæ”¶åˆ°æ•°æ®ï¼Œç„¶åå‘å‡ºã€‚<strong>ä½†æ˜¯é»˜è®¤ä¸€ä¸ªä¿¡å·æ˜¯å†·ä¿¡å·</strong>ï¼Œå½“ä¸€ä¸ªä¿¡å·æ²¡æœ‰è®¢é˜…è€…ï¼ˆSubscriberï¼‰æ—¶å®ƒä»€ä¹ˆä¹Ÿä¸å¹²ï¼Œå°±åƒæˆ‘ä»¬çš„å‡½æ•°ï¼Œå½“ä¸€ä¸ªå‡½æ•°å†™å¥½ä¹‹åå¹¶æ²¡æœ‰è¢«è°ƒç”¨å®ƒä¹Ÿä»€ä¹ˆéƒ½ä¸ä¼šå¹²ã€‚ä¿¡å·å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼å‘é€äº‹ä»¶ç»™è®¢é˜…è€…ã€‚</p><p>è¯¦ç»†ä»‹ç»å‚è€ƒï¼š<a href="https://draveness.me/racdelegateproxy" target="_blank" rel="noopener">ä»ä»£ç†åˆ° RACSignal</a></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.åˆ›å»ºä¿¡å·</span></span><br><span class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">    <span class="comment">// 3.å‘é€ä¿¡å·</span></span><br><span class="line">    [subscriber sendNext:<span class="string">@"ws"</span>];</span><br><span class="line">    <span class="comment">// 4.å–æ¶ˆä¿¡å·</span></span><br><span class="line">    <span class="comment">// å¦‚æœä¿¡å·æƒ³è¦è¢«å–æ¶ˆï¼Œå°±å¿…é¡»è¿”å›ä¸€ä¸ªRACDisposable</span></span><br><span class="line">    <span class="comment">// ä¿¡å·ä»€ä¹ˆæ—¶å€™è¢«å–æ¶ˆï¼š</span></span><br><span class="line">    <span class="comment">// 1.è‡ªåŠ¨å–æ¶ˆï¼Œå½“ä¸€ä¸ªä¿¡å·çš„è®¢é˜…è€…è¢«é”€æ¯çš„æ—¶å€™æœºä¼šè‡ªåŠ¨å–æ¶ˆè®¢é˜…ï¼Œ</span></span><br><span class="line">    <span class="comment">// 2.æ‰‹åŠ¨å–æ¶ˆï¼Œ</span></span><br><span class="line">    <span class="comment">// blockä»€ä¹ˆæ—¶å€™è°ƒç”¨ï¼šä¸€æ—¦ä¸€ä¸ªä¿¡å·è¢«å–æ¶ˆè®¢é˜…å°±ä¼šè°ƒç”¨</span></span><br><span class="line">    <span class="comment">// blockä½œç”¨ï¼šå½“ä¿¡å·è¢«å–æ¶ˆæ—¶ç”¨äºæ¸…ç©ºä¸€äº›èµ„æº</span></span><br><span class="line">    <span class="keyword">return</span> [RACDisposable disposableWithBlock:^&#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"å–æ¶ˆè®¢é˜…"</span>);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. è®¢é˜…ä¿¡å·</span></span><br><span class="line"><span class="comment">// subscribeNext</span></span><br><span class="line"><span class="comment">// æŠŠnextBlockä¿å­˜åˆ°è®¢é˜…è€…é‡Œé¢</span></span><br><span class="line"><span class="comment">// åªè¦è®¢é˜…ä¿¡å·å°±ä¼šè¿”å›ä¸€ä¸ªå–æ¶ˆè®¢é˜…ä¿¡å·çš„ç±»</span></span><br><span class="line">RACDisposable *disposable = [signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="comment">// blockçš„è°ƒç”¨æ—¶åˆ»ï¼šåªè¦ä¿¡å·å†…éƒ¨å‘å‡ºæ•°æ®å°±ä¼šè°ƒç”¨è¿™ä¸ªblock</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å–æ¶ˆè®¢é˜…</span></span><br><span class="line">[disposable dispose];</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“</strong></p><p>ä¿¡å·ç±»çš„ä½œç”¨ï¼š</p><ol><li>åªè¦æœ‰æ•°æ®æ”¹å˜å°±ä¼šæŠŠæ•°æ®åŒ…è£…æˆä¿¡å·ä¼ é€’å‡ºå»</li><li>åªè¦æœ‰æ•°æ®æ”¹å˜å°±ä¼šæœ‰ä¿¡å·å‘å‡º</li><li>æ•°æ®å‘å‡ºï¼Œå¹¶ä¸æ˜¯ä¿¡å·ç±»å‘å‡ºï¼Œä¿¡å·ç±»ä¸èƒ½å‘é€æ•°æ®</li></ol><p>å®ç°æ€è·¯ï¼š</p><ol><li><p>å½“ä¸€ä¸ªä¿¡å·è¢«è®¢é˜…ï¼Œåˆ›å»ºè®¢é˜…è€…ï¼Œå¹¶æŠŠ nextBlock ä¿å­˜åˆ°è®¢é˜…è€…é‡Œé¢</p></li><li><p>åˆ›å»ºçš„æ—¶å€™ä¼šè¿”å› [RACDynamicSignal createSignal:didSubscribe];</p></li><li><p>è°ƒç”¨ RACDynamicSignal çš„ didSubscribe</p></li><li><p>å‘é€ä¿¡å· [subscriber sendNext:value];</p></li><li><p>æ‹¿åˆ°è®¢é˜…è€…çš„ nextBlock è°ƒç”¨</p></li></ol><h4 id="RACSubject"><a href="#RACSubject" class="headerlink" title="RACSubject"></a>RACSubject</h4><p>RACSubject åœ¨ä½¿ç”¨ä¸­æˆ‘ä»¬å¯ä»¥å®Œå…¨ä»£æ›¿ä»£ç†/é€šçŸ¥ï¼Œæ¥ç®€åŒ–ä»£ç ã€‚</p><p><strong>(å¯å˜çš„ä¿¡å·ï¼‰ï¼š</strong> å¯ä»¥è¿æ¥RACä»£ç ä¸éRACä»£ç ï¼Œå¯ä»¥æ¥æ”¶å’Œä¸»åŠ¨å‘é€ä¿¡å·ã€‚çœ‹äº†å¾ˆå¤šä»‹ç»éƒ½ä¸æ¨èä½¿ç”¨ã€‚ç›®å‰æˆ‘åªæŠŠä»–å½“ä½œä»£ç†ä½¿ç”¨äº†ä¸€ä¸‹ã€‚</p><p>è¯¦ç»†ä»‹ç»å‚è€ƒï¼š<a href="https://draveness.me/racsubject" target="_blank" rel="noopener">ã€å¯å˜ã€çš„çƒ­ä¿¡å· RACSubject</a></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. åˆ›å»ºä¿¡å·</span></span><br><span class="line">RACSubject *subject = [RACSubject subject];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. è®¢é˜…ä¿¡å·</span></span><br><span class="line">[subject subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="comment">// block:å½“æœ‰æ•°æ®å‘å‡ºçš„æ—¶å€™å°±ä¼šè°ƒç”¨</span></span><br><span class="line">    <span class="comment">// block:å¤„ç†æ•°æ®</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,x);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. å‘é€ä¿¡å·</span></span><br><span class="line">[subject sendNext:value];</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong></p><ol><li>RACSubject å’Œ RACReplaySubject çš„åŒºåˆ«</li><li>RACSubject å¿…é¡»è¦å…ˆè®¢é˜…ä¿¡å·ä¹‹åæ‰èƒ½å‘é€ä¿¡å·ï¼Œ è€Œ RACReplaySubject å¯ä»¥å…ˆå‘é€ä¿¡å·åè®¢é˜….</li><li>RACSubject ä»£ç ä¸­ä½“ç°ä¸ºï¼šå…ˆèµ°TwoViewControllerçš„ sendNextï¼Œåèµ° ViewController çš„ subscribeNext è®¢é˜…</li><li>RACReplaySubject ä»£ç ä¸­ä½“ç°ä¸ºï¼šå…ˆèµ° ViewController çš„ subscribeNext è®¢é˜…ï¼Œåèµ° TwoViewController çš„sendNext å¯æŒ‰å®é™…æƒ…å†µå„å–æ‰€éœ€ã€‚</li></ol><h4 id="RACSequence"><a href="#RACSequence" class="headerlink" title="RACSequence"></a>RACSequence</h4><p>è¯¦ç»†ä»‹ç»å‚è€ƒï¼š<a href="https://draveness.me/racsequence" target="_blank" rel="noopener">Pull-Driven çš„æ•°æ®æµ RACSequence</a></p><p>ä½¿ç”¨åœºæ™¯ï¼š å¯ä»¥å¿«é€Ÿé«˜æ•ˆçš„éå†æ•°ç»„å’Œå­—å…¸ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"flags.plist"</span> ofType:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSArray</span> *dictArr = [<span class="built_in">NSArray</span> arrayWithContentsOfFile:path];</span><br><span class="line">    [dictArr.rac_sequence.signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125; error:^(<span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"error"</span>);</span><br><span class="line">&#125; completed:^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å®Œæ¯•"</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å®</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123;<span class="string">@"key"</span>:@<span class="number">1</span>, <span class="string">@"key2"</span>:@<span class="number">2</span>&#125;;</span><br><span class="line">[dict.rac_sequence.signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">    <span class="built_in">NSString</span> *key = x[<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *value = x[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// RACTupleUnpackå®ï¼šä¸“é—¨ç”¨æ¥è§£æå…ƒç»„</span></span><br><span class="line">    <span class="comment">// RACTupleUnpack ç­‰ä¼šå³è¾¹ï¼šéœ€è¦è§£æçš„å…ƒç»„ å®çš„å‚æ•°ï¼Œå¡«è§£æçš„ä»€ä¹ˆæ ·æ•°æ®</span></span><br><span class="line">    <span class="comment">// å…ƒç»„é‡Œé¢æœ‰å‡ ä¸ªå€¼ï¼Œå®çš„å‚æ•°å°±å¿…é¡»å¡«å‡ ä¸ª</span></span><br><span class="line">    RACTupleUnpack(<span class="built_in">NSString</span> *key, <span class="built_in">NSString</span> *value) = x;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@ %@"</span>, key, value);</span><br><span class="line">&#125; error:^(<span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"error"</span>);</span><br><span class="line">&#125; completed:^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å®Œæ¯•"</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><h4 id="RACMulticastConnection"><a href="#RACMulticastConnection" class="headerlink" title="RACMulticastConnection"></a>RACMulticastConnection</h4><p>å½“æœ‰å¤šä¸ªè®¢é˜…è€…ï¼Œä½†æ˜¯æˆ‘ä»¬åªæƒ³å‘é€ä¸€ä¸ªä¿¡å·çš„æ—¶å€™æ€ä¹ˆåŠï¼Ÿè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ç”¨ RACMulticastConnectionï¼Œæ¥å®ç°ã€‚</p><p>è¯¦ç»†ä»‹ç»å‚è€ƒï¼š<a href="https://draveness.me/racconnection" target="_blank" rel="noopener">ç”¨äºå¤šæ’­çš„ RACMulticastConnection</a></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ™®é€šå†™æ³•, è¿™æ ·çš„ç¼ºç‚¹æ˜¯ï¼šæ¯è®¢é˜…ä¸€æ¬¡ä¿¡å·å°±å¾—é‡æ–°åˆ›å»ºå¹¶å‘é€è¯·æ±‚ï¼Œå¾ˆä¸å‹å¥½</span></span><br><span class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">    <span class="comment">// didSubscribeblock ä¸­çš„ä»£ç éƒ½ç»Ÿç§°ä¸ºå‰¯ä½œç”¨</span></span><br><span class="line">    <span class="comment">// å‘é€è¯·æ±‚</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å‘é€è¯·æ±‚å•¦"</span>);</span><br><span class="line">    <span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">    [subscriber sendNext:<span class="string">@"ws"</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;];</span><br><span class="line">[signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line">[signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line">[signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨èåšæ³•ã€‚ ä½¿ç”¨RACMulticastConnectionï¼Œæ— è®ºæœ‰å¤šå°‘ä¸ªè®¢é˜…è€…ï¼Œæ— è®ºè®¢é˜…å¤šå°‘æ¬¡ï¼Œåªå‘é€ä¸€ä¸ª</span></span><br><span class="line"><span class="comment">// 1.å‘é€è¯·æ±‚ï¼Œç”¨ä¸€ä¸ªä¿¡å·å†…åŒ…è£…ï¼Œä¸ç®¡æœ‰å¤šå°‘ä¸ªè®¢é˜…è€…ï¼Œåªæƒ³å‘ä¸€æ¬¡è¯·æ±‚</span></span><br><span class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">    <span class="comment">// å‘é€è¯·æ±‚</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å‘é€è¯·æ±‚å•¦"</span>);</span><br><span class="line">    <span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">    [subscriber sendNext:<span class="string">@"ws"</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">//2. åˆ›å»ºè¿æ¥ç±»</span></span><br><span class="line">RACMulticastConnection *connection = [signal publish];</span><br><span class="line">[connection.signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line">[connection.signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line">[connection.signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">//3. è¿æ¥ã€‚åªæœ‰è¿æ¥äº†æ‰ä¼šæŠŠä¿¡å·æºå˜ä¸ºçƒ­ä¿¡å·</span></span><br><span class="line">[connection connect];</span><br></pre></td></tr></table></figure><h4 id="RACCommand"><a href="#RACCommand" class="headerlink" title="RACCommand"></a>RACCommand</h4><p>RACCommandï¼šRAC ä¸­ç”¨äºå¤„ç†äº‹ä»¶çš„ç±»ï¼Œå¯ä»¥æŠŠäº‹ä»¶å¦‚ä½•å¤„ç†ï¼Œäº‹ä»¶ä¸­çš„æ•°æ®å¦‚ä½•ä¼ é€’ï¼ŒåŒ…è£…åˆ°è¿™ä¸ªç±»ä¸­ï¼Œä»–å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç›‘æ§äº‹ä»¶çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ¯”å¦‚çœ‹äº‹ä»¶æœ‰æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œè¯¦ç»†ä»‹ç»å‚è€ƒï¼š<a href="https://draveness.me/raccommand" target="_blank" rel="noopener">ä¼˜é›…çš„ RACCommand</a></p><p><code>RACCommand</code> æ˜¯ä¸€ä¸ªåœ¨ ReactiveCocoa ä¸­æ¯”è¾ƒå¤æ‚çš„ç±»ï¼Œå¤§å¤šæ•°ä½¿ç”¨ ReactiveCocoa çš„äººï¼Œå°¤å…¶æ˜¯åˆå­¦è€…å¹¶ä¸ä¼šç»å¸¸ä½¿ç”¨å®ƒã€‚</p><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè™½ç„¶ä½¿ç”¨ <code>RACSignal</code> å’Œ <code>RACSubject</code> å°±èƒ½è§£å†³ç»å¤§éƒ¨åˆ†é—®é¢˜ï¼Œä½†æ˜¯ <code>RACCommand</code> çš„ä½¿ç”¨ä¼šä¸ºæˆ‘ä»¬å¸¦æ¥å·¨å¤§çš„ä¾¿åˆ©ï¼Œå°¤å…¶æ˜¯åœ¨ä¸å‰¯ä½œç”¨ç›¸å…³çš„æ“ä½œä¸­ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šç›‘å¬æŒ‰é’®ç‚¹å‡»ï¼Œå¼‚æ­¥ç½‘ç»œè¯·æ±‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ™®é€šåšæ³•</span></span><br><span class="line"><span class="comment">// RACCommand: å¤„ç†äº‹ä»¶</span></span><br><span class="line"><span class="comment">// ä¸èƒ½è¿”å›ç©ºçš„ä¿¡å·</span></span><br><span class="line"><span class="comment">// 1.åˆ›å»ºå‘½ä»¤</span></span><br><span class="line">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(<span class="keyword">id</span> input) &#123;</span><br><span class="line">    <span class="comment">//blockè°ƒç”¨ï¼Œæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™å°±ä¼šè°ƒç”¨</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, input); <span class="comment">// input ä¸ºæ‰§è¡Œå‘½ä»¤ä¼ è¿›æ¥çš„å‚æ•°</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„è¿”å›å€¼ä¸å…è®¸ä¸ºnil</span></span><br><span class="line">    <span class="keyword">return</span> [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        [subscriber sendNext:<span class="string">@"æ‰§è¡Œå‘½ä»¤äº§ç”Ÿçš„æ•°æ®"</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚ä½•æ‹¿åˆ°æ‰§è¡Œå‘½ä»¤ä¸­äº§ç”Ÿçš„æ•°æ®å‘¢ï¼Ÿ</span></span><br><span class="line"><span class="comment">// è®¢é˜…å‘½ä»¤å†…éƒ¨çš„ä¿¡å·</span></span><br><span class="line"><span class="comment">// ** æ–¹å¼ä¸€ï¼šç›´æ¥è®¢é˜…æ‰§è¡Œå‘½ä»¤è¿”å›çš„ä¿¡å·</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">RACSignal *signal =[command execute:@<span class="number">2</span>]; </span><br><span class="line">    <span class="comment">// è¿™é‡Œå…¶å®ç”¨åˆ°çš„æ˜¯replaySubject å¯ä»¥å…ˆå‘é€å‘½ä»¤å†è®¢é˜…</span></span><br><span class="line">    <span class="comment">// åœ¨è¿™é‡Œå°±å¯ä»¥è®¢é˜…ä¿¡å·äº†</span></span><br><span class="line">    [signal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€èˆ¬åšæ³•</span></span><br><span class="line"><span class="comment">// 1.åˆ›å»ºå‘½ä»¤</span></span><br><span class="line">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(<span class="keyword">id</span> input) &#123;</span><br><span class="line">    <span class="comment">//blockè°ƒç”¨ï¼Œæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™å°±ä¼šè°ƒç”¨</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, input); <span class="comment">// input ä¸ºæ‰§è¡Œå‘½ä»¤ä¼ è¿›æ¥çš„å‚æ•°</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„è¿”å›å€¼ä¸å…è®¸ä¸ºnil</span></span><br><span class="line">    <span class="keyword">return</span> [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        [subscriber sendNext:<span class="string">@"æ‰§è¡Œå‘½ä»¤äº§ç”Ÿçš„æ•°æ®"</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼äºŒï¼š</span></span><br><span class="line"><span class="comment">// è®¢é˜…ä¿¡å·</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šè¿™é‡Œå¿…é¡»æ˜¯å…ˆè®¢é˜…æ‰èƒ½å‘é€å‘½ä»¤</span></span><br><span class="line"><span class="comment">// executionSignalsï¼šä¿¡å·æºï¼Œä¿¡å·ä¸­ä¿¡å·ï¼Œsignalofsignals:ä¿¡å·ï¼Œå‘é€æ•°æ®å°±æ˜¯ä¿¡å·</span></span><br><span class="line">[command.executionSignals subscribeNext:^(RACSignal *x) &#123;</span><br><span class="line">    [x subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">[command execute:@<span class="number">2</span>];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é«˜çº§åšæ³•</span></span><br><span class="line"><span class="comment">// 1.åˆ›å»ºå‘½ä»¤</span></span><br><span class="line">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(<span class="keyword">id</span> input) &#123;</span><br><span class="line">    <span class="comment">// blockè°ƒç”¨ï¼šæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™å°±ä¼šè°ƒç”¨</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, input);</span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„è¿”å›å€¼ä¸å…è®¸ä¸ºnil</span></span><br><span class="line">    <span class="keyword">return</span> [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        [subscriber sendNext:<span class="string">@"å‘é€ä¿¡å·"</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼ä¸‰</span></span><br><span class="line"><span class="comment">// switchToLatestè·å–æœ€æ–°å‘é€çš„ä¿¡å·ï¼Œåªèƒ½ç”¨äºä¿¡å·ä¸­ä¿¡å·ã€‚</span></span><br><span class="line">[command.executionSignals.switchToLatest subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// 2.æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">[command execute:@<span class="number">3</span>];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// switchToLatest--ç”¨äºä¿¡å·ä¸­ä¿¡å·</span></span><br><span class="line"><span class="comment">// åˆ›å»ºä¿¡å·ä¸­ä¿¡å·</span></span><br><span class="line">RACSubject *signalofsignals = [RACSubject subject];</span><br><span class="line">RACSubject *signalA = [RACSubject subject];</span><br><span class="line"><span class="comment">// è®¢é˜…ä¿¡å·</span></span><br><span class="line">[signalofsignals subscribeNext:^(RACSignal *x) &#123;</span><br><span class="line">   [x subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">       <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">   &#125;];</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// switchToLatest: è·å–ä¿¡å·ä¸­ä¿¡å·å‘é€çš„æœ€æ–°ä¿¡å·</span></span><br><span class="line">[signalofsignals.switchToLatest subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">[signalofsignals sendNext:signalA];</span><br><span class="line">[signalA sendNext:@<span class="number">4</span>];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›‘å¬äº‹ä»¶æœ‰æ²¡æœ‰å®Œæˆ</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šå½“å‰å‘½ä»¤å†…éƒ¨å‘é€æ•°æ®å®Œæˆï¼Œä¸€å®šè¦ä¸»åŠ¨å‘é€å®Œæˆ</span></span><br><span class="line"><span class="comment">// 1.åˆ›å»ºå‘½ä»¤</span></span><br><span class="line">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(<span class="keyword">id</span> input) &#123;</span><br><span class="line">    <span class="comment">// blockè°ƒç”¨ï¼šæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™å°±ä¼šè°ƒç”¨</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, input);</span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„è¿”å›å€¼ä¸å…è®¸ä¸ºnil</span></span><br><span class="line">    <span class="keyword">return</span> [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        <span class="comment">// å‘é€æ•°æ®</span></span><br><span class="line">        [subscriber sendNext:<span class="string">@"æ‰§è¡Œå‘½ä»¤äº§ç”Ÿçš„æ•°æ®"</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// *** å‘é€å®Œæˆ **</span></span><br><span class="line">        [subscriber sendCompleted];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// ç›‘å¬äº‹ä»¶æœ‰æ²¡æœ‰å®Œæˆ</span></span><br><span class="line">[command.executing subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="keyword">if</span> ([x boolValue] == <span class="literal">YES</span>) &#123; </span><br><span class="line">        <span class="comment">// æ­£åœ¨æ‰§è¡Œ</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"å½“å‰æ­£åœ¨æ‰§è¡Œ%@"</span>, x);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œå®Œæˆ/æ²¡æœ‰æ‰§è¡Œ</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"æ‰§è¡Œå®Œæˆ/æ²¡æœ‰æ‰§è¡Œ"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">[command execute:@<span class="number">1</span>];</span><br></pre></td></tr></table></figure><h3 id="è¿›é˜¶ç”¨æ³•"><a href="#è¿›é˜¶ç”¨æ³•" class="headerlink" title="è¿›é˜¶ç”¨æ³•"></a>è¿›é˜¶ç”¨æ³•</h3><h4 id="RAC-å¸¸ç”¨å®"><a href="#RAC-å¸¸ç”¨å®" class="headerlink" title="RAC å¸¸ç”¨å®"></a>RAC å¸¸ç”¨å®</h4><p>RAC æœ‰è®¸å¤šå¼ºå¤§è€Œæ–¹ä¾¿çš„å®ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤º</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RAC: æŠŠä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§ç»‘å®šä¸€ä¸ªä¿¡å·ï¼Œåªè¦å‘å‡ºä¿¡å·ï¼Œå°±ä¼šæŠŠä¿¡å·çš„å†…å®¹ç»™å¯¹è±¡çš„å±æ€§èµ‹å€¼</span></span><br><span class="line"><span class="comment">// ç»™ label çš„ text å±æ€§ç»‘å®šäº†æ–‡æœ¬æ¡†æ”¹å˜çš„ä¿¡å·</span></span><br><span class="line">RAC(<span class="keyword">self</span>.label, text) = <span class="keyword">self</span>.textField.rac_textSignal;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ä¸Šè¿°åŒæ ·åŠŸèƒ½</span></span><br><span class="line">[<span class="keyword">self</span>.textField.rac_textSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line"><span class="keyword">self</span>.label.text = x;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* KVO</span></span><br><span class="line"><span class="comment">* RACObserveL: å¿«é€Ÿçš„ç›‘å¬æŸä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æ”¹å˜</span></span><br><span class="line"><span class="comment">* è¿”å›çš„æ˜¯ä¸€ä¸ªä¿¡å·ï¼Œå¯¹è±¡çš„æŸä¸ªå±æ€§æ”¹å˜çš„ä¿¡å·</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[RACObserve(<span class="keyword">self</span>.view, center) subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¾‹ textField è¾“å…¥çš„å€¼èµ‹å€¼ç»™labelï¼Œç›‘å¬ label æ–‡å­—æ”¹å˜</span></span><br><span class="line">RAC(<span class="keyword">self</span>.label, text) = <span class="keyword">self</span>.textField.rac_textSignal;</span><br><span class="line">[RACObserve(<span class="keyword">self</span>.label, text) subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"labelçš„æ–‡å­—å˜åŒ–"</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* å¾ªç¯å¼•ç”¨é—®é¢˜</span></span><br><span class="line"><span class="comment">* ä½¿ç”¨ @weakify(self) å’Œ @strongify(self) æ¥é¿å…å¾ªç¯å¼•ç”¨</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">@weakify(<span class="keyword">self</span>);</span><br><span class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">    @strongify(<span class="keyword">self</span>);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, <span class="keyword">self</span>.view);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;];</span><br><span class="line">_signal = signal;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* å…ƒç¥–</span></span><br><span class="line"><span class="comment">* å¿«é€ŸåŒ…è£…ä¸€ä¸ªå…ƒç»„</span></span><br><span class="line"><span class="comment">* æŠŠåŒ…è£…çš„ç±»å‹æ”¾åœ¨å®çš„å‚æ•°é‡Œé¢ï¼Œå°±ä¼šè‡ªåŠ¨åŒ…è£…</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">RACTuple *tuple = RACTuplePack(@<span class="number">1</span>, @<span class="number">2</span>, @<span class="number">4</span>);</span><br><span class="line"><span class="comment">// å®çš„å‚æ•°ç±»å‹è¦å’Œå…ƒç¥–ä¸­å…ƒç´ ç±»å‹ä¸€è‡´ï¼Œå³è¾¹ä¸ºè¦è§£æçš„å…ƒç¥–</span></span><br><span class="line">RACTupleUnpack_(<span class="built_in">NSNumber</span> *num1, <span class="built_in">NSNumber</span> *num2, <span class="built_in">NSNumber</span> * num3) = tuple;</span><br><span class="line"><span class="comment">// 4.å…ƒç¥–</span></span><br><span class="line"><span class="comment">// å¿«é€ŸåŒ…è£…ä¸€ä¸ªå…ƒç»„</span></span><br><span class="line"><span class="comment">// æŠŠåŒ…è£…çš„ç±»å‹æ”¾åœ¨å®çš„å‚æ•°é‡Œé¢ï¼Œå°±ä¼šè‡ªåŠ¨åŒ…è£…</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@ %@ %@"</span>, num1, num2, num3);</span><br></pre></td></tr></table></figure><h4 id="RAC-bind"><a href="#RAC-bind" class="headerlink" title="RAC-bind"></a>RAC-bind</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.åˆ›å»ºä¿¡å·</span></span><br><span class="line">RACSubject *subject = [RACSubject subject];</span><br><span class="line"><span class="comment">// 2.ç»‘å®šä¿¡å·</span></span><br><span class="line">RACSignal *bindSignal = [subject bind:^RACStreamBindBlock&#123;</span><br><span class="line">    <span class="comment">// blockè°ƒç”¨æ—¶åˆ»ï¼šåªè¦ç»‘å®šä¿¡å·è®¢é˜…å°±ä¼šè°ƒç”¨ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> ^RACSignal *(<span class="keyword">id</span> value, <span class="built_in">BOOL</span> *stop)&#123;</span><br><span class="line">        <span class="comment">// ä¸€èˆ¬åœ¨è¿™ä¸ªblockä¸­åšäº‹ ï¼Œå‘æ•°æ®çš„æ—¶å€™ä¼šæ¥åˆ°è¿™ä¸ªblockã€‚</span></span><br><span class="line">        <span class="comment">// åªè¦æºä¿¡å·ï¼ˆsubjectï¼‰å‘é€æ•°æ®ï¼Œå°±ä¼šè°ƒç”¨block</span></span><br><span class="line">        <span class="comment">// blockä½œç”¨ï¼šå¤„ç†æºä¿¡å·å†…å®¹</span></span><br><span class="line">        <span class="comment">// value:æºä¿¡å·å‘é€çš„å†…å®¹ï¼Œ</span></span><br><span class="line">        value = @<span class="number">3</span>; <span class="comment">// å¦‚æœåœ¨è¿™é‡ŒæŠŠ value çš„å€¼æ”¹äº†ï¼Œé‚£ä¹ˆè®¢é˜…ç»‘å®šä¿¡å·çš„å€¼çš„ x å°±å˜äº†</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"æ¥å—åˆ°æºä¿¡å·çš„å†…å®¹ï¼š%@"</span>, value);</span><br><span class="line">        <span class="comment">// è¿”å›ä¿¡å·ï¼Œä¸èƒ½ä¸ºnil,å¦‚æœéè¦è¿”å›ç©º---åˆ™emptyæˆ– alloc initã€‚</span></span><br><span class="line">        <span class="keyword">return</span> [RACReturnSignal <span class="keyword">return</span>:value]; <span class="comment">// æŠŠè¿”å›çš„å€¼åŒ…è£…æˆä¿¡å·</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.è®¢é˜…ç»‘å®šä¿¡å·</span></span><br><span class="line">[bindSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æ¥æ”¶åˆ°ç»‘å®šä¿¡å·å¤„ç†å®Œçš„ä¿¡å·:%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// 4.å‘é€ä¿¡å·</span></span><br><span class="line">[subject sendNext:<span class="string">@"123"</span>];</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“</strong></p><ol><li>bindï¼ˆç»‘å®šï¼‰çš„ä½¿ç”¨æ€æƒ³å’Œ Hook çš„ä¸€æ · â€”&gt; éƒ½æ˜¯æ‹¦æˆª API ä»è€Œå¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ“ä½œï¼Œè€Œå½±å“è¿”å›æ•°æ®</li></ol><h4 id="RAC-è¿‡æ»¤"><a href="#RAC-è¿‡æ»¤" class="headerlink" title="RAC-è¿‡æ»¤"></a>RAC-è¿‡æ»¤</h4><p>æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦è¿‡æ»¤ä¸€äº›ä¿¡å·ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¾¿å¯ä»¥ç”¨ RAC çš„è¿‡æ»¤æ–¹æ³•ã€‚è¿‡æ»¤æ–¹æ³•æœ‰å¥½å¤šç§ï¼Œå¦‚ä¸‹ä»£ç ï¼Œä»ä¸åŒæƒ…å†µä¸‹è¿›è¡Œäº†åˆ†æã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·³è·ƒ ï¼š å¦‚ä¸‹ï¼Œskipä¼ å…¥ 2 è·³è¿‡å‰é¢ä¸¤ä¸ªå€¼</span></span><br><span class="line"><span class="comment">// å®é™…ç”¨å¤„ï¼š åœ¨å®é™…å¼€å‘ä¸­æ¯”å¦‚ åå°è¿”å›çš„æ•°æ®å‰é¢å‡ ä¸ªæ²¡ç”¨ï¼Œæˆ‘ä»¬æƒ³è·³è·ƒè¿‡å»ï¼Œä¾¿å¯ä»¥ç”¨skip</span></span><br><span class="line">RACSubject *subject = [RACSubject subject];</span><br><span class="line">[[subject skip:<span class="number">2</span>] subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line">[subject sendNext:@<span class="number">1</span>];</span><br><span class="line">[subject sendNext:@<span class="number">2</span>];</span><br><span class="line">[subject sendNext:@<span class="number">3</span>];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// distinctUntilChanged: -- å¦‚æœå½“å‰çš„å€¼è·Ÿä¸Šä¸€æ¬¡çš„å€¼ä¸€æ ·ï¼Œå°±ä¸ä¼šè¢«è®¢é˜…åˆ°</span></span><br><span class="line">RACSubject *subject = [RACSubject subject];</span><br><span class="line">[[subject distinctUntilChanged] subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">[subject sendNext:@<span class="number">1</span>];</span><br><span class="line">[subject sendNext:@<span class="number">2</span>];</span><br><span class="line">[subject sendNext:@<span class="number">2</span>]; <span class="comment">// ä¸ä¼šè®¢é˜…åˆ°</span></span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// take: å¯ä»¥å±è”½ä¸€äº›å€¼ï¼Œå»æ‰å‰é¢å‡ ä¸ªå€¼---è¿™é‡Œ take ä¸º2 åˆ™åªæ‹¿åˆ°å‰ä¸¤ä¸ªå€¼</span></span><br><span class="line">RACSubject *subject = [RACSubject subject];</span><br><span class="line">[[subject take:<span class="number">2</span>] subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">[subject sendNext:@<span class="number">1</span>];</span><br><span class="line">[subject sendNext:@<span class="number">2</span>];</span><br><span class="line">[subject sendNext:@<span class="number">3</span>]; <span class="comment">// ä¸ä¼šè®¢é˜…åˆ°</span></span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//takeLast:å’Œtakeçš„ç”¨æ³•ä¸€æ ·ï¼Œä¸è¿‡ä»–å–çš„æ˜¯æœ€åçš„å‡ ä¸ªå€¼ï¼Œå¦‚ä¸‹ï¼Œåˆ™å–çš„æ˜¯æœ€åä¸¤ä¸ªå€¼</span></span><br><span class="line"><span class="comment">//æ³¨æ„ç‚¹:takeLast ä¸€å®šè¦è°ƒç”¨sendCompletedï¼Œå‘Šè¯‰ä»–å‘é€å®Œæˆäº†ï¼Œè¿™æ ·æ‰èƒ½å–åˆ°æœ€åçš„å‡ ä¸ªå€¼</span></span><br><span class="line">RACSubject *subject = [RACSubject subject];</span><br><span class="line">[[subject takeLast:<span class="number">2</span>] subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">[subject sendNext:@<span class="number">1</span>]; <span class="comment">// ä¸ä¼šè®¢é˜…åˆ°</span></span><br><span class="line">[subject sendNext:@<span class="number">2</span>];</span><br><span class="line">[subject sendNext:@<span class="number">3</span>];</span><br><span class="line">[subject sendCompleted];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// takeUntil: ç»™ takeUntil ä¼ çš„æ˜¯å“ªä¸ªä¿¡å·ï¼Œé‚£ä¹ˆå½“è¿™ä¸ªä¿¡å·å‘é€ä¿¡å·æˆ– sendCompletedï¼Œå°±ä¸èƒ½å†æ¥å—æºä¿¡å·çš„å†…å®¹</span></span><br><span class="line">RACSubject *subject = [RACSubject subject];</span><br><span class="line">RACSubject *subject2 = [RACSubject subject];</span><br><span class="line">[[subject takeUntil:subject2] subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">[subject sendNext:@<span class="number">1</span>];</span><br><span class="line">[subject sendNext:@<span class="number">2</span>];</span><br><span class="line">[subject2 sendNext:@<span class="number">3</span>];  <span class="comment">// 1</span></span><br><span class="line">[subject2 sendCompleted]; <span class="comment">// æˆ–2</span></span><br><span class="line">[subject sendNext:@<span class="number">4</span>];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ignore: å¿½ç•¥æ‰ä¸€äº›å€¼</span></span><br><span class="line"><span class="comment">// ignore:å¿½ç•¥ä¸€äº›å€¼</span></span><br><span class="line"><span class="comment">// ignoreValues:è¡¨ç¤ºå¿½ç•¥æ‰€æœ‰çš„å€¼</span></span><br><span class="line"><span class="comment">// 1.åˆ›å»ºä¿¡å·</span></span><br><span class="line">RACSubject *subject = [RACSubject subject];</span><br><span class="line"><span class="comment">// 2.å¿½ç•¥ä¸€äº›å€¼</span></span><br><span class="line">RACSignal *ignoreSignal = [subject ignore:@<span class="number">2</span>]; <span class="comment">// ignoreValues:è¡¨ç¤ºå¿½ç•¥æ‰€æœ‰çš„å€¼</span></span><br><span class="line"><span class="comment">// 3.è®¢é˜…ä¿¡å·</span></span><br><span class="line">[ignoreSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// 4.å‘é€æ•°æ®</span></span><br><span class="line">[subject sendNext:@<span class="number">2</span>];</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€èˆ¬å’Œæ–‡æœ¬æ¡†ä¸€èµ·ç”¨ï¼Œæ·»åŠ è¿‡æ»¤æ¡ä»¶</span></span><br><span class="line"><span class="comment">// åªæœ‰å½“æ–‡æœ¬æ¡†çš„å†…å®¹é•¿åº¦å¤§äº 5ï¼Œæ‰è·å–æ–‡æœ¬æ¡†é‡Œçš„å†…å®¹</span></span><br><span class="line">[[<span class="keyword">self</span>.textField.rac_textSignal filter:^<span class="built_in">BOOL</span>(<span class="keyword">id</span> value) &#123;</span><br><span class="line">    <span class="comment">// value æºä¿¡å·çš„å†…å®¹</span></span><br><span class="line">    <span class="keyword">return</span> [value length] &gt; <span class="number">5</span>;</span><br><span class="line">    <span class="comment">// è¿”å›å€¼ å°±æ˜¯è¿‡æ»¤æ¡ä»¶ã€‚åªæœ‰æ»¡è¶³è¿™ä¸ªæ¡ä»¶æ‰èƒ½è·å–åˆ°å†…å®¹</span></span><br><span class="line">&#125;] subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><h4 id="RAC-æ˜ å°„"><a href="#RAC-æ˜ å°„" class="headerlink" title="RAC-æ˜ å°„"></a>RAC-æ˜ å°„</h4><p>RACçš„æ˜ å°„åœ¨å®é™…å¼€å‘ä¸­æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ‹¦æˆªæœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼Œç»™æ•°æ®æ‹¼æ¥ç‰¹å®šçš„ä¸œè¥¿æˆ–æƒ³å¯¹æ•°æ®è¿›è¡Œæ“ä½œä»è€Œæ›´æ”¹è¿”å›å€¼ï¼Œç±»ä¼¼äºè¿™æ ·çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥è€ƒè™‘ç”¨ RAC çš„æ˜ å°„ï¼Œå®ä¾‹ä»£ç å¦‚ä¸‹</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)map &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·</span></span><br><span class="line">    RACSubject *subject = [RACSubject subject];</span><br><span class="line">    <span class="comment">// ç»‘å®šä¿¡å·</span></span><br><span class="line">    RACSignal *bindSignal = [subject map:^<span class="keyword">id</span>(<span class="keyword">id</span> value) &#123;</span><br><span class="line">        <span class="comment">// è¿”å›çš„ç±»å‹å°±æ˜¯ä½ éœ€è¦æ˜ å°„çš„å€¼</span></span><br><span class="line">        <span class="comment">// è¿™é‡Œå°†æºä¿¡å·å‘é€çš„â€œ123â€ å‰é¢æ‹¼æ¥äº† wsï¼š</span></span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"ws:%@"</span>, value]; </span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="comment">// è®¢é˜…ç»‘å®šä¿¡å·</span></span><br><span class="line">    [bindSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">    [subject sendNext:<span class="string">@"123"</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)flatMap &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·</span></span><br><span class="line">    RACSubject *subject = [RACSubject subject];</span><br><span class="line">    <span class="comment">// ç»‘å®šä¿¡å·</span></span><br><span class="line">    RACSignal *bindSignal = [subject flattenMap:^RACStream *(<span class="keyword">id</span> value) &#123;</span><br><span class="line">        <span class="comment">// blockï¼šåªè¦æºä¿¡å·å‘é€å†…å®¹å°±ä¼šè°ƒç”¨</span></span><br><span class="line">        <span class="comment">// value: å°±æ˜¯æºä¿¡å·å‘é€çš„å†…å®¹</span></span><br><span class="line">        <span class="comment">// è¿”å›ä¿¡å·ç”¨æ¥åŒ…è£…æˆä¿®æ”¹å†…å®¹çš„å€¼</span></span><br><span class="line">        <span class="keyword">return</span> [RACReturnSignal <span class="keyword">return</span>:value];</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// flattenMap ä¸­è¿”å›çš„æ˜¯ä»€ä¹ˆä¿¡å·ï¼Œè®¢é˜…çš„å°±æ˜¯ä»€ä¹ˆä¿¡å·</span></span><br><span class="line">    <span class="comment">// (é‚£ä¹ˆ x çš„å€¼ç­‰äº value çš„å€¼ï¼Œå¦‚æœæˆ‘ä»¬æ“çºµ value çš„å€¼é‚£ä¹ˆ x ä¹Ÿä¼šéšä¹‹è€Œå˜)</span></span><br><span class="line">    <span class="comment">// è®¢é˜…ä¿¡å·</span></span><br><span class="line">    [bindSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€æ•°æ®</span></span><br><span class="line">    [subject sendNext:<span class="string">@"123"</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)flattenMap2 &#123;</span><br><span class="line">    <span class="comment">// flattenMap ä¸»è¦ç”¨äºä¿¡å·ä¸­çš„ä¿¡å·</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·</span></span><br><span class="line">    RACSubject *signalofSignals = [RACSubject subject];</span><br><span class="line">    RACSubject *signal = [RACSubject subject];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¢é˜…ä¿¡å·</span></span><br><span class="line">    <span class="comment">//æ–¹å¼1</span></span><br><span class="line">    [signalofSignals subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        [x subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">           <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="comment">// æ–¹å¼2</span></span><br><span class="line">    [signalofSignals.switchToLatest];</span><br><span class="line">    <span class="comment">// æ–¹å¼3</span></span><br><span class="line">    RACSignal *bignSignal = [signalofSignals flattenMap:^RACStream *(<span class="keyword">id</span> value) &#123;</span><br><span class="line">        <span class="comment">//value: å°±æ˜¯æºä¿¡å·å‘é€å†…å®¹</span></span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;];</span><br><span class="line">    [bignSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="comment">// æ–¹å¼4 ä¹Ÿæ˜¯å¼€å‘ä¸­å¸¸ç”¨çš„</span></span><br><span class="line">    [[signalofSignals flattenMap:^RACStream *(<span class="keyword">id</span> value) &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;] subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€ä¿¡å·</span></span><br><span class="line">    [signalofSignals sendNext:signal];</span><br><span class="line">    [signal sendNext:<span class="string">@"123"</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="RAC-ç»„åˆ"><a href="#RAC-ç»„åˆ" class="headerlink" title="RAC-ç»„åˆ"></a>RAC-ç»„åˆ</h4><p>æŠŠå¤šä¸ªä¿¡å·èšåˆæˆä½ æƒ³è¦çš„ä¿¡å·</p><p>ä½¿ç”¨åœºæ™¯ï¼šå½“å¤šä¸ªè¾“å…¥æ¡†éƒ½æœ‰å€¼çš„æ—¶å€™ï¼ŒæŒ‰é’®çŠ¶æ€å¯ç‚¹å‡»</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŠŠè¾“å…¥æ¡†è¾“å…¥å€¼çš„ä¿¡å·éƒ½èšåˆæˆæŒ‰é’®æ˜¯å¦èƒ½ç‚¹å‡»çš„ä¿¡å·</span></span><br><span class="line">- (<span class="keyword">void</span>)combineLatest &#123;</span><br><span class="line">    RACSignal *combinSignal = [RACSignal combineLatest:@[<span class="keyword">self</span>.accountField.rac_textSignal, <span class="keyword">self</span>.pwdField.rac_textSignal] reduce:^<span class="keyword">id</span>(<span class="built_in">NSString</span> *account, <span class="built_in">NSString</span> *pwd)&#123; </span><br><span class="line">        <span class="comment">//reduceé‡Œçš„å‚æ•°ä¸€å®šè¦å’ŒcombineLatestæ•°ç»„é‡Œçš„ä¸€ä¸€å¯¹åº”ã€‚</span></span><br><span class="line">    <span class="comment">// block: åªè¦æºä¿¡å·å‘é€å†…å®¹ï¼Œå°±ä¼šè°ƒç”¨ï¼Œç»„åˆæˆä¸€ä¸ªæ–°å€¼ã€‚</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@ %@"</span>, account, pwd);</span><br><span class="line">    <span class="keyword">return</span> @(account.length &amp;&amp; pwd.length);</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…ä¿¡å·</span></span><br><span class="line">[combinSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">    <span class="keyword">self</span>.loginBtn.enabled = [x boolValue];</span><br><span class="line">&#125;];    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¿™æ ·å†™æœ‰äº›éº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥ç”¨RACå®</span></span><br><span class="line">    RAC(<span class="keyword">self</span>.loginBtn, enabled) = combinSignal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)zipWith &#123;</span><br><span class="line">    <span class="comment">// zipWith:æŠŠä¸¤ä¸ªä¿¡å·å‹ç¼©æˆä¸€ä¸ªä¿¡å·ï¼Œåªæœ‰å½“ä¸¤ä¸ªä¿¡å·åŒæ—¶å‘å‡ºä¿¡å·å†…å®¹æ—¶</span></span><br><span class="line">    <span class="comment">// å¹¶ä¸”æŠŠä¸¤ä¸ªä¿¡å·çš„å†…å®¹åˆå¹¶æˆä¸€ä¸ªå…ƒç¥–ï¼Œæ‰ä¼šè§¦å‘å‹ç¼©æµçš„nextäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·A</span></span><br><span class="line">    RACSubject *signalA = [RACSubject subject];</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·B</span></span><br><span class="line">    RACSubject *signalB = [RACSubject subject];</span><br><span class="line">    <span class="comment">// å‹ç¼©æˆä¸€ä¸ªä¿¡å·</span></span><br><span class="line">    <span class="comment">// **-zipWith-**: å½“ä¸€ä¸ªç•Œé¢å¤šä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œè¦ç­‰æ‰€æœ‰è¯·æ±‚å®Œæˆæ‰æ›´æ–°UI</span></span><br><span class="line">    <span class="comment">// ç­‰æ‰€æœ‰ä¿¡å·éƒ½å‘é€å†…å®¹çš„æ—¶å€™æ‰ä¼šè°ƒç”¨</span></span><br><span class="line">    RACSignal *zipSignal = [signalA zipWith:signalB];</span><br><span class="line">    [zipSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="comment">//æ‰€æœ‰çš„å€¼éƒ½è¢«åŒ…è£…æˆäº†å…ƒç»„</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x); </span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€ä¿¡å· äº¤äº’é¡ºåºï¼Œå…ƒç»„å†…å…ƒç´ çš„é¡ºåºä¸ä¼šå˜ï¼Œè·Ÿå‘é€çš„é¡ºåºæ— å…³ï¼Œ</span></span><br><span class="line">    <span class="comment">// è€Œæ˜¯è·Ÿå‹ç¼©çš„é¡ºåºæœ‰å…³ [signalA zipWith:signalB] --- å…ˆæ˜¯ A åæ˜¯ B</span></span><br><span class="line">    [signalA sendNext:@<span class="number">1</span>];</span><br><span class="line">    [signalB sendNext:@<span class="number">2</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»»ä½•ä¸€ä¸ªä¿¡å·è¯·æ±‚å®Œæˆéƒ½ä¼šè¢«è®¢é˜…åˆ°</span></span><br><span class="line"><span class="comment">// merge: å¤šä¸ªä¿¡å·åˆå¹¶æˆä¸€ä¸ªä¿¡å·ï¼Œä»»ä½•ä¸€ä¸ªä¿¡å·æœ‰æ–°å€¼å°±ä¼šè°ƒç”¨</span></span><br><span class="line">- (<span class="keyword">void</span>)merge &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·A</span></span><br><span class="line">    RACSubject *signalA = [RACSubject subject];</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·B</span></span><br><span class="line">    RACSubject *signalB = [RACSubject subject];</span><br><span class="line">    <span class="comment">// ç»„åˆä¿¡å·</span></span><br><span class="line">    RACSignal *mergeSignal = [signalA merge:signalB];</span><br><span class="line">    <span class="comment">// è®¢é˜…ä¿¡å·</span></span><br><span class="line">    [mergeSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="comment">// å‘é€ä¿¡å·---äº¤æ¢ä½ç½®åˆ™æ•°æ®ç»“æœé¡ºåºä¹Ÿä¼šäº¤æ¢</span></span><br><span class="line">    [signalB sendNext:<span class="string">@"ä¸‹éƒ¨åˆ†"</span>];</span><br><span class="line">    [signalA sendNext:<span class="string">@"ä¸Šéƒ¨åˆ†"</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// then ä½¿ç”¨éœ€æ±‚ï¼šæœ‰ä¸¤éƒ¨åˆ†æ•°æ®ï¼šæƒ³è®©ä¸Šéƒ¨åˆ†å…ˆè¿›è¡Œç½‘ç»œè¯·æ±‚ä½†æ˜¯è¿‡æ»¤æ‰æ•°æ®ï¼Œç„¶åè¿›è¡Œä¸‹éƒ¨åˆ†çš„ï¼Œæ‹¿åˆ°ä¸‹éƒ¨åˆ†æ•°æ®</span></span><br><span class="line">- (<span class="keyword">void</span>)then &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·A</span></span><br><span class="line">    RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        <span class="comment">// å‘é€è¯·æ±‚</span></span><br><span class="line">        [subscriber sendNext:<span class="string">@"ä¸Šéƒ¨åˆ†æ•°æ®"</span>];</span><br><span class="line">        [subscriber sendCompleted]; <span class="comment">// å¿…é¡»è¦è°ƒç”¨sendCompletedæ–¹æ³•ï¼</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·B</span></span><br><span class="line">    RACSignal *signalsB = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        <span class="comment">// å‘é€è¯·æ±‚</span></span><br><span class="line">        [subscriber sendNext:<span class="string">@"ä¸‹éƒ¨åˆ†æ•°æ®"</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="comment">// åˆ›å»ºç»„åˆä¿¡å·</span></span><br><span class="line">    <span class="comment">// then;å¿½ç•¥æ‰ç¬¬ä¸€ä¸ªä¿¡å·çš„æ‰€æœ‰å€¼</span></span><br><span class="line">    RACSignal *thenSignal = [signalA then:^RACSignal *&#123;</span><br><span class="line">        <span class="comment">// è¿”å›çš„ä¿¡å·å°±æ˜¯è¦ç»„åˆçš„ä¿¡å·</span></span><br><span class="line">        <span class="keyword">return</span> signalsB;</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¢é˜…ä¿¡å·</span></span><br><span class="line">    [thenSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// concat ä½¿ç”¨éœ€æ±‚ï¼šæœ‰ä¸¤éƒ¨åˆ†æ•°æ®ï¼šæƒ³è®©ä¸Šéƒ¨åˆ†å…ˆæ‰§è¡Œï¼Œå®Œäº†ä¹‹åå†è®©ä¸‹éƒ¨åˆ†æ‰§è¡Œï¼ˆéƒ½å¯è·å–å€¼ï¼‰</span></span><br><span class="line">- (<span class="keyword">void</span>)concat &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·A</span></span><br><span class="line">    RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        <span class="comment">// å‘é€è¯·æ±‚</span></span><br><span class="line">        [subscriber sendNext:<span class="string">@"ä¸Šéƒ¨åˆ†æ•°æ®"</span>];</span><br><span class="line">        [subscriber sendCompleted]; <span class="comment">// å¿…é¡»è¦è°ƒç”¨sendCompletedæ–¹æ³•ï¼</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¿¡å·B</span></span><br><span class="line">    RACSignal *signalsB = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">        <span class="comment">// å‘é€è¯·æ±‚</span></span><br><span class="line">        [subscriber sendNext:<span class="string">@"ä¸‹éƒ¨åˆ†æ•°æ®"</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// concat: æŒ‰é¡ºåºå»é“¾æ¥</span></span><br><span class="line">    <span class="comment">//**-æ³¨æ„-**ï¼šconcatï¼Œç¬¬ä¸€ä¸ªä¿¡å·å¿…é¡»è¦è°ƒç”¨sendCompleted</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºç»„åˆä¿¡å·</span></span><br><span class="line">    RACSignal *concatSignal = [signalA concat:signalsB];</span><br><span class="line">    <span class="comment">// è®¢é˜…ç»„åˆä¿¡å·</span></span><br><span class="line">    [concatSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,x);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç©¶å…¶æœ¬è´¨æ ¸å¿ƒå°±æ˜¯å„ç§ signalsï¼Œä¹Ÿå°±æ˜¯bindï¼ˆç»‘å®šï¼‰ï¼Œå¤„ç†ç›¸å…³äº‹ç‰©çš„æ—¶å€™é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯ç»‘å®šï¼ŒåŸºæœ¬å¤§å¤šæ•°æ“ä½œä¹Ÿéƒ½æ˜¯å›´ç»•ç€ä¿¡å·è¿›è¡Œçš„ï¼Œä»¥ä¸Šä¸ä»…ä»…æ˜¯ RAC çš„åŸºæœ¬ç”¨æ³•ï¼Œåœ¨ MVVM ä¸­ä¹Ÿæ˜¯åŒæ ·é€‚ç”¨ï¼Œåªæ˜¯æŠŠä¸šåŠ¡å’Œé€»è¾‘é€šè¿‡ ViewModel åˆ†ç¦»è§£è€¦ï¼Œæ›´å¤§ç¨‹åº¦çš„åˆ©ç”¨äº† RAC åœ¨å¼€å‘ä¸­çš„é«˜æ•ˆä¼˜åŠ¿ã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://halfrost.com/tag/reactivecocoa/" target="_blank" rel="noopener">å‡½æ•°å“åº”å¼ç¼–ç¨‹(FRP)ä»å…¥é—¨åˆ°â€æ”¾å¼ƒâ€</a></li><li><a href="http://blog.harrisonxi.com/2017/07/iOS%E4%BD%BF%E7%94%A8RAC%E5%AE%9E%E7%8E%B0MVVM%E7%9A%84%E6%AD%A3%E7%BB%8F%E5%A7%BF%E5%8A%BF.html" target="_blank" rel="noopener">iOSä½¿ç”¨RACå®ç°MVVMçš„æ­£ç»å§¿åŠ¿</a></li><li><a href="https://draveness.me/tag/RAC/" target="_blank" rel="noopener">ã€çŠ¶æ€ã€é©±åŠ¨çš„ä¸–ç•Œï¼šReactiveCocoa ç³»åˆ—</a></li><li><a href="http://chaoxn.com/2015/11/12/ReactiveCocoa%E4%B8%8EMVVM/" target="_blank" rel="noopener">ReactiveCocoaå­¦ä¹ æ€»ç»“</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼€ç¯‡&quot;&gt;&lt;a href=&quot;#å¼€ç¯‡&quot; class=&quot;headerlink&quot; title=&quot;å¼€ç¯‡&quot;&gt;&lt;/a&gt;å¼€ç¯‡&lt;/h2&gt;&lt;p&gt;åœ¨ iOS å¼€å‘ä¸­ï¼Œæˆ–å¤šæˆ–å°‘éƒ½ä¼šè§è¿‡ RAC çš„èº«å½±ï¼Œå®ƒä¸ºæé«˜å¼€å‘æ•ˆç‡è€Œç”Ÿï¼Œåœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹å¼€å‘æ—¶å¯ä»¥å¤§å¤§ç®€åŒ–ä»£ç ï¼Œå¹¶ä¸”ç›®å‰æ¥çœ‹å®‰å…¨å¯é ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰æ¥è§¦ RACï¼Œå»ºè®®ä½ å·¥ä½œä¹‹ä½™ç¨ä½œç ”ç©¶ï¼Œå¹¶å°è¯•ä½“éªŒä¸€ä¸‹ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="rac" scheme="https://blog.yuhanle.com/categories/rac/"/>
    
    
      <category term="rac" scheme="https://blog.yuhanle.com/tags/rac/"/>
    
  </entry>
  
  <entry>
    <title>ä»£ç ä¸­çš„ç¼©è¿›çº¿</title>
    <link href="https://blog.yuhanle.com/2018/04/24/line-of-sight-in-code/"/>
    <id>https://blog.yuhanle.com/2018/04/24/line-of-sight-in-code/</id>
    <published>2018-04-24T01:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.338Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/studygolang/gctt-images/master/line-of-sight/1_CBjBs9EzL8q1AL6XvjjpJg.png" alt="æˆ‘åœ¨2016å¹´ä¼¦æ•¦Golangè‹±å›½ä¼šè®®ä¸Šè°ˆè®ºä»£ç ç¼©è¿›çº¿"></p><p>åœ¨è¿‘æœŸä¼¦æ•¦ä¸¾è¡Œçš„ <a href="https://www.youtube.com/watch?v=yeetIgNeIkc" target="_blank" rel="noopener">Golang è‹±å›½ä¼šè®®</a> ä¸Šï¼Œæˆ‘åœ¨<a href="https://www.youtube.com/watch?v=yeetIgNeIkc" target="_blank" rel="noopener">åœ°é“çš„Go è¯­è¨€çªé—¨</a> äº¤æµï¼ˆ<a href="http://go-talks.appspot.com/github.com/matryer/present/idiomatic-go-tricks/main.slide#1" target="_blank" rel="noopener">å¹»ç¯ç‰‡</a>ï¼‰ä¸­è®²åˆ°å…³äºä»£ç ä¸­çš„ç¼©è¿›çº¿ï¼Œ æˆ‘æƒ³åœ¨è¿™é‡Œç¨å¾®è§£é‡Šä¸€ä¸‹ã€‚</p><a id="more"></a><blockquote><p>ç¼©è¿›çº¿æ˜¯â€œè§‚å¯Ÿè€…æ— éšœç¢è§†çº¿çš„ç›´çº¿â€</p></blockquote><p><img src="https://raw.githubusercontent.com/studygolang/gctt-images/master/line-of-sight/1_nXXRSHi_1kmgorkcDHyc1Q.png" alt="ä»£ç ä¸­çš„ç¼©è¿›çº¿ï¼šå·¦å›¾çš„ç¼©è¿›æ˜¯é”™è¯¯å¤„ç†å’Œè¾¹ç¼˜æƒ…å†µçš„å¿«ä¹è·¯å¾„"></p><p>è‰¯å¥½çš„ä»£ç ç¼©è¿›çº¿ä¸ä»…å¯¹ä½ çš„åŠŸèƒ½æ²¡æœ‰ä»»ä½•å½±å“ï¼Œè¿˜å¯ä»¥å¸®åŠ©å…¶ä»–éœ€è¦çš„äººé˜…è¯»ä½ çš„ä»£ç ã€‚å…¶ä»–ç¨‹åºå‘˜ï¼ˆåŒ…æ‹¬ä½ æœªæ¥çš„è‡ªå·±ï¼‰å¯ä»¥æµè§ˆä¸€ä¸ªä¸“æ å¹¶ä¸”ç†è§£ä»£ç çš„é¢„æœŸæµç¨‹ã€‚å¦‚æœä»–ä»¬ä¸å¾—ä¸åœ¨è„‘å­é‡Œåˆ†æ <code>if</code> è¯­å¥ï¼Œè‹¥æ²¡æœ‰è‰¯å¥½çš„ç¼©è¿›çº¿ï¼Œå°†ä¼šä½¿è¿™ä¸ªä»»åŠ¡å˜å¾—éå¸¸è‰°éš¾ã€‚</p><blockquote><p>å¤§å¤šæ•°äººå…³æ³¨ç¼–å†™ä»£ç çš„ä»£ä»·ï¼ˆæ¯”å¦‚â€œè¿™éœ€è¦å¤šé•¿æ—¶é—´æ‰èƒ½å®Œæˆï¼Ÿâ€ï¼‰ä½†æ˜¯ç»´æŠ¤ä»£ç çš„æˆæœ¬è¦é«˜å¾—å¤š - ç‰¹åˆ«æ˜¯åœ¨æˆç†Ÿçš„é¡¹ç›®ä¸­ã€‚ è®©åŠŸèƒ½æ˜æ˜¾ï¼Œæ¸…æ™°ï¼Œç®€å•æ˜“æ‡‚æ‰æ˜¯è‡³å…³é‡è¦çš„ã€‚</p></blockquote><p>è‰¯å¥½ç¼©è¿›çº¿çš„å»ºè®®ï¼š</p><ul><li>è®©<a href="https://en.wikipedia.org/wiki/Happy_path" target="_blank" rel="noopener">å¿«ä¹è·¯å¾„</a>å±…å·¦ä¾§å¯¹é½ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å¿«é€Ÿæ‰«æä¸€åˆ—æ¥æŸ¥çœ‹é¢„æœŸçš„æ‰§è¡Œæµç¨‹</li><li>ä¸è¦éšè—ç¼©è¿›å¤§æ‹¬å·ä¸­ä»£ç é€»è¾‘</li><li>å°½æ—©çš„é€€å‡º <code>function</code></li><li>é¿å… <code>else return</code>ï¼Œè€ƒè™‘ç¿»è½¬ <code>if</code> è¯­å¥</li><li>æŠŠ <code>return</code> å£°æ˜ä½œä¸ºæœ€åä¸€è¡Œ</li><li>æå– <code>function</code> å’Œ <code>method</code> ä»¥ä¿æŒç»“æ„å°å·§å’Œå¯è¯»</li><li>å¦‚æœä½ éœ€è¦å¤§ç¼©è¿›çš„ä»£ç ï¼Œè€ƒè™‘å½“åšä¸€ä¸ª <code>function</code> åˆ†è§£å‡ºæ¥</li></ul><p>å½“ç„¶ï¼Œä¼šæœ‰å¾ˆå¤šå¾ˆå¥½çš„ç†ç”±æ¥æ‰“ç ´æ‰€æœ‰è¿™äº›è§„åˆ™ - ä½†æ˜¯é‡‡ç”¨è¿™ç§é£æ ¼ä½œä¸ºé»˜è®¤è§„åˆ™ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„ä»£ç å˜å¾—æ›´å…·å¯è¯»æ€§ã€‚</p><h2 id="é¿å…-else-return"><a href="#é¿å…-else-return" class="headerlink" title="é¿å… else return"></a>é¿å… <code>else return</code></h2><p>ç¼–å†™å…·æœ‰è‰¯å¥½è§†è§‰æ•ˆæœçš„ä»£ç çš„å…³é”®æ˜¯ä¿æŒ <code>else</code> ç»“æ„å°å·§ï¼Œæˆ–è€…å¦‚æœå¯ä»¥çš„è¯ï¼Œå®Œå…¨é¿å…å®ƒä»¬ã€‚ çœ‹ä¸‹è¿™ä¸ªä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">if something.OK() &#123;</span><br><span class="line">    something.Lock()</span><br><span class="line">    defer something.Unlock()</span><br><span class="line">    err := something.Do()</span><br><span class="line">    if err == nil &#123;</span><br><span class="line">        stop := StartTimer()</span><br><span class="line">        defer stop()</span><br><span class="line">        log.Println(&quot;working...&quot;)</span><br><span class="line">        doWork(something)</span><br><span class="line">        &lt;-something.Done() // wait for it</span><br><span class="line">        log.Println(&quot;finished&quot;)</span><br><span class="line">        return nil</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return err</span><br><span class="line">    &#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    return errors.New(&quot;something not ok&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä»£è¡¨äº†æˆ‘ä»¬æœ€åˆå¦‚ä½•æ€è€ƒæˆ‘ä»¬çš„åŠŸèƒ½åœ¨åšä»€ä¹ˆï¼ˆâ€œå¦‚æœæŸä»¶äº‹æƒ…æ²¡é—®é¢˜ï¼Œé‚£ä¹ˆå°±åšï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œé‚£ä¹ˆåšè¿™äº›äº‹æƒ…â€ç­‰ç­‰ï¼‰ï¼Œä½†æ˜¯å®ƒå˜å¾—å¾ˆéš¾éµå¾ªã€‚</p><p>ä¸Šé¢çš„ä»£ç å¾ˆéš¾éµå¾ªâ€™å¿«ä¹è·¯å¾„â€™ï¼ˆæ‰§è¡Œé¡ºåˆ©è¿›è¡Œçš„è·¯çº¿ï¼‰ã€‚å®ƒåœ¨ç¬¬äºŒè¡Œå¼€å§‹ç¼©è¿›å¹¶ä»é‚£é‡Œç»§ç»­ã€‚ å½“æˆ‘ä»¬æ£€æŸ¥æ¥è‡ª <code>something.Do()</code> çš„é”™è¯¯è¿”å›æ—¶ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥ç¼©è¿›ã€‚ äº‹å®ä¸Šï¼Œè¯­å¥â€œ <code>return nil</code> â€åœ¨ä»£ç ä¸­é—´å®Œå…¨ä¸¢å¤±ã€‚</p><p><code>else</code> ç»“æ„åœ¨ Go å’Œå…¶ä»–è¯­è¨€ä¸­ä½œä¸ºå•ä¸€è¡Œè¿”å›å¾ˆå¸¸è§ï¼Œå› ä¸ºå®ƒä»¬è¦å¤„ç†ä¸­æ­¢æˆ–é€€å‡ºå‡½æ•°ã€‚ æˆ‘è®¤ä¸ºä»–ä»¬ä¸èƒ½ä¿è¯ç¼©è¿›æˆ‘ä»¬çš„å…¶ä»–ä»£ç ã€‚</p><h2 id="ç¿»è½¬-if-è¯­å¥"><a href="#ç¿»è½¬-if-è¯­å¥" class="headerlink" title="ç¿»è½¬ if è¯­å¥"></a>ç¿»è½¬ if è¯­å¥</h2><p>å¦‚æœæˆ‘ä»¬è¦ç¿»è¯‘ <code>if</code> è¯­å¥<em>ï¼ˆå¦‚æœä½ å–œæ¬¢</em> ï¼Œ <em>å°±æŠŠå®ƒä»¬</em>ç¿»<em>è¿‡æ¥ï¼‰</em> ï¼Œä½ å¯ä»¥çœ‹åˆ°ä»£ç å˜å¾—æ›´åŠ å¯è¯»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">if !something.OK() &#123;  // flipped</span><br><span class="line">    return errors.New(&quot;something not ok&quot;)</span><br><span class="line">&#125;</span><br><span class="line">something.Lock()</span><br><span class="line">defer something.Unlock()</span><br><span class="line">err := something.Do()</span><br><span class="line">if err != nil &#123;       // flipped</span><br><span class="line">    return err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stop := StartTimer()</span><br><span class="line">defer stop()</span><br><span class="line"></span><br><span class="line">log.Println(&quot;working...&quot;)</span><br><span class="line">doWork(something)</span><br><span class="line">&lt;-something.Done() // wait for it</span><br><span class="line">log.Println(&quot;finished&quot;)</span><br><span class="line">return nil</span><br></pre></td></tr></table></figure><p>åœ¨æ­¤ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨å°½æ—©é€€å‡ºï¼Œé€€å‡ºä»£ç ä¸æ­£å¸¸ä»£ç ä¸åŒã€‚è€Œä¸”ï¼Œ</p><ul><li>å¿«ä¹è·¯å¾„æ²¿ç€å·¦ä¾§å‘ä¸‹ä¿æŒï¼Œ</li><li>æˆ‘ä»¬ç¼©è¿›åªæ˜¯ä¸ºäº†å¤„ç†é”™è¯¯å’Œè¾¹ç¼˜æƒ…å†µï¼Œ</li><li>æˆ‘ä»¬çš„ <code>retutn</code> å£°æ˜â€œ <code>return nil</code> â€åœ¨æœ€åä¸€è¡Œï¼Œå¹¶ä¸”ï¼Œ</li><li>æˆ‘ä»¬æœ‰æ›´å°‘çš„ç¼©è¿›ä»£ç å—ã€‚</li></ul><h2 id="ä¿ƒè¿›å¤§å‹æ¡ä»¶å—çš„åŠŸèƒ½"><a href="#ä¿ƒè¿›å¤§å‹æ¡ä»¶å—çš„åŠŸèƒ½" class="headerlink" title="ä¿ƒè¿›å¤§å‹æ¡ä»¶å—çš„åŠŸèƒ½"></a>ä¿ƒè¿›å¤§å‹æ¡ä»¶å—çš„åŠŸèƒ½</h2><p>å¦‚æœä½ ä¸èƒ½é¿å…ä¸€ä¸ªç¬¨é‡çš„ <code>else</code> ç»“æ„æˆ–è‡ƒè‚¿çš„é€‰æ‹©åˆ‡æ¢çš„æƒ…å†µï¼ˆæˆ‘æ˜ç™½äº†ï¼Œæœ‰æ—¶å€™ä½ ä¸èƒ½ï¼‰ï¼Œé‚£ä¹ˆå°±è€ƒè™‘æŠŠæ¯ä¸ªç»“æ„åˆ†è§£æˆå®ƒè‡ªå·±çš„åŠŸèƒ½ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">func processValue(v interface&#123;&#125;) error &#123;</span><br><span class="line">    switch val := v.(type) &#123;</span><br><span class="line">    case string:</span><br><span class="line">        return processString(val)</span><br><span class="line">    case int:</span><br><span class="line">        return processInt(val)</span><br><span class="line">    case bool:</span><br><span class="line">        return processBool(val)</span><br><span class="line">    default:</span><br><span class="line">        return fmt.Errorf(&quot;unsupported type %T&quot;, v)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ¯”è¯»å–å¤§é‡çš„å¤„ç†ä»£ç æ›´å®¹æ˜“é˜…è¯»ã€‚</p><h2 id="åˆ†äº«ä½ çš„ç»éªŒ"><a href="#åˆ†äº«ä½ çš„ç»éªŒ" class="headerlink" title="åˆ†äº«ä½ çš„ç»éªŒ"></a>åˆ†äº«ä½ çš„ç»éªŒ</h2><p>å¦‚æœä½ åŒæ„æˆ‘çš„è§‚ç‚¹ï¼Œè¯·è€ƒè™‘åˆ†äº«è¿™ç¯‡æ–‡ç«  - éšç€è¶Šæ¥è¶Šå¤šçš„äººæ³¨å†Œï¼Œæ›´å¥½çš„ï¼ˆæ›´ä¸€è‡´çš„ï¼‰Go ä»£ç å°†ä¼šå‡ºç°ã€‚</p><p>ä½ æœ‰ä¸€äº›éš¾ä»¥é˜…è¯»çš„ä»£ç å—ï¼Ÿ ä¸ºä»€ä¹ˆä¸åœ¨ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;hl=zh-CN&amp;prev=search&amp;rurl=translate.google.com.hk&amp;sl=en&amp;sp=nmt4&amp;u=https://twitter.com/matryer&amp;xid=17259,15700023,15700124,15700149,15700168,15700173,15700186,15700201&amp;usg=ALkJrhgR995EkjexZDOQl9LYu8Sl7eq3TA" target="_blank" rel="noopener">Twitter @matryer</a> ä¸Šåˆ†äº«å®ƒï¼Œå¯ä»¥çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ›´æ¸…æ´ï¼Œæ›´ç®€å•çš„ç‰ˆæœ¬ã€‚</p><h2 id="è‡´è°¢â€¦"><a href="#è‡´è°¢â€¦" class="headerlink" title="è‡´è°¢â€¦"></a>è‡´è°¢â€¦</h2><p>è¯„è®ºå®¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;hl=zh-CN&amp;prev=search&amp;rurl=translate.google.com.hk&amp;sl=en&amp;sp=nmt4&amp;u=http://dave.cheney.net/&amp;xid=17259,15700023,15700124,15700149,15700168,15700173,15700186,15700201&amp;usg=ALkJrhgTC1jmfDNNabAZ1iX8dJSOjyuddw" target="_blank" rel="noopener">æˆ´å¤«åˆ‡å°¼</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;hl=zh-CN&amp;prev=search&amp;rurl=translate.google.com.hk&amp;sl=en&amp;sp=nmt4&amp;u=http://twitter.com/dahernan&amp;xid=17259,15700023,15700124,15700149,15700168,15700173,15700186,15700201&amp;usg=ALkJrhhm04bLuew6j4VCw3ACIxtPeMMmxA" target="_blank" rel="noopener">å¤§å«åŸƒå°”å—å¾·æ–¯</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;hl=zh-CN&amp;prev=search&amp;rurl=translate.google.com.hk&amp;sl=en&amp;sp=nmt4&amp;u=https://twitter.com/goinggodotnet&amp;xid=17259,15700023,15700124,15700149,15700168,15700173,15700186,15700201&amp;usg=ALkJrhi57B943koWpS6pe4_aRslBMy-7mw" target="_blank" rel="noopener">å¨å»‰è‚¯å°¼è¿ª</a> ã€‚</p><hr><p>via: <a href="https://medium.com/@matryer/line-of-sight-in-code-186dd7cdea88" target="_blank" rel="noopener">https://medium.com/@matryer/line-of-sight-in-code-186dd7cdea88</a></p><p>ä½œè€…ï¼š<a href="https://medium.com/@matryer" target="_blank" rel="noopener">Mat Ryer</a>  è¯‘è€…ï¼š<a href="https://github.com/yuhanle" target="_blank" rel="noopener">yuhanle</a>  æ ¡å¯¹ï¼š<a href="https://github.com/polaris1119" target="_blank" rel="noopener">polaris1119</a></p><p>æœ¬æ–‡ç”± <a href="https://github.com/studygolang/GCTT" target="_blank" rel="noopener">GCTT</a> åŸåˆ›ç¼–è¯‘ï¼Œ<a href="https://studygolang.com/articles/12928" target="_blank" rel="noopener">Goè¯­è¨€ä¸­æ–‡ç½‘</a> è£èª‰æ¨å‡º</p><p>æœ¬æ–‡ç”± GCTT åŸåˆ›ç¿»è¯‘ï¼Œ<a href="https://studygolang.com/articles/12928" target="_blank" rel="noopener">Goè¯­è¨€ä¸­æ–‡ç½‘</a> é¦–å‘ã€‚ä¹Ÿæƒ³åŠ å…¥è¯‘è€…è¡Œåˆ—ï¼Œä¸ºå¼€æºåšä¸€äº›è‡ªå·±çš„è´¡çŒ®ä¹ˆï¼Ÿæ¬¢è¿åŠ å…¥ <a href="https://studygolang.com/gctt" target="_blank" rel="noopener">GCTT</a>ï¼<br>ç¿»è¯‘å·¥ä½œå’Œè¯‘æ–‡å‘è¡¨ä»…ç”¨äºå­¦ä¹ å’Œäº¤æµç›®çš„ï¼Œç¿»è¯‘å·¥ä½œéµç…§ <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" target="_blank" rel="noopener">CC-BY-NC-SA åè®®è§„å®š</a>ï¼Œå¦‚æœæˆ‘ä»¬çš„å·¥ä½œæœ‰ä¾µçŠ¯åˆ°æ‚¨çš„æƒç›Šï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬ã€‚<br>æ¬¢è¿éµç…§ <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" target="_blank" rel="noopener">CC-BY-NC-SA åè®®è§„å®š</a> è½¬è½½ï¼Œæ•¬è¯·åœ¨æ­£æ–‡ä¸­æ ‡æ³¨å¹¶ä¿ç•™åŸæ–‡/è¯‘æ–‡é“¾æ¥å’Œä½œè€…/è¯‘è€…ç­‰ä¿¡æ¯ã€‚<br>æ–‡ç« ä»…ä»£è¡¨ä½œè€…çš„çŸ¥è¯†å’Œçœ‹æ³•ï¼Œå¦‚æœ‰ä¸åŒè§‚ç‚¹ï¼Œè¯·æ¥¼ä¸‹æ’é˜Ÿåæ§½</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/studygolang/gctt-images/master/line-of-sight/1_CBjBs9EzL8q1AL6XvjjpJg.png&quot; alt=&quot;æˆ‘åœ¨2016å¹´ä¼¦æ•¦Golangè‹±å›½ä¼šè®®ä¸Šè°ˆè®ºä»£ç ç¼©è¿›çº¿&quot;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿‘æœŸä¼¦æ•¦ä¸¾è¡Œçš„ &lt;a href=&quot;https://www.youtube.com/watch?v=yeetIgNeIkc&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Golang è‹±å›½ä¼šè®®&lt;/a&gt; ä¸Šï¼Œæˆ‘åœ¨&lt;a href=&quot;https://www.youtube.com/watch?v=yeetIgNeIkc&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åœ°é“çš„Go è¯­è¨€çªé—¨&lt;/a&gt; äº¤æµï¼ˆ&lt;a href=&quot;http://go-talks.appspot.com/github.com/matryer/present/idiomatic-go-tricks/main.slide#1&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å¹»ç¯ç‰‡&lt;/a&gt;ï¼‰ä¸­è®²åˆ°å…³äºä»£ç ä¸­çš„ç¼©è¿›çº¿ï¼Œ æˆ‘æƒ³åœ¨è¿™é‡Œç¨å¾®è§£é‡Šä¸€ä¸‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Translate" scheme="https://blog.yuhanle.com/categories/Translate/"/>
    
      <category term="Go" scheme="https://blog.yuhanle.com/categories/Translate/Go/"/>
    
    
      <category term="Translate" scheme="https://blog.yuhanle.com/tags/Translate/"/>
    
      <category term="Go" scheme="https://blog.yuhanle.com/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>Go å®ç°å¯¹ HTTP å¯¹è±¡çš„æŸ¥æ‰¾</title>
    <link href="https://blog.yuhanle.com/2018/02/24/seeking-around-in-an-http-object/"/>
    <id>https://blog.yuhanle.com/2018/02/24/seeking-around-in-an-http-object/</id>
    <published>2018-02-24T01:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.340Z</updated>
    
    <content type="html"><![CDATA[<p>å·²å‘å¸ƒï¼š<a href="https://studygolang.com/articles/12638" target="_blank" rel="noopener">https://studygolang.com/articles/12638</a></p><h1 id="Go-å®ç°å¯¹-HTTP-å¯¹è±¡çš„æŸ¥æ‰¾"><a href="#Go-å®ç°å¯¹-HTTP-å¯¹è±¡çš„æŸ¥æ‰¾" class="headerlink" title="Go å®ç°å¯¹ HTTP å¯¹è±¡çš„æŸ¥æ‰¾"></a>Go å®ç°å¯¹ HTTP å¯¹è±¡çš„æŸ¥æ‰¾</h1><p>æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ <code>HTTP</code> æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ªå·¨å¤§çš„ <code>ZIP</code> æ–‡ä»¶ï¼Œä½ æƒ³çŸ¥é“é‡Œé¢çš„å†…å®¹ã€‚ä½ ä¸çŸ¥é“å‹ç¼©åŒ…å†…æ˜¯å¦æœ‰ä½ éœ€è¦çš„ä¸œè¥¿ï¼Œè€Œä¸”ä½ ä¸æƒ³ä¸‹è½½æ•´ä¸ªæ–‡ä»¶ã€‚æ˜¯å¦å¯ä»¥åƒæ‰§è¡Œ  <code>unzip -l https://example.com/giant.zip</code> çš„æ“ä½œæ¥æŸ¥çœ‹å‹ç¼©åŒ…çš„å†…å®¹å‘¢ï¼Ÿ</p><p>è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªä¸ºäº†ç”¨ <code>Go</code> å±•ç¤ºæŸäº›çŸ¥è¯†çš„ç†è®ºé—®é¢˜ã€‚å®é™…ä¸Šï¼Œæˆ‘ä¹Ÿä¸æƒ³å†™ä¸€ç¯‡æ–‡ç« ï¼Œé™¤äº†æˆ‘æƒ³é€šè¿‡é‚£äº›å‹ç¼©æ–‡ä»¶äº†è§£å¦‚ä½•ä» <a href="https://bulkdata.uspto.gov/data/patent/officialgazette/2017/" target="_blank" rel="noopener">ç¾å›½ä¸“åˆ©å’Œå•†æ ‡å±€ï¼ˆUSPTOï¼‰</a> ä¸‹è½½å¤§é‡ä¸“åˆ©ã€‚æˆ–è€…ï¼Œæˆ‘è®¤ä¸ºï¼Œèƒ½å¤Ÿä»è¿™äº› <code>tar</code> æ–‡ä»¶ä¸­è·å– <a href="https://bulkdata.uspto.gov/data/patent/grant/multipagepdf/1790_1999/" target="_blank" rel="noopener">1790 å¹´å‘å¸ƒçš„ä¸€äº›ä¸“åˆ©å›¾åƒ</a> æœ‰å¤šé…·ï¼Ÿ</p><p>å»çœ‹çœ‹ã€‚é‚£é‡Œæœ‰æ•°ç™¾ä¸ªå·¨å¤§çš„ <code>ZIP</code> å’Œ <code>tarfiles</code> å€¼å¾—æ¢ç´¢ï¼</p><a id="more"></a><p>åœ¨ <code>ZIP</code> æ–‡ä»¶ä¸­æœ€åçš„ä½ç½®ï¼Œæœ‰ä¸€ä¸ªç›®å½•ã€‚å› æ­¤åœ¨æœ¬åœ°ç£ç›˜ä¸Šï¼Œ<code>â€œunzip -lâ€</code> å°±åƒâ€œå¯»æ±‚æœ€ç»ˆç»“æœï¼Œæ‰¾åˆ° <code>TOC</code>ï¼Œè§£æå¹¶æ‰“å°å®ƒâ€ä¸€æ ·ç®€å•ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ <code>Go</code> æ˜¯å¦‚ä½•å¤„ç†çš„ï¼Œå› ä¸ºåœ¨ <a href="https://godoc.org/archive/zip#NewReader" target="_blank" rel="noopener"><code>zip.NewReader</code> å‡½æ•°</a> éœ€è¦ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ã€‚è‡³äº <code>TAR</code> æ–‡ä»¶ï¼Œå®ƒä»¬è¢«è®¾è®¡ç”¨äºç£å¸¦æµå¼ä¼ è¾“å’Œå†…å­˜ç¨€å°‘çš„æ—¶å€™ï¼Œå› æ­¤å®ƒä»¬çš„ç›®å½•åœ¨æ–‡ä»¶æœ¬èº«ä¹‹é—´äº¤é”™æ’åˆ—ã€‚</p><p>ä½†æˆ‘ä»¬ä¸åœ¨æœ¬åœ°ï¼Œè¦ä» <code>URL</code> ä¸­è¯»å–å†…å®¹å¯¹æˆ‘ä»¬æ¥è¯´å¾ˆæœ‰æŒ‘æˆ˜ã€‚è¯¥æ€ä¹ˆåŠï¼Ÿä»å“ªé‡Œå¼€å§‹ï¼Ÿ</p><p>æˆ‘ä»¬æœ‰å‡ ä»¶äº‹éœ€è¦è€ƒè™‘ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥è§„åˆ’æ¥ä¸‹æ¥çš„æ–¹å‘ã€‚å¯»æ‰¾å’Œè¯»å– <code>HTTP</code> æ–‡ä»¶ä¹Ÿå°±æ˜¯è¦æ‰¾åˆ°å’Œè¯»å– <code>Range</code> æ ‡å¤´ã€‚é‚£ä¹ˆï¼Œ<code>USPTO</code> æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ <code>Range</code> å¤´å‘¢ï¼Ÿè¿™å¾ˆå®¹æ˜“æ£€æŸ¥ï¼Œä½¿ç”¨ <code>curl</code> å’Œ <code>HTTP HEAD</code> è¯·æ±‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -I https://bulkdata.uspto.gov/data/patent/officialgazette/2017/e-OG20170103_1434-1.zip</span></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Mon, 11 Dec 2017 21:10:26 GMT</span><br><span class="line">Server: Apache</span><br><span class="line">Last-Modified: Tue, 03 Jan 2017 11:58:45 GMT</span><br><span class="line">ETag: "afb8ac8-5452f63e0a82f"</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 184257224</span><br><span class="line">X-Frame-Options: DENY</span><br><span class="line">Content-Type: application/zip</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„é‚£é‡Œçš„ <code>â€œAccept-Rangesâ€</code> æ ‡å¤´ï¼Œå®ƒè¡¨ç¤ºæˆ‘ä»¬å¯ä»¥å‘å®ƒå‘é€å­—èŠ‚èŒƒå›´ã€‚<code>Range</code> å¤´å…è®¸æ‚¨åƒéšæœºè®¿é—®è¯»å–æ“ä½œç³»ç»Ÿçš„ä¸€æ ·æ“ä½œ <code>HTTP</code>ã€‚ï¼ˆä¾‹å¦‚ <a href="https://godoc.org/io#ReaderAt" target="_blank" rel="noopener">io.ReaderAt</a> æ¥å£ï¼‰</p><p>å› æ­¤ç†è®ºä¸Šå¯ä»¥é€‰æ‹©ä» <code>Web</code> æœåŠ¡å™¨ä¸‹è½½å…¶ä¸­åŒ…å«å…ƒæ•°æ®ï¼ˆç›®å½•ï¼‰çš„æ–‡ä»¶éƒ¨åˆ†æ¥å†³å®šä¸‹è½½å“ªäº›å­—èŠ‚ã€‚</p><p>ç°åœ¨æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªå¤„ç† <code>ZIP</code> æ–‡ä»¶æ ¼å¼çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨å…·æœ‰ <code>Range</code> å¤´éƒ¨çš„ <code>HTTP</code> çš„ <code>GET</code> è¯·æ±‚ï¼Œåªè¯»å–å…ƒæ•°æ®çš„æ–¹å¼ï¼Œå®ç°æ›¿æ¢â€œè¯»å–ä¸‹ä¸€ä¸ªç›®å½•å¤´æ–‡ä»¶â€çš„æŸä¸ªéƒ¨åˆ†ã€‚è¿™å°±æ˜¯ <code>Go</code> çš„ <a href="https://golang.org/pkg/archive/zip" target="_blank" rel="noopener"><code>archive/zip</code></a> å’Œ <a href="https://godoc.org/archive/tar" target="_blank" rel="noopener"><code>archive/tar</code></a> åŒ…çš„å®ç°ï¼</p><p>æ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€è¯´ï¼Œ<a href="https://godoc.org/archive/zip#NewReader" target="_blank" rel="noopener">zip.NewReader</a> æ­£åœ¨ç¢ç£¨ä»€ä¹ˆä½ç½®å¼€å§‹æŸ¥æ‰¾ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬çœ‹çœ‹ <code>TAR</code> æ—¶ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªé—®é¢˜ã€‚<code>tar.NewReader</code> æ–¹æ³•éœ€è¦ä¸€ä¸ª <code>io.Reader</code>ã€‚<code>io.Reader</code> çš„é—®é¢˜åœ¨äºï¼Œå®ƒä¸ä¼šè®©æˆ‘ä»¬éšæœºè®¿é—®èµ„æºï¼Œå°±åƒ<code>io.ReaderAt</code> ä¸€æ ·ã€‚å®ƒæ˜¯è¿™æ ·å®ç°çš„ï¼Œå› ä¸ºå®ƒä½¿ <code>tar</code> åŒ…æ›´å…·é€‚åº”æ€§ã€‚ç‰¹åˆ«æ˜¯ï¼Œæ‚¨å¯ä»¥å°† <code>Go tar</code> åŒ…ç›´æ¥æŒ‚æ¥åˆ° <code>compress/gzip</code> åŒ…å¹¶è¯»å– <code>tar.gz</code> æ–‡ä»¶ - åªè¦æ‚¨æŒ‰é¡ºåºè¯»å–å®ƒä»¬ï¼Œè€Œä¸æ˜¯åƒæˆ‘ä»¬å¸Œæœ›çš„é‚£æ ·è·³è¿‡ã€‚</p><p>é‚£ä¹ˆè¯¥æ€ä¹ˆåŠï¼Ÿä½¿ç”¨æºç ã€‚ç¯é¡¾å››å‘¨ï¼Œæ‰¾æ‰¾<a href="https://github.com/golang/go/blob/c007ce824d9a4fccb148f9204e04c23ed2984b71/src/archive/tar/reader.go#L88" target="_blank" rel="noopener">ä¸‹ä¸€ä¸ªæ–¹æ³•</a>ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æœŸæœ›å®ƒèƒ½å¤Ÿæ‰¾åˆ°ä¸‹ä¸€ä¸ªå…ƒæ•°æ®çš„åœ°æ–¹ã€‚åœ¨å‡ è¡Œä»£ç å†…ï¼Œå¯¹äº <a href="https://github.com/golang/go/blob/c007ce824d9a4fccb148f9204e04c23ed2984b71/src/archive/tar/reader.go#L407" target="_blank" rel="noopener"><code>skipUnread</code></a> å‡½æ•°ï¼Œ æˆ‘ä»¬å‘ç°ä¸€ä¸ªæœ‰è¶£çš„è°ƒç”¨ã€‚åœ¨é‚£é‡Œï¼Œæˆ‘ä»¬å‘ç°ä¸€äº›éå¸¸æœ‰è¶£çš„ä¸œè¥¿ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// skipUnread skips any unread bytes in the existing file entry, as well as any alignment padding.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tr *Reader)</span> <span class="title">skipUnread</span><span class="params">()</span></span> &#123;</span><br><span class="line">  nr := tr.numBytes() + tr.pad <span class="comment">// number of bytes to skip</span></span><br><span class="line">  tr.curr, tr.pad = <span class="literal">nil</span>, <span class="number">0</span></span><br><span class="line">  <span class="keyword">if</span> sr, ok := tr.r.(io.Seeker); ok &#123;</span><br><span class="line">    <span class="keyword">if</span> _, err := sr.Seek(nr, os.SEEK_CUR); err == <span class="literal">nil</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  _, tr.err = io.CopyN(ioutil.Discard, tr.r, nr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Note: This is from Go 1.4, which had a simpler skipUnread than go 1.9 does.</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¡¨ç¤ºï¼šâ€å¦‚æœ <code>io.Reader</code> å®é™…ä¸Šä¹Ÿèƒ½å¤Ÿæœç´¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸æ˜¯ç›´æ¥è¯»å–å’Œä¸¢å¼ƒï¼Œè€Œæ˜¯ç›´æ¥æ‰¾åˆ°æ­£ç¡®çš„åœ°æ–¹ã€‚â€œæ‰¾åˆ°äº†ï¼æˆ‘ä»¬åªéœ€è¦å°† <code>tar</code> æ–‡ä»¶ä¼ ç»™ <code>io.Reader</code>ã€‚<code>NewReader</code> ä¹Ÿæ»¡è¶³ <a href="https://golang.org/pkg/io/#Seeker" target="_blank" rel="noopener"><code>io.Seeker</code></a>çš„åŠŸèƒ½ï¼ˆå› æ­¤ï¼Œå®ƒæ˜¯ä¸€ä¸ª<a href="https://golang.org/pkg/io/#ReadSeeker" target="_blank" rel="noopener"><code>io.ReadSeeker</code></a>ï¼‰ã€‚</p><p>æ‰€ä»¥ï¼Œç°åœ¨è¯·æŸ¥çœ‹åŒ… <a href="https://godoc.org/github.com/jeffallen/seekinghttp" target="_blank" rel="noopener"><code>github.com/jeffallen/seekinghttp</code></a>ï¼Œå°±åƒå®ƒçš„åå­—æ‰€æš—ç¤ºçš„é‚£æ ·ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨äºåœ¨ <code>HTTP</code> å¯¹è±¡ï¼ˆ<a href="https://github.com/jeffallen/seekinghttp" target="_blank" rel="noopener"><code>Github</code> ä¸Šçš„æºä»£ç </a> ä¸­æŸ¥æ‰¾çš„è½¯ä»¶åŒ…ã€‚</p><p>è¿™ä¸ªè½¯ä»¶åŒ…ä¸ä»…<a href="https://github.com/jeffallen/seekinghttp/blob/master/seekinghttp.go#L26" target="_blank" rel="noopener">å®ç°</a>äº† <code>io.ReadSeeker</code>ï¼Œè¿˜å®ç°äº† <code>io.ReaderAt</code>ã€‚</p><p>ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºï¼Œæ­£å¦‚æˆ‘ä¸Šé¢æåˆ°çš„ï¼Œè¯»å– <code>ZIP</code> æ–‡ä»¶éœ€è¦ä¸€ä¸ª <code>io.ReaderAt</code>ã€‚å®ƒè¿˜éœ€è¦ä¼ é€’ç»™å®ƒçš„æ–‡ä»¶çš„é•¿åº¦ï¼Œä»¥ä¾¿å®ƒå¯ä»¥æŸ¥çœ‹ç›®å½•æ–‡ä»¶çš„æœ«å°¾ã€‚<code>HTTP HEAD</code> æ–¹æ³•å¯ä»¥å¾ˆå¥½åœ°è·å– <code>HTTP</code> å¯¹è±¡çš„ <code>Content-Length</code>ï¼Œè€Œä¸éœ€è¦ä¸‹è½½æ•´ä¸ªæ–‡ä»¶ã€‚</p><p>ç”¨äºè¿œç¨‹è·å– <code>tar</code> å’Œ <code>zip</code> æ–‡ä»¶ç›®å½•çš„å‘½ä»¤è¡Œå·¥å…·ä½äº <code>remote-archive-ls</code> ä¸­ã€‚æ‰“å¼€ <code>â€œ-debugâ€</code> é€‰é¡¹ç”¨æ¥æŸ¥çœ‹æ—¥å¿—ã€‚<strong>å°† <code>Go</code> çš„æ ‡å‡†åº“ä½œä¸º <code>TAR</code> æˆ– <code>ZIP</code> é˜…è¯»å™¨â€œå›è°ƒâ€åˆ°æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œå¹¶åœ¨è¿™é‡Œè¯·æ±‚å‡ ä¸ªå­—èŠ‚ï¼Œè¿™é‡Œæœ‰å‡ ä¸ªå­—èŠ‚æ˜¯å¾ˆæœ‰è¶£çš„ã€‚</strong> </p><p>åœ¨æˆ‘ç¬¬ä¸€æ¬¡è¿è¡Œè¿™ä¸ªç¨‹åºåä¸ä¹…ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªä¸¥é‡çš„ç¼ºé™·ã€‚è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹è¿è¡Œç»“æœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ./remote-archive-ls -debug <span class="string">'https://bulkdata.uspto.gov/data/patent/grant/multipagepdf/1790_1999/grant_pdf_17900731_18641101.tar'</span></span></span><br><span class="line">2017/12/12 00:07:38 got read len 512</span><br><span class="line">2017/12/12 00:07:38 ReadAt len 512 off 0</span><br><span class="line">2017/12/12 00:07:38 Start HTTP GET with Range: bytes=0-511</span><br><span class="line">2017/12/12 00:07:39 HTTP ok.</span><br><span class="line">File: 00000001-X009741H/</span><br><span class="line">2017/12/12 00:07:39 got read len 512</span><br><span class="line">2017/12/12 00:07:39 ReadAt len 512 off 512</span><br><span class="line">2017/12/12 00:07:39 Start HTTP GET with Range: bytes=512-1023</span><br><span class="line">2017/12/12 00:07:39 HTTP ok.</span><br><span class="line">File: 00000001-X009741H/00/</span><br><span class="line">2017/12/12 00:07:39 got read len 512</span><br><span class="line">2017/12/12 00:07:39 ReadAt len 512 off 1024</span><br><span class="line">2017/12/12 00:07:39 Start HTTP GET with Range: bytes=1024-1535</span><br><span class="line">2017/12/12 00:07:39 HTTP ok.</span><br><span class="line">File: 00000001-X009741H/00/000/</span><br><span class="line">2017/12/12 00:07:39 got read len 512</span><br><span class="line">2017/12/12 00:07:39 ReadAt len 512 off 1536</span><br><span class="line">2017/12/12 00:07:39 Start HTTP GET with Range: bytes=1536-2047</span><br><span class="line">2017/12/12 00:07:39 HTTP ok.</span><br><span class="line">File: 00000001-X009741H/00/000/001/</span><br><span class="line">2017/12/12 00:07:39 got read len 512</span><br><span class="line">2017/12/12 00:07:39 ReadAt len 512 off 2048</span><br><span class="line">2017/12/12 00:07:39 Start HTTP GET with Range: bytes=2048-2559</span><br><span class="line">2017/12/12 00:07:39 HTTP ok.</span><br><span class="line">File: 00000001-X009741H/00/000/001/us-patent-image.xml</span><br><span class="line">2017/12/12 00:07:39 got seek 0 1</span><br><span class="line">2017/12/12 00:07:39 got seek 982 1</span><br><span class="line">2017/12/12 00:07:39 got read len 42</span><br><span class="line">2017/12/12 00:07:39 ReadAt len 42 off 3542</span><br><span class="line">2017/12/12 00:07:39 Start HTTP GET with Range: bytes=3542-3583</span><br><span class="line">2017/12/12 00:07:39 HTTP ok.</span><br><span class="line">2017/12/12 00:07:39 got read len 512</span><br><span class="line">2017/12/12 00:07:39 ReadAt len 512 off 3584</span><br><span class="line">2017/12/12 00:07:39 Start HTTP GET with Range: bytes=3584-4095</span><br><span class="line">2017/12/12 00:07:39 HTTP ok.</span><br><span class="line">File: 00000001-X009741H/00/000/001/00000001.pdf</span><br><span class="line">2017/12/12 00:07:39 got seek 0 1</span><br><span class="line">2017/12/12 00:07:39 got seek 320840 1</span><br><span class="line">2017/12/12 00:07:39 got read len 184</span><br><span class="line">2017/12/12 00:07:39 ReadAt len 184 off 324936</span><br><span class="line">...etc...</span><br></pre></td></tr></table></figure><p>ä½ èƒ½çœ‹åˆ°é—®é¢˜å—ï¼Ÿè¿™æ˜¯å¾ˆå¤š <code>HTTP</code> äº‹åŠ¡ï¼ <code>TAR reader</code> æ­£åœ¨ä¸€æ¬¡ä¸€ç‚¹ç‚¹åœ°å®Œæˆ <code>TAR</code> æµï¼Œå‘å‡ºä¸€å°ä¸² <code>bit</code>ã€‚æ‰€æœ‰è¿™äº›çŸ­çš„ <code>HTTP</code> äº‹åŠ¡åœ¨æœåŠ¡å™¨ä¸Šéƒ½å¾ˆéš¾å®ç°ï¼Œå¹¶ä¸”å¯¹äºååé‡æ¥è¯´å¾ˆç³Ÿç³•ï¼Œå› ä¸ºæ¯ä¸ª <code>HTTP</code> äº‹åŠ¡éƒ½éœ€è¦å¤šæ¬¡å¾€è¿”æœåŠ¡å™¨ã€‚</p><p>å½“ç„¶ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ç¼“å­˜ã€‚<strong>è¯»å–TARè¯»å–å™¨è¦æ±‚çš„å‰ 512 ä¸ªå­—èŠ‚ï¼Œè€Œä¸æ˜¯è¯»å–å…¶ä¸­çš„ 10 å€ï¼Œä»¥ä¾¿æ¥ä¸‹æ¥çš„å‡ ä¸ªè¯»å–å°†ç›´æ¥ä»ç¼“å­˜ä¸­è·å–ã€‚</strong>å¦‚æœè¯»å–è¶…å‡ºäº†ç¼“å­˜çš„èŒƒå›´ï¼Œæˆ‘ä»¬å‡è®¾å…¶ä»–è¯»å–ä¹Ÿå°†è¿›å…¥è¯¥åŒºåŸŸï¼Œå¹¶åˆ é™¤æ•´ä¸ªå½“å‰ç¼“å­˜ï¼Œä»¥ä¾¿ç”¨å½“å‰åç§»é‡çš„ 10 å€å¡«å……å®ƒã€‚</p><p><code>TAR</code> é˜…è¯»å™¨å‘é€<strong>å¤§é‡å°è¯»æ•°</strong>çš„äº‹å®æŒ‡å‡ºäº†æœ‰å…³ç¼“å†²çš„ä¸€äº›éå¸¸é‡è¦çš„äº‹æƒ…ã€‚å°† <a href="https://godoc.org/os#Open" target="_blank" rel="noopener"><code>os.Open</code></a> çš„ç»“æœç›´æ¥å‘é€ç»™ <code>tar</code>ã€‚<code>NewReader</code> ä¸æ˜¯å¾ˆèªæ˜ï¼Œå°¤å…¶æ˜¯å¦‚æœä½ æ‰“ç®—è·³è¿‡æ–‡ä»¶å¯»æ‰¾å…ƒæ•°æ®ã€‚å°½ç®¡ <code>* os.File</code> å®ç°äº† <code>io.ReadSeeker</code>ï¼Œæˆ‘ä»¬ç°åœ¨çŸ¥é“ <code>TAR</code> å°†ä¼šå‘å†…æ ¸å‘å‡ºå¤§é‡çš„<strong>å°ç³»ç»Ÿè°ƒç”¨</strong>ã€‚è¯¥è§£å†³æ–¹æ¡ˆä¸ä¸Šé¢çš„è§£å†³æ–¹æ¡ˆéå¸¸ç›¸ä¼¼ï¼Œå¯èƒ½æ˜¯ä½¿ç”¨ <a href="https://godoc.org/bufio" target="_blank" rel="noopener"><code>bufio</code></a> åŒ…æ¥ç¼“å†² <code>* os.File</code>ï¼Œä»¥ä¾¿ <code>TAR</code> å‘å‡ºçš„å°æ•°æ®å°†ä» <code>RAM</code> ä¸­å–å‡ºï¼Œè€Œä¸æ˜¯è½¬åˆ°æ“ä½œç³»ç»Ÿã€‚ä½†è¯·æ³¨æ„ï¼šå®ƒçœŸçš„æ˜¯è§£å†³æ–¹æ¡ˆå—ï¼Ÿ<code>bufio.Reader</code> æ˜¯å¦çœŸçš„å®ç°äº† <code>io</code>ï¼Ÿ<code>ReadSeeker</code> å’Œ <code>io.ReadAt</code> å°±åƒæˆ‘ä»¬éœ€è¦çš„ä¸€æ ·ï¼Ÿ <strong>ï¼ˆç ´åè€…ï¼šå®ƒæ²¡æœ‰;ä¹Ÿè®¸ä½ ä»¬æœ‰è¯»è€…æƒ³å‘Šè¯‰æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ä¸‹ä¸€ä¸ªçš„æ›¿ä»£å“ <code>bufio</code> åŠ é€Ÿ <code>Go</code> çš„ <code>tar</code>ï¼Ÿ</strong></p><p>æˆ‘å¸Œæœ›ä½ å–œæ¬¢é€šè¿‡æ ‡å‡†åº“å’Œ <code>HTTP</code>ï¼Œçœ‹çœ‹å¦‚ä½•ä¸æ ‡å‡†åº“ä¸€èµ·å·¥ä½œï¼Œä»¥å¸®åŠ©å®ƒå®ç°æ›´å¤šçš„åŠŸèƒ½ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å¸®åŠ©ä½ å®Œæˆä½ çš„å·¥ä½œè¿™ä¸ªå°å°çš„æ—…ç¨‹ã€‚å½“ä½ å®ç° <code>io.Reader</code> å’Œæœ‹å‹æ—¶ï¼Œä½ æœ‰æœºä¼šèµ°åˆ°ä½ æ‰€è°ƒç”¨çš„åº“çš„å¹•åï¼Œå¹¶ä»ä»–ä»¬çš„ä½œè€…ä»æœªæœŸæœ›çš„åœ°æ–¹ç»™ä»–ä»¬æä¾›æ•°æ®ï¼</p><hr><p>viaï¼š<a href="https://blog.gopheracademy.com/advent-2017/seekable-http/" target="_blank" rel="noopener">https://blog.gopheracademy.com/advent-2017/seekable-http/</a></p><p>ä½œè€…ï¼š<a href="https://github.com/jeffallen" target="_blank" rel="noopener">Jeff R. Allen</a><br>è¯‘è€…ï¼š<a href="https://github.com/yuhanle" target="_blank" rel="noopener">yuhanle</a><br>æ ¡å¯¹ï¼š<a href="https://github.com/Unknwon" target="_blank" rel="noopener">Unknwon</a></p><p>æœ¬æ–‡ç”± <a href="https://github.com/studygolang/GCTT" target="_blank" rel="noopener">GCTT</a> åŸåˆ›ç¼–è¯‘ï¼Œ<a href="https://studygolang.com/" target="_blank" rel="noopener">Goä¸­æ–‡ç½‘</a> è£èª‰æ¨å‡º</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å·²å‘å¸ƒï¼š&lt;a href=&quot;https://studygolang.com/articles/12638&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://studygolang.com/articles/12638&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;Go-å®ç°å¯¹-HTTP-å¯¹è±¡çš„æŸ¥æ‰¾&quot;&gt;&lt;a href=&quot;#Go-å®ç°å¯¹-HTTP-å¯¹è±¡çš„æŸ¥æ‰¾&quot; class=&quot;headerlink&quot; title=&quot;Go å®ç°å¯¹ HTTP å¯¹è±¡çš„æŸ¥æ‰¾&quot;&gt;&lt;/a&gt;Go å®ç°å¯¹ HTTP å¯¹è±¡çš„æŸ¥æ‰¾&lt;/h1&gt;&lt;p&gt;æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ &lt;code&gt;HTTP&lt;/code&gt; æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ªå·¨å¤§çš„ &lt;code&gt;ZIP&lt;/code&gt; æ–‡ä»¶ï¼Œä½ æƒ³çŸ¥é“é‡Œé¢çš„å†…å®¹ã€‚ä½ ä¸çŸ¥é“å‹ç¼©åŒ…å†…æ˜¯å¦æœ‰ä½ éœ€è¦çš„ä¸œè¥¿ï¼Œè€Œä¸”ä½ ä¸æƒ³ä¸‹è½½æ•´ä¸ªæ–‡ä»¶ã€‚æ˜¯å¦å¯ä»¥åƒæ‰§è¡Œ  &lt;code&gt;unzip -l https://example.com/giant.zip&lt;/code&gt; çš„æ“ä½œæ¥æŸ¥çœ‹å‹ç¼©åŒ…çš„å†…å®¹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªä¸ºäº†ç”¨ &lt;code&gt;Go&lt;/code&gt; å±•ç¤ºæŸäº›çŸ¥è¯†çš„ç†è®ºé—®é¢˜ã€‚å®é™…ä¸Šï¼Œæˆ‘ä¹Ÿä¸æƒ³å†™ä¸€ç¯‡æ–‡ç« ï¼Œé™¤äº†æˆ‘æƒ³é€šè¿‡é‚£äº›å‹ç¼©æ–‡ä»¶äº†è§£å¦‚ä½•ä» &lt;a href=&quot;https://bulkdata.uspto.gov/data/patent/officialgazette/2017/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ç¾å›½ä¸“åˆ©å’Œå•†æ ‡å±€ï¼ˆUSPTOï¼‰&lt;/a&gt; ä¸‹è½½å¤§é‡ä¸“åˆ©ã€‚æˆ–è€…ï¼Œæˆ‘è®¤ä¸ºï¼Œèƒ½å¤Ÿä»è¿™äº› &lt;code&gt;tar&lt;/code&gt; æ–‡ä»¶ä¸­è·å– &lt;a href=&quot;https://bulkdata.uspto.gov/data/patent/grant/multipagepdf/1790_1999/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;1790 å¹´å‘å¸ƒçš„ä¸€äº›ä¸“åˆ©å›¾åƒ&lt;/a&gt; æœ‰å¤šé…·ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å»çœ‹çœ‹ã€‚é‚£é‡Œæœ‰æ•°ç™¾ä¸ªå·¨å¤§çš„ &lt;code&gt;ZIP&lt;/code&gt; å’Œ &lt;code&gt;tarfiles&lt;/code&gt; å€¼å¾—æ¢ç´¢ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="Translate" scheme="https://blog.yuhanle.com/categories/Translate/"/>
    
      <category term="Go" scheme="https://blog.yuhanle.com/categories/Translate/Go/"/>
    
    
      <category term="Translate" scheme="https://blog.yuhanle.com/tags/Translate/"/>
    
      <category term="Go" scheme="https://blog.yuhanle.com/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>iOS çœŸæœºè°ƒè¯•å¦‚ä½•å®‰è£… WebDriverAgent</title>
    <link href="https://blog.yuhanle.com/2018/01/03/how-to-install-web-driver-agent-on-device/"/>
    <id>https://blog.yuhanle.com/2018/01/03/how-to-install-web-driver-agent-on-device/</id>
    <published>2018-01-03T10:30:47.000Z</published>
    <updated>2021-10-21T08:18:48.337Z</updated>
    
    <content type="html"><![CDATA[<p>è¿‘æœŸï¼Œå¾®ä¿¡<a href="https://github.com/wangshub/wechat_jump_game" target="_blank" rel="noopener">è·³ä¸€è·³å¤–æŒ‚</a>ç«äº†ï¼Œçœ‹äº†ä½œè€…çš„æ€è·¯å’Œæ•™ç¨‹ï¼Œæ„Ÿè§‰æŒºç®€å•ï¼Œä¸è¿‡åœ¨å®ç°ï¼ˆç…§è‘«èŠ¦ç”»ç“¢ï¼‰çš„è¿‡ç¨‹ä¸­ï¼Œé­é‡åˆ°ä¸å°‘é—®é¢˜ã€‚</p><p><img src="https://raw.githubusercontent.com/yuhanle/blogbag/master/uploads/images/wda.png" alt="WDA å·¥ä½œåŸç†"> </p><p>å…¶ä¸­ä¹‹ä¸€ä¾¿æ˜¯ï¼ŒçœŸæœºè°ƒè¯• WDAï¼Œå‚è€ƒ iOS çœŸæœºå¦‚ä½•å®‰è£… <a href="https://testerhome.com/topics/7220" target="_blank" rel="noopener">WebDriverAgent Â· TesterHome</a>ï¼Œä¸‹é¢å°±æŒ‰ç…§è¿™ç¯‡æ•™ç¨‹ï¼Œå„ä¸ªå‡»ç ´çœŸæœºè°ƒè¯•WDA çš„é—®é¢˜ï¼š</p><h1 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h1><p>é¦–å…ˆæŒ‰ç…§æ•™ç¨‹ï¼Œå°½é‡æ›´æ–°ä¸‹Xcode çš„ç‰ˆæœ¬ï¼Œä»github ä¸Šä¸‹è½½WDA çš„æœ€æ–°ç‰ˆæœ¬ï¼Œç›´æ¥å…‹éš†åˆ°æœ¬åœ°</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/facebook/WebDriverAgent.git</span><br></pre></td></tr></table></figure><p>åˆ‡æ¢åˆ°WDA æ ¹ç›®å½•ï¼Œè¿è¡Œåˆå§‹åŒ–è„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd WebDriverAgent</span><br><span class="line">./Scripts/bootstrap.sh</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šè„šæœ¬æ˜¯å®‰è£…ä¾èµ–åº“ï¼ŒåŒæ—¶ä½¿ç”¨npm æ‰“åŒ…å“åº”çš„js æ–‡ä»¶ã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥æµè§ˆè„šæœ¬æ–‡ä»¶ï¼ŒåŒçº§ç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ª<code>build.sh</code>ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‰§è¡Œè¯¥è„šæœ¬æ¥ç¼–è¯‘å®‰è£…WDAã€‚å½“ç„¶ï¼Œåˆæ¬¡æ¥è§¦ï¼Œå¸Œæœ›ä¸€æ­¥æ­¥æ“ä½œçš„è¯ä¼šå¥½ä¸€äº›ã€‚</p><p>å¦‚æœä¸­é€”å‡ºç°é”™è¯¯ï¼Œéœ€è¦å…ˆè§£å†³ï¼Œå¦åˆ™æ¥ä¸‹æ¥çš„æ“ä½œéƒ½æ— æ³•è¿›è¡Œã€‚</p><h1 id="ç¼–è¯‘è¿è¡Œ"><a href="#ç¼–è¯‘è¿è¡Œ" class="headerlink" title="ç¼–è¯‘è¿è¡Œ"></a>ç¼–è¯‘è¿è¡Œ</h1><p>æ¥ä¸‹æ¥ï¼Œé€šè¿‡Xcode æ‰“å¼€<code>WebDriverAgent.xcodeproj</code> è¿™ä¸ªæ–‡ä»¶ã€‚</p><p>å¯ä»¥å…ˆå°è¯•ç¼–è¯‘ä¸€ä¸‹ï¼Œæ–¹ä¾¿å®šä½ç›®å‰å­˜åœ¨çš„é—®é¢˜ï¼Œä½¿ç”¨ç»„åˆé”®æˆ–è€…é€šè¿‡é¼ æ ‡æ“ä½œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command + b</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™ï¼Œè‚¯å®šä¼šæœ‰æç¤ºé…ç½®è¯ä¹¦çš„é—®é¢˜ï¼ŒçœŸæœºè°ƒè¯•è¯ä¹¦æ˜¯å¿…é¡»è®¾ç½®çš„ã€‚å¯ä»¥è®¾ç½®ä¸ªäººå¼€å‘è€…å…è´¹è¯ä¹¦ï¼Œæˆ–è€…å…¶ä»–ä»˜è´¹è¯ä¹¦ã€‚</p><p><img src="https://raw.githubusercontent.com/yuhanle/blogbag/master/uploads/images/WX20180103-141257.png" alt></p><p>ç„¶åé€‰æ‹©<code>WebDriverAgentRunner</code> è¿™ä¸ªTarget å’Œ çœŸæœºè®¾å¤‡ï¼Œæ‰§è¡Œæµ‹è¯•ã€‚ç»„åˆé”®<code>command+u</code>ï¼Œæˆ–ä»èœå•æ Product ä¸­é€šè¿‡é¼ æ ‡æ“ä½œ</p><blockquote><p>ä¸€åˆ‡æ­£å¸¸çš„è¯ï¼Œæ‰‹æœºä¸Šä¼šå‡ºç°ä¸€ä¸ªæ— å›¾æ ‡çš„WebDriverAgentåº”ç”¨ï¼Œå¯åŠ¨ä¹‹åï¼Œé©¬ä¸Šåˆè¿”å›åˆ°æ¡Œé¢ã€‚è¿™æ˜¯å¾ˆæ­£å¸¸çš„ä¸è¦å¥‡æ€ªã€‚</p></blockquote><p>åº”ç”¨æ•™ç¨‹ä¸­çš„åŸè¯ï¼Œä¸Šè¿°ç°è±¡æ­£å¸¸ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¯èƒ½ä¼šåœ¨æ§åˆ¶å°æŠ¥é”™ï¼Œä»è€Œæ— æ³•æ‰“å°å‡ºip åœ°å€ã€‚</p><p>å½“æŠŠæ‰€æœ‰çš„æµç¨‹é‡æ–°æ‹ä¸€éï¼Œä½ ä¼šå‘ç°ï¼Œæ ¹æœ¬å‘ç°ä¸äº†å“ªä¸€æ­¥åšé”™äº†ï¼Œæˆ‘é‡åˆ°çš„æƒ…å†µå°±æ˜¯ï¼Œä¸€ç›´åœç•™åœ¨æ§åˆ¶å°çš„é‚£é‡Œï¼Œä¸ä¼šå‡ºç°å¥‡è¿¹ã€‚ç»è¿‡ä¸€ç•ªæœç´¢ï¼Œå‘ç°<a href="https://testerhome.com/topics/9666" target="_blank" rel="noopener">æœ‰ä¸ªå¸–å­</a>é‡Œçš„è­¦å‘Šæç¤ºï¼Œæˆ‘å†³å®šæ”¾æ‰‹ä¸€æï¼</p><blockquote><p>ä½ ä»¬ä»¥ä¸ºè¿™æ ·å°±èƒ½è¿è¡Œå—ï¼Ÿ</p><p>å¹¶ä¸æ˜¯ï¼<br>æœ€å…³é”®ä¸€æ­¥æ¥äº†ï¼š</p><p>ä½ è¦ç”¨æ•°æ®çº¿è¿ç€ç”µè„‘é‡å¯ä½ çš„æ‰‹æœºï¼ï¼ï¼ï¼</p><p>ä½ è¦ç”¨æ•°æ®çº¿è¿ç€ç”µè„‘é‡å¯ä½ çš„æ‰‹æœºï¼ï¼ï¼ï¼</p><p>ä½ è¦ç”¨æ•°æ®çº¿è¿ç€ç”µè„‘é‡å¯ä½ çš„æ‰‹æœºï¼ï¼ï¼ï¼</p><p>é‡è¦çš„è¯è¦è¯´ä¸‰éï¼</p></blockquote><p>åæ­£æ˜¯åœ¨ä¿è¯æ•°æ®çº¿è¿æ¥çš„æƒ…å†µä¸‹ï¼Œé‡å¯ä¸€ä¸‹æ‰‹æœºï¼Œç„¶åé‡æ–°build å°±æˆåŠŸçœ‹åˆ°ip åœ°å€ï¼è€Œä¸”åœ¨ä»¥åæ“ä½œä¸­ï¼Œè¿™ç§æƒ…å†µè¿˜ä¼šå¤ç°ï¼Œæ‰€ä»¥é‡å¯æ‰‹æœºå§ï¼Œä¸ç”¨æµªè´¹æ— è¾œçš„æ—¶é—´ç ”ç©¶~</p><p>é€šè¿‡ä¸Šé¢ç»™å‡ºçš„IPå’Œç«¯å£ï¼ŒåŠ ä¸Š<code>/status</code>åˆæˆä¸€ä¸ªurlåœ°å€ã€‚ä¾‹å¦‚<code>http://10.0.0.1:8100/status</code>ï¼Œç„¶åæµè§ˆå™¨æ‰“å¼€ã€‚å¦‚æœå‡ºç°ä¸€ä¸²JSONè¾“å‡ºï¼Œè¯´æ˜WDAå®‰è£…æˆåŠŸäº†ã€‚</p><h1 id="ç«¯å£è½¬å‘"><a href="#ç«¯å£è½¬å‘" class="headerlink" title="ç«¯å£è½¬å‘"></a>ç«¯å£è½¬å‘</h1><p>æœ‰äº›å›½äº§çš„iPhoneæœºå™¨é€šè¿‡æ‰‹æœºçš„IPå’Œç«¯å£è¿˜ä¸èƒ½è®¿é—®ï¼Œæ­¤æ—¶éœ€è¦å°†æ‰‹æœºçš„ç«¯å£è½¬å‘åˆ°Macä¸Šã€‚å…³äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æ˜¯é€šè¿‡ç«¯å£è½¬å‘æ‰çœ‹åˆ°æ•ˆæœï¼Œæ‰€ä»¥ä½ ä¹Ÿåº”è¯¥ä¼šé‡åˆ°åŒæ ·çš„é—®é¢˜ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ brew install imobiledevice</span><br><span class="line">$ iproxy 8100 8100 [4c47766e78f9d84e1da55b07d69f2747e9fb4f71]</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨iproxy â€“help å¯ä»¥æŸ¥åˆ°æ›´å…·ä½“çš„ç”¨æ³•ã€‚ è¿™æ—¶é€šè¿‡è®¿é—®<code>http://localhost:8100/status</code> ç¡®è®¤WDAæ˜¯å¦è¿è¡ŒæˆåŠŸã€‚</p><p>è€Œinspectorçš„åœ°å€æ˜¯<code>http://localhost:8100/inspector</code>ï¼Œ inspectoræ˜¯ç”¨æ¥æŸ¥çœ‹UIçš„å›¾å±‚ï¼Œæ–¹ä¾¿å†™æµ‹è¯•è„šæœ¬ç”¨ã€‚</p><blockquote><p>æ³¨ï¼šç«¯å£è½¬å‘åï¼ŒåŸŸåä¸å†æ˜¯IP åœ°å€ï¼Œè€Œæ˜¯ä½ çš„æœ¬æœºIPæˆ–è€…ä½¿ç”¨<code>localhost</code>+ ç«¯å£å·</p></blockquote><h1 id="æœ€ç»ˆæ•ˆæœ"><a href="#æœ€ç»ˆæ•ˆæœ" class="headerlink" title="æœ€ç»ˆæ•ˆæœ"></a>æœ€ç»ˆæ•ˆæœ</h1><p>å®Œæˆä¸Šè¿°æ“ä½œä»¥åï¼Œå¯ä»¥éšæ„å¼€å¯åº”ç”¨å†…çš„æŸä¸ªåº”ç”¨ï¼Œå°±èƒ½çœ‹åˆ°å¦‚ä¸‹æ•ˆæœã€‚</p><p><img src="https://raw.githubusercontent.com/yuhanle/blogbag/master/uploads/images/WX20180103-143535.png" alt></p><p>è¿™é‡Œç»“åˆ <a href="https://testerhome.com/topics/7840" target="_blank" rel="noopener">Appium Desktop</a> ä¸€èµ·é£Ÿç”¨ï¼Œæ•ˆæœæ›´ä½³~</p><p>Good luck!!!</p><h1 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h1><p>ç›¸ä¿¡ä½ ä¼šå¯¹è¿™ä¸ªæ„Ÿå…´è¶£ï¼Œé€šè¿‡WDA åšè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæ©ï¼</p><p>æ¥ä¸‹æ¥æ¼”ç¤ºä¸€ä¸‹æ€ä¹ˆç”¨ATXæ‰“å¼€iPhoneè‡ªå¸¦çš„è®¡æ—¶å™¨ï¼Œå¼€å§‹ç„¶åé€€å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/local/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> atx</span><br><span class="line"></span><br><span class="line">d = atx.connect(<span class="string">"http://localhost:8100"</span>)</span><br><span class="line">d.start_app(<span class="string">"com.apple.mobiletimer"</span>)</span><br><span class="line">d(text=<span class="string">u'è®¡æ—¶å™¨'</span>).click()</span><br><span class="line">d(text=<span class="string">u'å¼€å§‹è®¡æ—¶'</span>).click()</span><br><span class="line">d(text=<span class="string">u'å–æ¶ˆ'</span>).click()</span><br><span class="line">d.stop_app()</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸Šä»£ç å³å¯ä½“éªŒ</p><h1 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h1><p>æœ€åå¢™è£‚æ¨èåŸºäºPythonè‡ªåŠ¨åŒ–æ¡†æ¶åœ°å€ <a href="https://github.com/NetEaseGame/ATX" target="_blank" rel="noopener">https://github.com/NetEaseGame/ATX</a></p><p>Xcodeé—®é¢˜å¤šå¤šï¼Œæ„¿WDAä¸ä½ åŒåœ¨ã€‚</p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://testerhome.com/topics/7220" target="_blank" rel="noopener">ATX æ–‡æ¡£ - iOS çœŸæœºå¦‚ä½•å®‰è£… WebDriverAgent</a></p><p><a href="https://testerhome.com/topics/8820#reply47" target="_blank" rel="noopener">Macaca App Inspector 2.0 å‘å¸ƒ</a></p><p><a href="https://testerhome.com/topics/7840" target="_blank" rel="noopener">Appium Desktop ç®€å•ä»‹ç» â€”â€” xcodebuild failed with code 65 è§£å†³</a></p><p><a href="https://testerhome.com/topics/9666" target="_blank" rel="noopener">WebDriverAgent å¤©å‘è®°</a></p><p><a href="https://testerhome.com/topics/7324" target="_blank" rel="noopener">å¯åŠ¨ WebDriverAgent åå†å¯åŠ¨ appiumï¼Œè¿è¡Œè„šæœ¬ä¸€ç›´å¡åœ¨ Waiting for WebDriverAgent to start on device</a></p><p><a href="https://testerhome.com/topics/6331" target="_blank" rel="noopener">ATX æ”¯æŒ iOS10 æ‰‹æœºæµ‹è¯• æ–¹æ³•è¯´æ˜</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿‘æœŸï¼Œå¾®ä¿¡&lt;a href=&quot;https://github.com/wangshub/wechat_jump_game&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è·³ä¸€è·³å¤–æŒ‚&lt;/a&gt;ç«äº†ï¼Œçœ‹äº†ä½œè€…çš„æ€è·¯å’Œæ•™ç¨‹ï¼Œæ„Ÿè§‰æŒºç®€å•ï¼Œä¸è¿‡åœ¨å®ç°ï¼ˆç…§è‘«èŠ¦ç”»ç“¢ï¼‰çš„è¿‡ç¨‹ä¸­ï¼Œé­é‡åˆ°ä¸å°‘é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/yuhanle/blogbag/master/uploads/images/wda.png&quot; alt=&quot;WDA å·¥ä½œåŸç†&quot;&gt; &lt;/p&gt;
&lt;p&gt;å…¶ä¸­ä¹‹ä¸€ä¾¿æ˜¯ï¼ŒçœŸæœºè°ƒè¯• WDAï¼Œå‚è€ƒ iOS çœŸæœºå¦‚ä½•å®‰è£… &lt;a href=&quot;https://testerhome.com/topics/7220&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WebDriverAgent Â· TesterHome&lt;/a&gt;ï¼Œä¸‹é¢å°±æŒ‰ç…§è¿™ç¯‡æ•™ç¨‹ï¼Œå„ä¸ªå‡»ç ´çœŸæœºè°ƒè¯•WDA çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;h1 id=&quot;å¼€å§‹&quot;&gt;&lt;a href=&quot;#å¼€å§‹&quot; class=&quot;headerlink&quot; title=&quot;å¼€å§‹&quot;&gt;&lt;/a&gt;å¼€å§‹&lt;/h1&gt;&lt;p&gt;é¦–å…ˆæŒ‰ç…§æ•™ç¨‹ï¼Œå°½é‡æ›´æ–°ä¸‹Xcode çš„ç‰ˆæœ¬ï¼Œä»github ä¸Šä¸‹è½½WDA çš„æœ€æ–°ç‰ˆæœ¬ï¼Œç›´æ¥å…‹éš†åˆ°æœ¬åœ°&lt;/p&gt;
    
    </summary>
    
      <category term="UI Auto Test" scheme="https://blog.yuhanle.com/categories/UI-Auto-Test/"/>
    
    
      <category term="WDA" scheme="https://blog.yuhanle.com/tags/WDA/"/>
    
      <category term="UI Test" scheme="https://blog.yuhanle.com/tags/UI-Test/"/>
    
  </entry>
  
  <entry>
    <title>Xcode9.2 ç¼–è¯‘åœ¨iOS8.1 ç³»ç»Ÿä¸Šå›¾ç‰‡æ˜¾ç¤ºå¼‚å¸¸</title>
    <link href="https://blog.yuhanle.com/2017/12/09/xocde9-2-and-iOS-8-1-image-unnormal/"/>
    <id>https://blog.yuhanle.com/2017/12/09/xocde9-2-and-iOS-8-1-image-unnormal/</id>
    <published>2017-12-09T01:52:47.000Z</published>
    <updated>2021-10-21T08:18:48.340Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æœ€æ–°æ¶ˆæ¯"><a href="#æœ€æ–°æ¶ˆæ¯" class="headerlink" title="æœ€æ–°æ¶ˆæ¯"></a>æœ€æ–°æ¶ˆæ¯</h2><blockquote><p>ç›®å‰ xcode 9.3 å·²ç»è§£å†³äº†è¯¥é—®é¢˜</p></blockquote><a id="more"></a><blockquote><p>Asset Catalog<br>Known Issues<br>When using Xcode 9.2 to create apps that deploy to iOS 8 and later, images in the asset catalog may be corrupted when viewed on devices running iOS 8.3 and earlier. (35379713)<br>Workaround: Build the app using Xcode 9.1, or use Xcode 9.2 and set the deployment target to iOS 8.4 or later.</p></blockquote><hr><p>è¶ç€ä¸‹è½½ <code>Xcode 9.1</code> çš„ç©ºéš™ï¼Œåœ¨å‘¨æœ«çš„æ—©æ™¨è®°å½•ä¸€ä¸‹è¿™ä¸ªå‘ï¼Œå¸Œæœ›èƒ½è§£å†³ç›¸åŒé­é‡åŒè¡Œçš„å›°æƒ‘ã€‚</p><p><img src="https://github.com/yuhanle/blogbag/raw/master/uploads/images/0342bcd3280e6eaafcd3e99e0f4bc362.jpg" alt></p><h2 id="å§‹å› "><a href="#å§‹å› " class="headerlink" title="å§‹å› "></a>å§‹å› </h2><p>æ˜¨å¤©åˆšå‘å¸ƒäº†é€‚é… <code>iPhone X</code> çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä¹‹æ‰€ä»¥ä½¿ç”¨ <code>Xcode 9.2</code> æ‰“åŒ…ï¼Œæ˜¯å› ä¸ºæ—©æœŸçš„é€‚é…ï¼Œé€šè¿‡ <code>Xcode 8.2</code> æ‰“åŒ…ï¼Œå®‰è£…åˆ° <code>iPhone X</code> ä¸Šæ˜¾ç¤ºçš„æ•ˆæœæ˜¯æ²¡æœ‰é€‚é…ã€‚</p><p>è¿™ä¸ªä¹Ÿæ˜¯æ— æ³•è§£é‡Šçš„ï¼Œæˆ‘ä»¬å¼€å‘ä½¿ç”¨çš„ <code>Xcode 9</code>ï¼Œåœ¨é€‚é…è¿‡ç¨‹ä¸­æ²¡æœ‰é‡åˆ°è¯¥é—®é¢˜ï¼Œæ€»æ˜¯å‡çº§å°±å¯¹äº†ã€‚</p><p>åˆšå¥½æœ€è¿‘è‹¹æœçˆ¹å‘å¸ƒäº† <code>Xcode 9.2</code>ï¼Œå°±ç´¢æ€§å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚</p><p>æŒç»­åŒ–é›†æˆå°±æ˜¯æ–¹ä¾¿ï¼Œä»£ç æäº¤ä»¥åï¼Œå–æ¯å’–å•¡çš„å·¥å…·ï¼Œå°±ä¸Šä¼ æˆåŠŸï¼Œç­‰å¾…å®¡æ ¸ã€‚</p><p>ä¹Ÿå°±æ˜¯åœ¨æ˜¨å¤©ä¸­åˆï¼Œæ”¶åˆ°å®¡æ ¸é€šè¿‡çš„æé†’ï¼Œå¾ˆå¥‡æ€ªï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥æ˜¯ä»–ä»¬ä¼‘æ¯çš„æ—¶é—´ã€‚</p><p>ç„¶åï¼Œå°±éå¸¸è‚¯å®šï¼Œå› ä¸ºåœ¨é€‚é…çš„è¿‡ç¨‹ä¸­ï¼Œç‰¹æ„æ‰¾äº†ä¸¤ä¸ª <code>iPhone X</code> çš„ç”¨æˆ·å¸®åŠ©æµ‹è¯•ä½“éªŒã€‚éšç€å®¡æ ¸é€šè¿‡ï¼Œå°±å¾ˆå¿«å‘å¸ƒå‡ºå»ã€‚</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>å¤§æ¦‚ä¸‹åˆ3ç‚¹é’Ÿï¼Œè·ç¦»å‘å¸ƒç‰ˆæœ¬åªè¿‡äº† 3 ä¸ªå°æ—¶å·¦å³ã€‚æ”¶åˆ°å®¢æœå¦¹å­çš„ä¸€ä¸ªå¤§å†™çš„é—®å·ã€‚</p><p><img src="https://github.com/yuhanle/blogbag/raw/master/uploads/images/WX20171209-100043@2x.png" alt></p><p>è¿™ä¸€ç¬é—´ï¼Œæ•´ä¸ªäººéƒ½æ˜¯æ‡µçš„ï¼Œæ…Œå¿™è®©ç”¨æˆ·é‡å¯ <code>APP</code>ï¼Œé‡å¯ç³»ç»Ÿï¼Œå‡çº§ç³»ç»Ÿï¼Œæœ€åè¢«ç”¨æˆ·æ‹’ç»æ‰ã€‚</p><p>æ—¢ç„¶æ˜¯å¿…ç°çš„é—®é¢˜ï¼Œä¸èƒ½å°†é—®é¢˜æ¨åˆ°å‡çº§ç³»ç»Ÿä¸Šï¼Œè¯¥è§£å†³è¿˜æ˜¯è¦å°½å¿«è§£å†³çš„ã€‚</p><p>æ¥ç€å°±å¼€å§‹ç€æ‰‹å¦å¤–ä¸€ä¸ªé¡¹ç›®ï¼Œæ™šä¸Šå›åˆ°å®¶å¼€å§‹æ€è€ƒï¼Œé—®é¢˜å­˜åœ¨çš„ç‰ˆæœ¬è¿‘æœŸç©¶ç«Ÿæ”¹äº†ä»€ä¹ˆå†…å®¹ã€‚åŒæ—¶ä¹Ÿä¸‹è½½äº† <code>iOS8.1</code> çš„æ¨¡æ‹Ÿå™¨ï¼Œä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ <code>Xcode</code> è¿è¡Œçœ‹äº†ä¸‹æ•ˆæœï¼Œç¡®å®å¦‚æ­¤æ˜¯å¤ç°çš„ã€‚</p><p>æ‰€ä»¥ï¼Œè¦é©¬ä¸Šæ”¹å˜æ€åº¦ï¼Œå’Œå®¢æœåŒå¿—æå¥½å…³ç³»ï¼Œæ—©ç‚¹è®¤é”™æ‰èƒ½èµ°å¾—æ›´è¿œã€‚</p><p><img src="https://github.com/yuhanle/blogbag/raw/master/uploads/images/WX20171209-101223@2x.png" alt></p><h2 id="å›å¿†"><a href="#å›å¿†" class="headerlink" title="å›å¿†"></a>å›å¿†</h2><h3 id="1-åˆ æ‰LaunchScreen-sb-æ–‡ä»¶"><a href="#1-åˆ æ‰LaunchScreen-sb-æ–‡ä»¶" class="headerlink" title="1. åˆ æ‰LaunchScreen.sb æ–‡ä»¶"></a>1. åˆ æ‰LaunchScreen.sb æ–‡ä»¶</h3><p>ä¸ºäº†é€‚é… <code>iPhone X</code> çš„å¯åŠ¨å›¾ï¼ŒåŒæ—¶åœ¨å¯åŠ¨åä½¿ç”¨å¯åŠ¨å›¾åšäº†ç®€å•çš„æ•ˆæœï¼Œå†³å®šä½¿ç”¨ <code>LaunchImage</code> çš„æ–¹å¼è®¾ç½®å¯åŠ¨å›¾ã€‚</p><p>åœ¨æ›´æ”¹ä»£ç åï¼Œå°è¯•äº†ä¸€ä¸‹ä¿®æ”¹ç»“æœï¼Œä¾ç„¶æ˜¯éæ­£å¸¸çš„ã€‚</p><p>æ•ˆæœå¦‚ä¸‹ï¼Œä¸æ¯«æ²¡æœ‰æ”¹å˜ï¼š</p><p><img src="https://github.com/yuhanle/blogbag/raw/master/uploads/images/Simulator Screen Shot - iPhone 6 - 2017-12-09 at 10.17.01.png" alt></p><h3 id="2-Xcode-ç‰ˆæœ¬å‡çº§"><a href="#2-Xcode-ç‰ˆæœ¬å‡çº§" class="headerlink" title="2. Xcode ç‰ˆæœ¬å‡çº§"></a>2. Xcode ç‰ˆæœ¬å‡çº§</h3><p>è¿™æ¬¡çš„æ”¹åŠ¨æ¯”è¾ƒå°ï¼Œæ‰€ä»¥åœ¨æ’é™¤ä¸Šè¿°çš„æ”¹åŠ¨åï¼Œç›´æ¥æƒ³åˆ°çš„å°±æ˜¯å¯èƒ½å°±æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å¾ˆå°‘ä¼šæ€€ç–‘è‹¹æœçˆ¹ä¼šæŒ–è¿™ä¹ˆå¤§çš„å‘ï¼Œè®©å¼€å‘è€…è·³è¿›å»ã€‚</p><p>ä¸ç®¡å¦‚ä½•ï¼Œé™çº§ç‰ˆæœ¬è¯•è¯•å°±çŸ¥é“æ˜¯ä¸æ˜¯è¿™ä¸ªåŸå› ã€‚</p><table><thead><tr><th>Xcode9.2</th><th>Xcode9.1</th></tr></thead><tbody><tr><td><img src="https://github.com/yuhanle/blogbag/raw/master/uploads/images/Simulator Screen Shot - iPhone 6 - 2017-12-09 at 10.17.01.png" alt="ä¿®æ”¹å‰"></td><td><img src="https://github.com/yuhanle/blogbag/raw/master/uploads/images/Simulator%20Screen%20Shot%20-%20iPhone%206%20-%202017-12-09%20at%2010.51.55.png" alt="ä¿®æ”¹å"></td></tr></tbody></table><p>é€šè¿‡ä¸Šè¿°å¯¹æ¯”ï¼Œç¡®å®šé—®é¢˜å°±å¤„åœ¨ <code>Xcode</code> ç‰ˆæœ¬ä¸Šã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><h3 id="1-ç­‰è‹¹æœçˆ¹æ›´æ–°"><a href="#1-ç­‰è‹¹æœçˆ¹æ›´æ–°" class="headerlink" title="1. ç­‰è‹¹æœçˆ¹æ›´æ–°"></a>1. ç­‰è‹¹æœçˆ¹æ›´æ–°</h3><p>å¦‚æœè‹¹æœçˆ¹ä¸€ç›´æ²¡æ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæˆ–è€…æ²¡æœ‰äººæï¼Œè°çŸ¥é“è¿˜è¦ç­‰å¤šä¹…ï¼Ÿ<br>å…³äºæ­¤é—®é¢˜ï¼Œæˆ‘å·²ç»å‘è‹¹æœçˆ¹æäº¤äº† <code>bug</code>ï¼ŒæœŸå¾…åç»­ä¿®å¤ï¼š</p><p><a href="https://bugreport.apple.com/web/?problemID=35948702" target="_blank" rel="noopener">ProblemID=35948702</a></p><h3 id="2-å…ˆé™çº§-Xcode"><a href="#2-å…ˆé™çº§-Xcode" class="headerlink" title="2. å…ˆé™çº§ Xcode"></a>2. å…ˆé™çº§ Xcode</h3><p>ç¡®åˆ‡çš„è¯´ï¼Œè¿™æ˜¯ç›®å‰æœ€å¿«æ·çš„ä¸€ä¸ªæ–¹å¼ï¼Œä¿è¯æ²¡æœ‰é—®é¢˜</p><h3 id="3-æ”¹å˜å›¾ç‰‡èµ„æºå­˜å‚¨"><a href="#3-æ”¹å˜å›¾ç‰‡èµ„æºå­˜å‚¨" class="headerlink" title="3. æ”¹å˜å›¾ç‰‡èµ„æºå­˜å‚¨"></a>3. æ”¹å˜å›¾ç‰‡èµ„æºå­˜å‚¨</h3><p>å›¾ç‰‡ä¸è¦æ”¾åœ¨ <code>asset</code> é‡Œé¢ï¼Œæ–¹æ³•æ”¾åœ¨<code>bundle</code> é‡Œé¢å°±æ²¡é—®é¢˜ã€‚ä¸çŸ¥é“æ˜¯ <code>Xcode9.2</code> <code>bug</code> è¿˜æ˜¯æ²¡è®¾ç½®ç›¸å…³å±æ€§</p><h3 id="4-èµ„æºé—®é¢˜ä¼˜åŒ–"><a href="#4-èµ„æºé—®é¢˜ä¼˜åŒ–" class="headerlink" title="4. èµ„æºé—®é¢˜ä¼˜åŒ–"></a>4. èµ„æºé—®é¢˜ä¼˜åŒ–</h3><p>æ¢æˆ9.1ï¼Œä¸è¿‡æˆ‘å‘ç° @2x, @3x è¿™ä¸‰ä¸ªå›¾æ ‡éƒ½å¡«æ»¡çš„å°±æ²¡è¿™ <code>BUG</code>ï¼Œåªæ”¾ä¸€ä¸ªæ‰æœ‰</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="http://www.cocoachina.com/bbs/read.php?tid=1729079" target="_blank" rel="noopener">Xcode9.2 è¿è¡ŒiOS8.1å›¾ç‰‡å¼‚å¸¸</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æœ€æ–°æ¶ˆæ¯&quot;&gt;&lt;a href=&quot;#æœ€æ–°æ¶ˆæ¯&quot; class=&quot;headerlink&quot; title=&quot;æœ€æ–°æ¶ˆæ¯&quot;&gt;&lt;/a&gt;æœ€æ–°æ¶ˆæ¯&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;ç›®å‰ xcode 9.3 å·²ç»è§£å†³äº†è¯¥é—®é¢˜&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="tools" scheme="https://blog.yuhanle.com/categories/tools/"/>
    
    
      <category term="tips" scheme="https://blog.yuhanle.com/tags/tips/"/>
    
  </entry>
  
  <entry>
    <title>å‡çº§ macOS High Sierra åä¸ Cocoapods çš„å…¼å®¹é—®é¢˜</title>
    <link href="https://blog.yuhanle.com/2017/12/06/macos-high-sierra-with-cocoapods/"/>
    <id>https://blog.yuhanle.com/2017/12/06/macos-high-sierra-with-cocoapods/</id>
    <published>2017-12-06T03:42:36.000Z</published>
    <updated>2021-10-21T08:18:48.338Z</updated>
    
    <content type="html"><![CDATA[<p>å½“ä½ å‘è§‰è‡ªå·±æ²¡æœ‰é—®é¢˜çš„æ—¶å€™ï¼Œé‚£å°±å°è¯•ç€é‡å¯ä¸€ä¸‹ï¼Œä¸‡ä¸€é—®é¢˜è§£å†³äº†å‘¢ï¼Ÿ</p><p>æœ€è¿‘å®åœ¨åŒçƒ¦è‹¹æœæ¨é€äº† macOS High Sierra æ›´æ–°ï¼Œäºæ˜¯ä¸€ä¸‹ç­å‰æ‰“å¼€ç”µè„‘æ›´æ–°ç³»ç»Ÿã€‚è¿‡ç¨‹è¿˜ç®—é¡ºåˆ©ï¼Œç½‘ç»œå¾ˆå¿«ï¼Œå¤§æ¦‚ 10å·¦å³å°±ä¸‹è½½å®Œæ¯•ï¼Œå‡çº§è¿‡ç¨‹ä¸­å¡æ­»ï¼Œéšåå°±è¡Œä¸‹ç­å›å®¶ï¼Œè®©å…¶å‡çº§äº†ä¸€ä¸ªå¤œæ™š</p><p>ä¸è¿‡åœ¨ä½¿ç”¨ Cocoapods çš„æ—¶å€™è¿˜æ˜¯é‡åˆ°äº†é—®é¢˜ï¼š</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">06-Dec-2017 09:28:38/Users/tianyi/bamboo-agent-home/temp/IOS-PB-JOB1-382-ScriptBuildTask-1550561307052749322.sh: /usr/local/bin/pod: /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby: bad interpreter: No such file or directory</span><br><span class="line">06-Dec-2017 11:24:58env: ruby_executable_hooks: No such file or directory</span><br><span class="line">06-Dec-2017 11:30:11/Users/tianyi/bamboo-agent-home/temp/IOS-PB-JOB1-382-ScriptBuildTask-5355633338674781643.sh: line 7: pod: command not found</span><br><span class="line">06-Dec-2017 11:31:27env: ruby_executable_hooks: No such file or directory</span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥æ˜¯ Cocoapods ä¾èµ–çš„ Ruby ç‰ˆæœ¬é—®é¢˜ï¼ŒGoogle ä¸€ä¸‹ï¼Œå‘ç°å·²ç»æœ‰äººåœ¨ Cocoapods çš„ repo ä¸‹æäº†è¿™ä¸ª <a href="https://github.com/CocoaPods/CocoaPods/issues/6778" target="_blank" rel="noopener">issue</a>ï¼Œä¸‹é¢ä¹Ÿæœ‰å¼€å‘è€…ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼šé‡æ–°å®‰è£… Cocoapods. </p><p>Pod å‘½ä»¤éœ€è¦ç”¨åˆ° 2.0 ç‰ˆæœ¬çš„ Ruby è§£é‡Šå™¨ <code>/System/Library/Frameworks/Ruby.framework/Versions/2.0</code>ï¼Œè€Œ <code>macOS High Sierra</code> å°†ç³»ç»Ÿçš„ Ruby è§£é‡Šå™¨å‡çº§åˆ°äº† <code>2.3</code> <code>/System/Library/Frameworks/Ruby.framework/Versions/2.3</code>ï¼Œå› æ­¤æ‰§è¡Œ pod å‘½ä»¤çš„æ—¶å€™ç”±äºæ‰¾ä¸åˆ° Ruby è§£é‡Šå™¨è€ŒæŠ¥é”™ã€‚</p><p>äºæ˜¯æŒ‰ç…§æç¤ºé‡è£… Cocoapodsï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo gem install cocoapods</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåç»§ç»­æ‰§è¡Œ pod installï¼ŒåˆæŠ¥äº†åŒæ ·çš„é”™è¯¯ã€‚æˆ‘å†³å®šç»§ç»­é‡è£…ä¸€æ¬¡ Cocoapodsï¼Œä¸è¿‡è¿™æ¬¡åŠ ä¸Š â€“verbose å‚æ•°ï¼Œçœ‹çœ‹å®‰è£…è¿‡ç¨‹ä¸­åšäº†å“ªäº›æ“ä½œã€‚log å¤ªé•¿æˆ‘å°±ä¸è´´äº†ï¼Œä¸è¿‡æ³¨æ„åˆ°æœ€åè¾“å‡ºçš„ pod å‘½ä»¤ä½ç½®ä¼¼ä¹è·Ÿä¸Šé¢æ‰§è¡Œ which pod è¾“å‡ºæœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯ /usr/bin/podï¼Œè€Œ which pod çš„è¾“å‡ºæ˜¯ /usr/local/bin/podï¼Œå†çœ‹ä¸€ä¸‹æˆ‘çš„ $PATH è·¯å¾„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ echo $PATH</span><br><span class="line">/Users/tianyi/.rvm/gems/ruby-2.4.1/bin:/Users/tianyi/.rvm/gems/ruby-2.4.1@global/bin:/Users/tianyi/.rvm/rubies/ruby-2.4.1/bin:/Users/tianyi/.rvm/bin:/Library/Java/JavaVirtualMachines/jdk1.8.0_91.jdk/Contents/Home/bin:/Users/tianyi/.jenv/shims:/Users/tianyi/.jenv/bin:/opt/subversion/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/Server.app/Contents/ServerRoot/usr/bin:/Applications/Server.app/Contents/ServerRoot/usr/sbin:/usr/local/go/bin:/Users/tianyi/bin:/Users/tianyi/goProject/bin:/usr/local/go/bin:/usr/local/Cellar/nginx/1.12.0/bin:/usr/local/mysql/bin</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åœ¨æˆ‘çš„ $PATH ç¯å¢ƒå˜é‡é‡Œï¼Œ/usr/local/bin çš„ä¼˜å…ˆçº§æ˜¯é«˜äº /usr/bin çš„ï¼Œå› æ­¤å½“è¿™ä¸¤ä¸ªåœ°æ–¹éƒ½å­˜åœ¨ä¸€ä¸ªåå« pod çš„å‘½ä»¤æ—¶ï¼Œç³»ç»Ÿä¼˜å…ˆæ‰§è¡Œ /usr/local/bin/podï¼Œäºæ˜¯é”™è¯¯å°±è¿™ä¹ˆäº§ç”Ÿäº†ã€‚å› æ­¤æˆ‘ç›´æ¥åˆ é™¤ /usr/local/bin/pod æ–‡ä»¶ï¼Œå†æ‰§è¡Œ pod install â€“verboseï¼Œè¿™ä¸€æ¬¡æœç„¶å®‰è£…æˆåŠŸäº†ã€‚</p><p>è¿™ä¸ªé—®é¢˜åº”è¯¥æ˜¯ç”±äº Cocoapods æ”¹å˜äº†å®‰è£…è·¯å¾„å¯¼è‡´çš„ï¼Œè®°å¾— macOS å¯ç”¨ System Integrity Protection ä¹‹å Cocoapods çš„å®‰è£…è·¯å¾„ä¹Ÿä¿®æ”¹è¿‡ï¼Œè¿™æ¬¡åº”è¯¥ä¹Ÿæ˜¯ç±»ä¼¼çš„é—®é¢˜å§ï¼Œç”±äº $PATH è¿™ä¸ªç¯å¢ƒå˜é‡çš„é—®é¢˜ï¼Œå¯¼è‡´è€ç‰ˆæœ¬çš„ pod å‘½ä»¤ä¼˜å…ˆè¢«æ‰§è¡Œã€‚</p><p>äº‹æƒ…è‡³æ­¤è¿˜æœªç»“å±€</p><p>æœ¬åœ°æ‰§è¡Œpod æŒ‡ä»¤å·²ç»æ²¡é—®é¢˜äº†ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡Bamboo é›†æˆï¼Œä½¿ç”¨è„šæœ¬æ‰“åŒ…ï¼Œå´ä¸€ç›´é‡å¤å‰é¢çš„é”™è¯¯æ— æ³•è‡ªæ‹”ã€‚</p><p>é‡å¯bamboo æœåŠ¡ï¼Œä¾ç„¶ä¸èƒ½è§£å†³é—®é¢˜</p><p>å°è¯•ç€ä½¿ç”¨é‡å¯æ²»ç™¾ç—…çš„æ‰‹æ®µï¼Œç”µè„‘å…³æœºé‡å¯è¯•è¯•çœ‹ï¼</p><p>ç¥ˆç¥·ä¸­â€¦ğŸ™</p><p>2017å¹´12æœˆ6æ—¥åˆæ—¶ä¸‰åˆ»æ›´</p><p>è¯´äº†ä½ å¯èƒ½ä¸ç›¸ä¿¡ï¼Œé‡å¯ç”µè„‘åï¼Œä¸€åˆ‡é—®é¢˜éƒ½å¥½äº†~</p><p>æ›´æ–°</p><p>è§£å†³macOS Sierraä¸‹æ³¨å†Œæœºæ— æ³•è¿è¡Œçš„é—®é¢˜</p><p>å¾ˆå¤šè½¯ä»¶éƒ½ä¸å…¼å®¹äº†<br>ã€Œå®‰å…¨æ€§ä¸éšç§ã€è®¾ç½®ä¸­ã€Œä»»ä½•æ¥æºã€é€‰é¡¹æ¶ˆå¤±<br>å‡ ä¹æ‰€æœ‰æ³¨å†Œæœºéƒ½ç”¨ä¸äº†</p><p>æ¢å¤ä»»ä½•æ¥æºé€‰é¡¹<br>psï¼šå¦‚æœç³»ç»Ÿå‡çº§å‰å°±å·²ç»é€‰æ‹©äº†ä»»ä½•æ¥æºï¼Œå‡çº§åè¿˜ä¼šæ­£å¸¸æ˜¾ç¤º</p><p>æ‰“å¼€ç»ˆç«¯(Terminal.app)<br>æ‰§è¡Œ<code>sudo spctl --master-disable</code></p><p>â€œä»»ä½•æ¥æºâ€æ¢å¤~</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å½“ä½ å‘è§‰è‡ªå·±æ²¡æœ‰é—®é¢˜çš„æ—¶å€™ï¼Œé‚£å°±å°è¯•ç€é‡å¯ä¸€ä¸‹ï¼Œä¸‡ä¸€é—®é¢˜è§£å†³äº†å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æœ€è¿‘å®åœ¨åŒçƒ¦è‹¹æœæ¨é€äº† macOS High Sierra æ›´æ–°ï¼Œäºæ˜¯ä¸€ä¸‹ç­å‰æ‰“å¼€ç”µè„‘æ›´æ–°ç³»ç»Ÿã€‚è¿‡ç¨‹è¿˜ç®—é¡ºåˆ©ï¼Œç½‘ç»œå¾ˆå¿«ï¼Œå¤§æ¦‚ 10å·¦å³å°±ä¸‹è½½å®Œæ¯•ï¼Œå‡çº§è¿‡ç¨‹ä¸­å¡æ­»ï¼Œéšåå°±è¡Œä¸‹ç­å›å®¶ï¼Œè®©å…¶å‡çº§äº†ä¸€ä¸ªå¤œæ™š&lt;/p&gt;
&lt;p&gt;ä¸è¿‡åœ¨ä½¿ç”¨ Cocoapods çš„æ—¶å€™è¿˜æ˜¯é‡åˆ°äº†é—®é¢˜ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="https://blog.yuhanle.com/categories/iOS/"/>
    
    
      <category term="tips" scheme="https://blog.yuhanle.com/tags/tips/"/>
    
  </entry>
  
  <entry>
    <title>ä¼™è®¡ä»¬ï¼ŒGo å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•</title>
    <link href="https://blog.yuhanle.com/2017/12/04/go-is-not-very-simple-folks/"/>
    <id>https://blog.yuhanle.com/2017/12/04/go-is-not-very-simple-folks/</id>
    <published>2017-12-04T01:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.336Z</updated>
    
    <content type="html"><![CDATA[<p>å·²å‘å¸ƒï¼š<a href="https://studygolang.com/articles/12330" target="_blank" rel="noopener">https://studygolang.com/articles/12330</a></p><h1 id="ä¼™è®¡ä»¬ï¼ŒGo-å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•"><a href="#ä¼™è®¡ä»¬ï¼ŒGo-å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•" class="headerlink" title="ä¼™è®¡ä»¬ï¼ŒGo å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•"></a>ä¼™è®¡ä»¬ï¼ŒGo å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•</h1><p>å‡ºäºå¥½å¥‡ï¼Œæˆ‘æœ€è¿‘å¼€å§‹æ¥è§¦ä¸€äº› Go çš„ä»£ç ã€‚æˆ‘ä¹‹å‰å¯¹å®ƒæœ‰ä¸€äº›äº†è§£ï¼Œä½†æ˜¯ä»æ¥æ²¡æœ‰å°è¯•å»å†™ï¼ˆæ²¡æœ‰éœ€æ±‚ï¼‰ã€‚ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å›¢é˜Ÿé€‰æ‹©ä½¿ç”¨ Go æ¥å¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—è¿™æ˜¯ä¸€ä¸ªè·å¾—å®é™…ç»éªŒçš„å¥½æœºä¼šã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå…³äºè¿™é—¨è¯­è¨€æˆ‘å·²ç»å­¦ä¹ äº†å¾ˆé•¿æ—¶é—´ã€‚åœ¨è¿™ä¸ªåšæ–‡çš„æœ«å°¾ï¼Œæˆ‘ä¼šå†™æ›´å¤šå…³äº Go çš„å¹²è´§ã€‚</p><a id="more"></a><p>ç¤¾åŒºå®é™…ä¸Šå¹¶ä¸é‚£ä¹ˆä»¤äººæ„‰å¿«ï¼Œç‰¹åˆ«æ˜¯é‚£äº›å› ä¸ºå®ƒçš„ç®€å•æ€§è€Œä¸»å¼ ä½¿ç”¨ Go çš„äººã€‚ä¼¼ä¹ç®€å•å·²ç»æˆä¸º Go ç¤¾åŒºä¸­çš„ä¸€ä¸ªæµè¡Œè¯­ï¼Œè®¸å¤šäººåå¤é‡å¤æåˆ°è¿™ç‚¹ï¼Œå´æ²¡æœ‰ç»™å‡ºå¤ªå¤šå®é™…çš„æƒ³æ³•ã€‚</p><p>è¿™å¯¹æˆ‘æ¥è¯´ä¼¼ä¹å¾ˆä¸å¹¸ï¼Œå› ä¸ºåœ¨æˆ‘çœ‹æ¥ï¼ŒGo æ˜¯ä¸€ä¸ªâ€œæå…¶ç®€å•çš„è¯­è¨€â€ï¼š</p><ol><li>ä¸åº”è¯¥ä½œä¸ºè€ƒè™‘ä½¿ç”¨ Go çš„ä¸»è¦åŸå› </li><li>ä»ä»–ä»¬çš„å…³æ³¨ç‚¹ä¸­æ‰¾åˆ°å…¶ä»–æ›´æœ‰åˆ©çš„æ¨èç†ç”±</li><li>ç”šè‡³ä¸æ˜¯çœŸçš„ï¼ˆä¸æ˜¯çœŸçš„ç®€å•ï¼‰</li></ol><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³å›´ç»• Go æ¥åˆ†æä¸€äº›ç®€å•è§‚ç‚¹ã€‚</p><p><em>åœ¨æ·±å…¥ä¹‹å‰ï¼Œæˆ‘æƒ³å¼ºè°ƒä¸€ä»¶äº‹æƒ…</em>ï¼šè¿™ç¯‡æ–‡ç« å¹¶ä¸æ˜¯å¯¹ Go çš„æ‰¹è¯„ï¼Œè€Œæ˜¯ä¸€ç§å¯¹ Go çš„å®£ä¼ å’Œå€¡å¯¼çš„æ–¹å¼ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘å¯èƒ½ä¼šæ‰¹è¯„è¿™ä¸ªè¯­è¨€çš„æŸä¸ªæ–¹é¢ï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹ï¼Œæˆ‘åªä¼šè¯•å›¾ç”¨ä¸€ç§éæ­£å¼çš„ã€äº‹å®çš„ï¼Œæ¯ç§è¯­è¨€éƒ½ä¼šæ¶‰åŠçš„æ–¹å¼æ¥è®²è¿°ã€‚</p><h2 id="æˆ‘æ¥è‡ªå“ªé‡Œ"><a href="#æˆ‘æ¥è‡ªå“ªé‡Œ" class="headerlink" title="æˆ‘æ¥è‡ªå“ªé‡Œ"></a>æˆ‘æ¥è‡ªå“ªé‡Œ</h2><p>å‡ºäºå·¥ä½œå’Œä¸šä½™çˆ±å¥½ï¼Œæˆ‘åŒæ—¶ä½¿ç”¨å¤šç§ç¼–ç¨‹è¯­è¨€ã€‚æˆ‘ä¸èµæˆæœ‰â€œæœ€å–œæ¬¢çš„è¯­è¨€â€çš„æ¦‚å¿µã€‚è¿‡å»æˆ‘æ›¾ç»æœ‰è¿‡ä¸€äº›æœ€å–œæ¬¢çš„è¯­è¨€ï¼Œä½†è¿™ç§è®¤è¯†å¾€å¾€æ˜¯ä¸€æ—¶çš„æƒ…æ„Ÿï¼Œéšç€æ—¶é—´æ¨ç§»ï¼Œä¼šå‘ç”Ÿå˜åŒ–ã€‚</p><p>åœ¨æˆ‘çš„å·¥ä½œä¸­ï¼Œæˆ‘ä½¿ç”¨ <code>C++</code> å’Œ <code>Python</code> å†™å¤§å‹æœåŠ¡çš„åç«¯ä»£ç ã€‚è¿‡å»æˆ‘æ›¾ç»åœ¨ä¸€ä¸ªä½ å¯èƒ½çŸ¥é“çš„æ“ä½œç³»ç»Ÿä¸Šå·¥ä½œï¼Œè€Œä¸”æˆ‘ä¹Ÿåšäº†åµŒå…¥å¼å·¥ä½œã€‚åœ¨ä¸šä½™é¡¹ç›®ä¸­ï¼Œæˆ‘åšäº†å…¶ä»–å„ç§äº‹æƒ…ã€‚</p><p>æˆ‘å¹¶ä¸æ˜¯å¤¸è€€ä»€ä¹ˆï¼ˆæˆ‘ä¸æ˜¯ä¸€ä¸ªä¸“å®¶ï¼‰ï¼Œæˆ‘åªæ˜¯æƒ³è¡¨æ˜ï¼Œæˆ‘åœ¨ç¼–ç¨‹çš„è®¸å¤šé¢†åŸŸè‡³å°‘æœ‰ä¸€äº›è§è§£ï¼Œè€Œä¸”æˆ‘ä¸€ç›´åŠªåŠ›ä¿æŒå¼€æ”¾çš„å¿ƒæ€ã€‚</p><p>æ‰€ä»¥ï¼Œä¸è¦ç€æ€¥ï¼Œè®©æˆ‘ä»¬å¼€å§‹è®¨è®ºæ­£é¢˜ï¼Œçœ‹çœ‹å‡ ä¸ªè§‚ç‚¹ã€‚</p><h3 id="1-â€œä¸ä¸»æµè¯­è¨€ç›¸æ¯”ï¼ŒGo-çš„å…³é”®å­—éå¸¸å°‘â€"><a href="#1-â€œä¸ä¸»æµè¯­è¨€ç›¸æ¯”ï¼ŒGo-çš„å…³é”®å­—éå¸¸å°‘â€" class="headerlink" title="1. â€œä¸ä¸»æµè¯­è¨€ç›¸æ¯”ï¼ŒGo çš„å…³é”®å­—éå¸¸å°‘â€"></a>1. â€œä¸ä¸»æµè¯­è¨€ç›¸æ¯”ï¼ŒGo çš„å…³é”®å­—éå¸¸å°‘â€</h3><p>æˆ‘ä»ä¸€ä¸ªæœ€å¸¸è§çš„ä¾‹å­å¼€å§‹ã€‚å½“æ¨å¹¿ Go æ—¶ï¼Œè¿™ä¼šæ˜¯å¤§å®¶çš„å£å¤´ç¦…ã€‚</p><p>é¦–å…ˆï¼Œå³ä½¿å®ƒæ˜¯çœŸå®çš„ï¼Œæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆå…³é”®å­—æ•°é‡ä¼šæ˜¯åˆ¤æ–­ä¸€ä¸ªè¯­è¨€çš„å­¦ä¹ æ›²çº¿æˆ–å¤æ‚æ€§çš„é‡è¦ä¾æ®ã€‚å½“ç„¶ï¼Œå¦‚æœæœ‰æˆåƒä¸Šä¸‡çš„å…³é”®å­—ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ä½†æ˜¯å¤§å¤šæ•°è¯­è¨€æœ€å¤šåªæœ‰å‡ åä¸ªå…³é”®å­—ï¼Œè¿™ç§è§„æ¨¡ä¸‹ï¼Œå…³é”®å­—çš„å¤šå°‘æ˜¯æ— å…³ç´§è¦çš„ã€‚</p><p>æˆ‘è¿˜æ²¡æœ‰å¬åˆ°æœ‰äººå› ä¸ºå…³é”®å­—çš„æ•°é‡è€ŒæŠ±æ€¨æŸé—¨è¯­è¨€</p><p>å…¶æ¬¡ï¼ŒGo æ‰€è°“çš„â€œå¾ˆå°‘â€çš„å…³é”®å­—å®é™…ä¸Šåªä¸è¿‡æ˜¯ä¸€ä¸ªèªæ˜å¾‹å¸ˆçš„ä¼ä¿©ï¼ˆä¹Ÿè®¸ï¼Œæˆ‘ç”šè‡³ä¼šè®¤ä¸ºè¿™æ˜¯ Go çš„è™šå‡å¹¿å‘Šï¼‰ã€‚<a href="https://golang.org/ref/spec#Keywords" target="_blank" rel="noopener">Go è§„èŒƒ</a> åˆ—å‡ºäº† 25 ä¸ªå…³é”®å­—ï¼Œè¿™çš„ç¡®æ¯”å¤§å¤šæ•°è¯­è¨€è¦å°‘äº›ã€‚ä½†åœ¨æˆ‘çœ‹æ¥ï¼ŒGo å¹¶æ²¡æœ‰æ¯”å…¶ä»–è¯­è¨€å…³é”®å­—è¡¨ç¤ºæ›´å°‘çš„æ¦‚å¿µï¼ŒGo è™½ç„¶æ²¡æœ‰è¿™äº›å…³é”®å­—ï¼Œä½†ç›¸åº”çš„æ¦‚å¿µä¾ç„¶æ˜¯è¯­è¨€çš„ä¸€éƒ¨åˆ†ï¼ˆå³å®é™…çš„å¤æ‚æ€§ä¿æŒä¸å˜ï¼‰ã€‚</p><p>ä¸ºäº†è¯´æ˜æˆ‘çš„æ„æ€ï¼Œè¯·è€ƒè™‘ä¸€ä¸ª <code>while</code> å¾ªç¯ã€‚ Go æ²¡æœ‰è¿™ä¸ªå…³é”®å­—ï¼Œè¿™æ˜¯çœŸçš„ï¼Œä½†å®ƒä»ç„¶æœ‰ä¸€ä¸ª while å¾ªç¯ï¼Œ<a href="https://tour.golang.org/flowcontrol/3" target="_blank" rel="noopener">æ–‡æ¡£</a>ç”šè‡³æ˜¯è¿™æ ·è¯´çš„ï¼Œå®ƒçš„ç›®çš„åªæ˜¯é‡ç”¨å…¶ä»–å…³é”®å­—ã€‚</p><p>å¦ä¸€ä¸ªè¿™æ ·çš„ä¾‹å­æ˜¯ <code>private</code> å’Œ <code>public</code>ã€‚ Go æ²¡æœ‰è¿™äº›å…³é”®å­—ï¼Œä½†å®ƒä»ç„¶æœ‰ <code>private</code> å’Œ <code>public</code>ï¼Œå®ƒåªæ˜¯ä½¿ç”¨å­—æ¯å¤§å°å†™è€Œä¸æ˜¯å…³é”®å­—ã€‚</p><p>ç”¨æ¥åˆ å‡å…³é”®å­—çš„å¦ä¸€ä¸ªæŠ€å·§å« <a href="https://golang.org/ref/spec#Predeclared_identifiers" target="_blank" rel="noopener">é¢„å®šä¹‰æ ‡è¯†ç¬¦ï¼ˆPredeclared identifiersï¼‰</a>ï¼Œåœ¨æŠ€æœ¯ä¸Šå®ƒä¸æ˜¯å…³é”®å­—ï¼Œä½†æ˜¯åœ¨å®è·µä¸­ä»ç„¶éœ€è¦å®ƒä»¬ï¼Œåˆ›å»ºä¸€ä¸ªå’Œå®ƒåŒåçš„å˜é‡ä»ç„¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› æ­¤ï¼Œæœ€åçœ‹æ¥â€¦å®ƒä»¬åŸºæœ¬ä¸Šæ˜¯å…³é”®å­—ã€‚æ­¤å¤–ï¼Œå…¶ä¸­ä¸€äº›é¢„å®šä¹‰æ ‡è¯†ç¬¦æ˜¯å…¶ä»–è¯­è¨€çš„å…³é”®å­—ï¼Œå› æ­¤ä»…å°†å®ƒä»¬ä¸ Go çš„å…³é”®å­—åˆ—è¡¨è¿›è¡Œæ¯”è¾ƒæ˜¯éå¸¸ä¸å…¬å¹³çš„ã€‚å°±åƒè‹¹æœå’Œæ¡”å­ã€‚</p><h3 id="2-æ¥æ”¶è€…å‚æ•°"><a href="#2-æ¥æ”¶è€…å‚æ•°" class="headerlink" title="2. æ¥æ”¶è€…å‚æ•°"></a>2. æ¥æ”¶è€…å‚æ•°</h3><p><a href="https://tour.golang.org/methods/1" target="_blank" rel="noopener">æ¥å—è€…å‚æ•°</a>å¯¹æˆ‘æ¥è¯´æœ‰äº›å¤æ€ªã€‚çœ‹èµ·æ¥ Go ä¼¼ä¹å¹¶ä¸å»ºè®®ä½¿ç”¨ <code>this</code> å’Œ <code>self</code>ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦æ–¹æ³•ï¼Œæ‰€ä»¥å°±å­˜åœ¨ â€œæ¥æ”¶è€…å‚æ•°â€ï¼Œé™¤äº†æ–¹æ³•ç­¾åçœ‹ä¸Šå»å¾ˆå¥‡æ€ªä¹‹å¤–ï¼Œå®ƒä»¬åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ã€‚</p><p>æ¥æ”¶è€…å‚æ•°æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½“è®¿é—®ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œæˆ‘éœ€è¦çŸ¥é“æ¥æ”¶è€…å‚æ•°ï¼ˆè¿™æ˜¯ä»»æ„çš„ï¼‰çš„åç§°ï¼Œä»¥æ˜ç¡®è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨ã€‚å› ä¸ºç¼ºå°‘å…³é”®å­—ï¼ˆè¯‘æ³¨ï¼šå¦‚ thisï¼‰ï¼Œè¯­æ³•é«˜äº®æˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚ï¼ˆçœ‹å§ï¼Ÿè¿™æ˜¯å¦‚ä½•å‡å°‘å…³é”®å­—å®é™…ä¸Šä½¿äº‹æƒ…å˜å¾—æ›´åŠ å¤æ‚çš„ä¾‹å­ã€‚ï¼‰è¿™æœ‰ç‚¹åƒ <code>C++</code> ä¸­çš„éšå¼ <code>this</code>ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªæ–°äººå®¹æ˜“æ··æ·†çš„<a href="https://stackoverflow.com/questions/17932722/go-difference-between-parameter-and-receiver" target="_blank" rel="noopener">ä¾‹å­</a>ã€‚</p><p>æ•æˆ‘ç›´è¨€ï¼Œæœ€ç®€å•ã€æœ€ç›´æ¥çš„æ–¹å¼æ¥è¡¨è¾¾ä¸€ä¸ªæ¥æ”¶å™¨æ˜¯ <a href="https://en.wikipedia.org/wiki/Uniform_Function_Call_Syntax" target="_blank" rel="noopener">UFCS</a>ï¼Œè€Œä¸æ˜¯ C++ æˆ– Go çš„æ–¹å¼ã€‚ä½†å°±åƒæˆ‘è¯´çš„ï¼Œæˆ‘ä¸æ˜¯åœ¨æŠ±æ€¨ Goï¼Œæˆ‘çœŸçš„ä¸ä»‹æ„æ¥å—è€…å‚æ•°çš„è§‚ç‚¹ï¼ˆå¦‚æœæˆ‘å¿å—ä¸äº† C++ çš„æ€ªå¼‚ï¼Œæˆ‘å¯ä»¥å¿å— Go çš„ï¼‰ã€‚</p><h3 id="3-å‡½æ•°è¿”å›å€¼"><a href="#3-å‡½æ•°è¿”å›å€¼" class="headerlink" title="3. å‡½æ•°è¿”å›å€¼"></a>3. å‡½æ•°è¿”å›å€¼</h3><p>å¦‚æœæ¥æ”¶å‚æ•°ä¸å¤Ÿï¼Œå‡½æ•°ç”šè‡³èƒ½å¤Ÿé€šè¿‡å„ç§å½¢å¼çš„è¿”å›å€¼æ¥å£°æ˜ã€‚é€šå¸¸è¯­è¨€å…è®¸ä½ é€šè¿‡ <code>return</code> è¯­å¥è¿”å›å‡½æ•°ä¸­çš„ä¸€ä¸ªå€¼ã€‚è€Œåœ¨ Go è¯­è¨€ä¸­ï¼Œä½ å¯ä»¥è¿”å›å¤šä¸ªå€¼ï¼ˆæˆ‘è®¤ä¸ºå¯ä»¥ç”¨æ›´ä¼˜é›…çš„æ–¹å¼é€šè¿‡å…ƒç»„æ¥è§£å†³ï¼Œä½†æ˜¯å°±è¿™æ ·å§ï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰<a href="https://tour.golang.org/basics/7" target="_blank" rel="noopener">å‘½åè¿”å›å€¼</a>ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬åœ¨é‚£äº›å¾ˆéš¾æ‰¾åˆ°è¿”å›å€¼çš„åœ°æ–¹å†™ä¸Šæ™•å¤´è½¬å‘çš„ä»£ç ã€‚ç»“åˆæ¥æ”¶æ–¹å‚æ•°ï¼Œæ‚¨å¯ä»¥åˆ›å»ºè¿™æ ·çš„å‡½æ•°ç­¾åï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f Foobar)</span> <span class="title">Something</span><span class="params">(a <span class="keyword">int</span>, b <span class="keyword">int</span>, c <span class="keyword">int</span>)</span> <span class="params">(foo <span class="keyword">int</span>, bar <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æœ‰æ•ˆçš„ Go ä»£ç ã€‚å¦‚æ‚¨æ‰€è§ï¼Œæœ‰ä¸‰ä¸ªå‚æ•°ã€‚æˆ‘çœŸçš„ä¸å¸Œæœ›ä»»ä½•äººè¯•å›¾é€‰æ‹©è¿™ä¸ªâ€œç®€å•â€ï¼Œå› ä¸ºè¿™ä¸ªè¯­æ³•é™¤äº†ç®€å•ï¼Œä»€ä¹ˆä¹Ÿä¸æ˜¯ã€‚</p><h3 id="4-â€œæ²¡æœ‰ç»§æ‰¿â€"><a href="#4-â€œæ²¡æœ‰ç»§æ‰¿â€" class="headerlink" title="4. â€œæ²¡æœ‰ç»§æ‰¿â€"></a>4. â€œæ²¡æœ‰ç»§æ‰¿â€</h3><p>Goï¼ˆæˆ–è®¸åªæ˜¯ç¤¾åŒºï¼‰ä¼¼ä¹å¾ˆåå¯¹â€œä¼ ç»Ÿçš„ OOPâ€ï¼ˆä¸ç®¡è¿™æ˜¯æŒ‡å“ªä¸ªï¼Œå¯èƒ½æ˜¯ Java æˆ–è€… C++ï¼‰ï¼Œæˆ‘è®°å¾—æœ‰äººè¯´ Go æ²¡æœ‰ç»§æ‰¿æ˜¯ä¸€ä»¶å¥½äº‹ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒGo æœ‰ä¸€ä¸ªåŠŸèƒ½å«åš<a href="https://golang.org/doc/effective_go.html#embedding" target="_blank" rel="noopener">åµŒå…¥</a>ï¼Œè¿™ä¸ªæ–‡æ¡£ä»¥åŠä¸€äº›åšå®¢æ–‡ç« å£°ç§° Go æ²¡æœ‰ç»§æ‰¿ã€‚æˆ‘è¯•ç€ç”¨å„ç§æ–¹å¼ä½¿ç”¨å®ƒï¼Œæˆ‘æ²¡æ³•è®¤ä¸º Go åå¯¹ç»§æ‰¿ã€‚ä¸Šé¢é“¾æ¥çš„æ–‡æ¡£è¯´ï¼š</p><blockquote><p>è¿˜æœ‰ç§åŒºåˆ†å†…åµŒä¸å­ç±»çš„é‡è¦æ‰‹æ®µã€‚å½“å†…åµŒä¸€ä¸ªç±»å‹æ—¶ï¼Œè¯¥ç±»å‹çš„æ–¹æ³•ä¼šæˆä¸ºå¤–éƒ¨ç±»å‹çš„æ–¹æ³•ï¼Œä½†å½“å®ƒä»¬è¢«è°ƒç”¨æ—¶ï¼Œè¯¥æ–¹æ³•çš„æ¥æ”¶è€…æ˜¯å†…éƒ¨ç±»å‹ï¼Œè€Œéå¤–éƒ¨çš„ã€‚</p></blockquote><p>æœ‰å·®åˆ«å—ï¼Ÿç»§æ‰¿é€šå¸¸ä»¥ç›¸åŒçš„æ–¹å¼å·¥ä½œï¼Œç»§æ‰¿çš„æ–¹æ³•ä¹Ÿå¯¹å†…éƒ¨ç±»å‹èµ·ä½œç”¨ã€‚</p><p>åœ¨æˆ‘çœ‹æ¥ï¼Œåœ¨ Go ä¸­ï¼ŒçœŸæ­£å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå¤šæ€æ€§ä»ç»“æ„ä¸­è§£è€¦ã€‚ä½ éœ€è¦ä½¿ç”¨æ¥å£æ¥ä½¿ç”¨å¤šæ€æ€§ã€‚ä½†ä¸€æ—¦ä½ åšäº†ï¼Œåšçš„äº‹æƒ…å’Œä¼ ç»Ÿçš„ OOP éå¸¸ç›¸ä¼¼ï¼ŒåŒ…æ‹¬æ–¹æ³•è¦†ç›–â€Š-â€Š<a href="https://play.golang.org/p/DRozP3HCAk" target="_blank" rel="noopener">è¿™é‡Œæ˜¯ä¸ªæ¼”ç¤º</a>ã€‚</p><p>å…³äº Goï¼Œæœ‰ä»¶äº‹ä»¤æˆ‘å¾ˆæƒŠè®¶ â€”â€” è¿™é—¨æ‰€è°“ç®€å•çš„è¯­è¨€ â€”â€” ä½ ç”šè‡³å¯ä»¥å®ç°å¤šé‡ç»§æ‰¿ã€‚<strong>ç¡®å®å¾ˆç³Ÿç³•ã€‚</strong> <a href="https://groups.google.com/forum/#!topic/golang-nuts/fRfkPNlA7Pk" target="_blank" rel="noopener">golang-nut çš„é‚®ä»¶åˆ—è¡¨</a>ä¸­ï¼Œæœ‰äººæåˆ°ï¼ŒGo å¹¶ä¸èƒ½å¾ˆå¥½çš„å¤„ç†ç»§æ‰¿çš„æ­§ä¹‰ã€‚æˆ‘å·²ç»è°ƒæ•´äº†å…¶ä¸­æåŠçš„ä»£ç ï¼Œä»¥ä¾¿å®ƒå±•ç¤ºäº†è‘—åçš„â€œå¯æ€•çš„é’»çŸ³é—®é¢˜â€ï¼ˆDreaded diamond problemï¼‰ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T1 <span class="keyword">struct</span> &#123;</span><br><span class="line">T2</span><br><span class="line">T3</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T2 <span class="keyword">struct</span> &#123;</span><br><span class="line">T4</span><br><span class="line">foo <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T3 <span class="keyword">struct</span> &#123;</span><br><span class="line">T4</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T4 <span class="keyword">struct</span> &#123;</span><br><span class="line">foo <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">t2 := T2&#123; T4&#123; <span class="number">9000</span> &#125;, <span class="number">2</span> &#125;</span><br><span class="line">t3 := T3&#123; T4&#123; <span class="number">3</span> &#125; &#125;</span><br><span class="line">fmt.Printf(<span class="string">"foo=%d\n"</span>, t2.foo)</span><br><span class="line">fmt.Printf(<span class="string">"foo=%d\n"</span>, t3.foo)</span><br><span class="line">t1 := T1&#123;</span><br><span class="line">t2,</span><br><span class="line">t3,</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">"foo=%d\n"</span>, t1.foo)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://play.golang.org/p/cSCLyGHssR" target="_blank" rel="noopener">åœ¨çº¿è¿è¡Œä»¥ä¸Šä»£ç </a></p><p>ä¸Šé¢çš„ä»£ç æ²¡æœ‰ä»»ä½•ç¼–è¯‘æ—¶è­¦å‘Šæˆ–è€…é”™è¯¯ã€‚<a href="https://ideone.com/gfKYqR" target="_blank" rel="noopener">è¿™æ˜¯ C++ çš„ç±»ä¼¼çš„ä»£ç </a>ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒç¼–è¯‘ä¸é€šè¿‡ï¼Œå› ä¸ºå­˜åœ¨æ­§ä¹‰ã€‚</p><p>ç»“æœä¼šå¦‚ä½•ï¼Ÿé¦–å…ˆï¼Œæˆ‘è®¤ä¸ºå…·æœ‰å¤šé‡ç»§æ‰¿åŠŸèƒ½ï¼Œå‡ ä¹ä¸èƒ½åœ¨æè¿°è¯¥ç¼–ç¨‹è¯­è¨€æ—¶ä½¿ç”¨â€œç®€å•â€ä¸€è¯ã€‚<strong>åœ¨æˆ‘çœ‹åˆ°ä¸Šé¢çš„ä»£ç åï¼Œæ²¡æœ‰äººèƒ½è¯´æœæˆ‘ï¼ŒGo æ˜¯æœ€ç®€å•çš„è¯­è¨€ä¹‹ä¸€ï¼Œç”šè‡³è¿ç®€å•è¯­è¨€éƒ½ä¸ç®—ã€‚</strong>ç”šè‡³æ²¡æœ‰å…¶ä»–ä¸€äº›ä½ å¯ä»¥ç”¨åµŒå…¥æ¥åšçš„äº‹æƒ…ï¼Œæ¯”å¦‚é€šè¿‡æŒ‡é’ˆåµŒå…¥æˆ–è€…é€šè¿‡æŒ‡é’ˆåµŒå…¥æ¥å£ã€‚ ï¼ˆæˆ‘ç”šè‡³ä¸ç¡®å®šè¿™äº›åŠŸèƒ½çš„çœŸæ­£å«ä¹‰ã€‚ï¼‰</p><p>å…¶æ¬¡ï¼Œæˆ‘æƒ³åšä¸€ä¸ªç®€çŸ­ã€å¯¹ Go è¯­è¨€æœ¬èº«çš„æ‰¹è¯„ã€‚ä¸å¤„ç†è¿™æ ·çš„æ­§ä¹‰ä¼¼ä¹æ˜¯ä¸€ä¸ªè®¾è®¡æˆ–è€…å®ç°é”™è¯¯ã€‚ç”šè‡³è¿ C++ éƒ½æ²¡æœ‰å¦‚æ­¤ç–¯ç‹‚ï¼Œè®©è¿™ç§ä»£ç ç¼–è¯‘é€šè¿‡ã€‚è¿™è¶³ä»¥å‘Šè¯‰ä½ ä¸€äº›äº‹æƒ…ã€‚</p><h3 id="5-é”™è¯¯å¤„ç†"><a href="#5-é”™è¯¯å¤„ç†" class="headerlink" title="5. é”™è¯¯å¤„ç†"></a>5. é”™è¯¯å¤„ç†</h3><p>å„ç§é”™è¯¯å¤„ç†é€šå¸¸ä¼šå¯¼è‡´ä¸€ä¸ªå·¨å¤§çš„å£æ°´æˆ˜ã€‚æˆ‘ä¸æƒ³è°ˆé‚£ä»¶äº‹ã€‚æˆ‘æ›¾ç»åœ¨ä¸åŒçš„è¯­è¨€ä¸­ä½¿ç”¨è¿‡æ‰€æœ‰å¸¸è§çš„é”™è¯¯å¤„ç†é£æ ¼ï¼ˆæˆ‘è®¤ä¸ºï¼‰ï¼Œæˆ‘ä¹Ÿä¸å–œæ¬¢æ‰€æœ‰è¿™äº›è¯­è¨€ã€‚æˆ‘è®¤ä¸ºï¼Œé”™è¯¯å¤„ç†æ— è®ºä»€ä¹ˆä¸€ç›´æ˜¯ä¸€ä¸ª <code>PITA</code>ï¼ˆè¯‘æ³¨ï¼šåº”è¯¥æ˜¯å›½å¤–çš„ä¸€ç§æ¯”å–»ï¼‰ã€‚æŠŠä¸€ç§é£æ ¼æ¢æˆå¦ä¸€ç§é£æ ¼ï¼Œä½ åªéœ€æŠŠä¸€å¥—é—®é¢˜æ¢æˆå¦ä¸€å¥—ã€‚æ²¡æœ‰å¥½çš„æ–¹æ³•ã€‚</p><p>å›åˆ°ç®€å•çš„è¯é¢˜ï¼šGo è®©æˆ‘é€‰æ‹©ä¸ä½¿ç”¨å¼‚å¸¸ï¼Œè¿™ä½¿äº‹æƒ…æ›´ç®€å•äº†ã€‚å¤šä¸ªè¿”å›å€¼çš„ç‰¹å¾ä¸èƒ½ä½¿äº‹æƒ…å˜å¾—ç®€å•ï¼Œè¿™æ„å‘³ç€ä¸èƒ½è¿”å›ä¸€ä¸ªé”™è¯¯æˆ–æˆåŠŸçš„ç»“æœï¼Œä½ å¯ä»¥è¿”å›æ‰€æœ‰å€¼æˆ–è€…éƒ½ä¸è¿”å›ï¼ˆ<code>CS</code> æœ¯è¯­ï¼Œä½ å¯ä»¥è¯´è¿™ä¸ªé—®é¢˜æ˜¯ä¸€ä¸ªäº§å“ç±»å‹è€Œä¸æ˜¯æ€»å’Œå¼çš„ç”¨æ³•ï¼‰ã€‚äº‹å®ä¸Šï¼Œæˆ‘çœ‹è¿‡çš„è®¸å¤šå¯¹äºæ–°äººçš„ä»£ç å®¡æŸ¥ã€‚</p><p>å¦‚æœ Go ä¸å…è®¸å¤šä¸ªè¿”å›å€¼ï¼Œè€Œæœ‰ä¸€äº›åˆé€‚çš„æˆ–è€…å–œæ¬¢çš„ç±»å‹ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œè¿™ä¼šä½¿äº‹æƒ…å˜å¾—æ›´ç®€å•ã€‚å‡ºäºåŒæ ·çš„åŸå› ï¼Œåœ¨ Go ä¸­å¿½ç•¥é”™è¯¯æˆ–è€…ä¸å‘å‘è°ƒç”¨è€…æˆ–å…¶ä»–é€‚å½“ç›®çš„åœ°æŠ¥å‘Šé”™è¯¯æ˜¯ç›¸å½“å®¹æ˜“çš„ã€‚</p><p>å¦ä¸€ä¸ç®€å•çš„æ˜¯ panicã€‚ä¸è¦è¯¯è§£æˆ‘çš„æ„æ€ï¼Œæˆ‘ç†è§£å®ƒåœ¨ Go ä¸­å­˜åœ¨çš„åŸå› ä»¥åŠå®ƒçš„ç”¨å¤„ï¼Œäº‹å®ä¸Šï¼Œå…¶ä»–è¯­è¨€ä¹Ÿæœ‰ç±»ä¼¼çš„å¤„ç†ã€‚æˆ‘åªæ˜¯æå‡ºæ¥ä½œä¸ºåå¯¹ç®€å•æ€§çš„ä¸€ä¸ªè®ºæ®ã€‚æ•æˆ‘ç›´è¨€ï¼Œå¯¹äºä¸€ä¸ªæ–°äººï¼Œå¾ˆå¯èƒ½ä¼šæ··æ·† error å’Œ panic ä¹‹é—´çš„åŒºåˆ«ï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™é€‚åˆç”¨ä»€ä¹ˆã€‚</p><h3 id="6-æ³›å‹"><a href="#6-æ³›å‹" class="headerlink" title="6. æ³›å‹"></a>6. æ³›å‹</h3><p>è¿™ä¸ªä¸»é¢˜å’Œé”™è¯¯å¤„ç†æ¯”èµ·æ¥ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¤§çš„è •è™«ã€‚</p><p>å’Œ errors ä¸€æ ·ï¼Œæˆ‘åªæƒ³è€ƒè™‘ä¸€ä¸‹è¿™é‡Œçš„å¤æ‚æ€§æˆ–è€…ç®€å•æ€§ã€‚Go ç¤¾åŒºçš„è®¸å¤šäººä¼¼ä¹è®¤ä¸ºï¼Œæ³›å‹çš„æœ¬è´¨ä¸Šæ˜¯å¤æ‚çš„ï¼ˆ=åï¼Œå—¯å—¯å—¯å’³ï¼‰ï¼Œæœ‰è¿™æ ·æˆ–é‚£æ ·çš„å·¨å¤§å¼€é”€ã€‚è¿™åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯äº‹å®ï¼Œä½†æˆ‘ä¸è®¤ä¸ºå®ƒåƒæœ‰äº›äººæè¿°çš„é‚£ä¹ˆç³Ÿç³•ã€‚ä¼¼ä¹é‚£äº›äººå·²ç»ç»å†äº† <code>C++</code> æ¨¡æ¿çš„ç—›è‹¦ï¼Œä»é‚£ä»¥åï¼Œæ— è®ºä½•æ—¶æåŠæ³›å‹ï¼Œéƒ½ä¼šé­å— PTSDï¼ˆåˆ›ä¼¤ååº”æ¿€éšœç¢ï¼‰ çš„æ”»å‡»ã€‚</p><p>çœ‹åˆ°è¿™é‡Œçš„äººï¼Œ<strong>æ³›å‹ä¸æ˜¯ä¸€ä¸ªæ€ªç‰©</strong>ã€‚å®ƒä»¬å½“ç„¶ç»å¯¹ä¸åº”è¯¥åƒ <code>C++</code> é‚£æ ·å¤æ‚ï¼ˆæˆ–è€…å…¶ä»–ä¸€äº›å¥‡æ€ªçš„è¯­è¨€ï¼‰ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼Œç”šè‡³å‰ç«¯çš„äººéƒ½ç”¨æ³›å‹å·¥ä½œäº†ä¸€æ®µæ—¶é—´ï¼ˆTypeScript, Flow, â€¦ï¼‰ï¼Œå¦‚æœä»–ä»¬ä¸å®³æ€•æ³›å‹ï¼Œå…¶ä»–ç¨‹åºå‘˜åº”è¯¥æ˜¯æ²¡æœ‰ç†ç”±å®³æ€•ï¼šï¼‰ï¼ˆå¯¹ä¸èµ·ï¼Œå‰ç«¯å¼€å‘è€…ï¼Œåªæ˜¯å¼€ä¸ªç©ç¬‘ã€‚ï¼‰</p><p>äººä»¬è¿˜æ²¡æœ‰æ„è¯†åˆ°ï¼Œå¦‚æœæ­£ç¡®åœ°ä½¿ç”¨æ³›å‹ï¼Œå®ƒå¯ä»¥ä½¿è®¸å¤šç±»å‹å’Œå‡½æ•°çš„ä½¿ç”¨æ›´åŠ ç®€å•ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ Go ä¸­çš„<a href="https://golang.org/pkg/container/heap/" target="_blank" rel="noopener">å †æ¥å£</a>ã€‚è¿™å°±æ˜¯ä»ä¸€ä¸ªå †ä¸­å£°æ˜è¿™ä¸ªæ¥å£çš„æ–¹å¼ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">popped := heap.Pop(&amp;someheap)</span><br><span class="line">myfoo := popped.(*Foo)       <span class="comment">// ZOMG what just happened here?</span></span><br></pre></td></tr></table></figure><p>å¯¹æ–°äººè§£é‡Šè¿™äº›ï¼ŒåŒ…æ‹¬ panic çš„é—®é¢˜ã€‚ä¹Ÿè®¸å¯ä»¥è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æœä»–ä»¬æ²¡æœ‰çœŸæ­£æŠŠæ•´ä¸ª <code>interface{}</code> æå¯¹ï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿä»€ä¹ˆã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myfoo := heap.Pop(&amp;someheap) <span class="comment">// myfoo has the correct type</span></span><br></pre></td></tr></table></figure><p>è¿™æ›´å®¹æ˜“é˜…è¯»ã€æ›´å®¹æ˜“è§£é‡Šï¼ˆä½ è§£é‡Šå®ƒï¼Œå°±åƒä½ å°†è§£é‡Š <code>map</code> ç±»å‹å·²ç»å­˜åœ¨äº Goï¼ï¼‰ã€‚è€Œä¸”åœ¨ç¼–å†™ä»£ç æ—¶ä¹Ÿæ›´éš¾å¼„ä¹±ã€‚</p><p>ç¼ºä¹æ³›å‹æ˜¯é€ æˆé¢å¤–å¤æ‚æ€§çš„åŸå› ï¼Œå®ƒåœ¨ Go çš„å…¶ä»–éƒ¨åˆ†ä¹Ÿä¼šé€ æˆç›¸å½“å¤šçš„å¤æ‚æ€§ï¼Œä¸»è¦æ˜¯éœ€è¦å­˜åœ¨å„ç§â€œç¥å¥‡â€çš„å‡½æ•°/ç±»å‹ã€‚<code>map</code>ï¼Œ<code>slice</code> å’Œ <code>channel</code> ç±»å‹çš„é­”æ³•ï¼Œä»¥åŠä¼´éšçš„ <code>make()</code> åŠŸèƒ½ï¼Œè¿™æ˜¯å®ƒä»¬ä¸‰ä¸ªçš„æ„é€ å‡½æ•°ã€‚<code>slice</code> ç±»å‹æ—¢å¯ä»¥ä½œä¸ºæ•°ç»„çš„å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºåŠ¨æ€æ•°ç»„ã€‚ï¼ˆä¸ç®¡å‘ç”Ÿä»€ä¹ˆäº‹ï¼Œâ€œåšä¸€ä»¶äº‹ï¼Œå¹¶åšå¥½å®ƒâ€ï¼Ÿï¼‰</p><p>ï¼ˆåªæ˜¯ä¸ºäº†æé†’å¤§å®¶ï¼Œæˆ‘å¹¶ä¸ä»‹æ„è¿™äº›ï¼Œåªæ˜¯ä¸ºäº†ä¸ç®€å•çš„äº‰è®ºè€ŒæåŠå®ƒã€‚ï¼‰</p><h3 id="7-å…¶ä»–"><a href="#7-å…¶ä»–" class="headerlink" title="7. å…¶ä»–"></a>7. å…¶ä»–</h3><p>æˆ‘æƒ³æˆ‘å·²ç»æŠŠä¸»è¦çš„ç®€å•è¿åè€…æ’é™¤åœ¨å¤–äº†ã€‚æˆ‘çš„å•å­ä¸Šåªå‰©ä¸‹å‡ ä¸ªç®€å•çš„ï¼š</p><ol><li><code>&lt;-</code> å’Œ <code>-&gt;</code> æ“ä½œç¬¦ã€‚è¿™äº›å¯èƒ½åªæ˜¯ <code>channel</code> ç±»å‹çš„æ–¹æ³•ã€‚</li><li><code>iota</code> - åŸºæœ¬ä¸€æ ·ï¼Œä½†å¥‡æ€ªçš„æšä¸¾ã€‚</li><li>å†…ç½®çš„å¤æ•°ã€‚</li><li><a href="https://tour.golang.org/flowcontrol/6" target="_blank" rel="noopener">if æ”¯æŒçŸ­è¯­å¥</a>ï¼ˆæœ‰æ—¶å¯èƒ½æœ‰ç”¨ï¼Œä½† <code>if</code> è¯­æ³•æ¯”å…¶ä»–è¯­è¨€ä¸­æ›´å¤æ‚ï¼‰</li></ol><p>æˆ‘æƒ³å°±æ˜¯è¿™æ ·ã€‚å¯èƒ½å¿˜è®°äº†ä»€ä¹ˆï¼Œä½†æˆ‘æƒ³å·²ç»è¶³å¤Ÿäº†ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘è§‰å¾—å¦‚æœä¸æ˜¯ç®€å•çš„è¯ï¼ŒGo å®é™…ä¸Šä¼šå¸¦æ¥ä»€ä¹ˆå‘¢ï¼Ÿ</p><h2 id="ä»»åŠ¡-â€œgoroutinesâ€"><a href="#ä»»åŠ¡-â€œgoroutinesâ€" class="headerlink" title="ä»»åŠ¡â€Š-â€Šâ€œgoroutinesâ€"></a>ä»»åŠ¡â€Š-â€Šâ€œgoroutinesâ€</h2><p>è¿™å¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹æ˜¾è€Œæ˜“è§ï¼Œå› ä¸º <code>goroutines</code> æ˜¯ä¸€ä¸ªç»å¸¸è¢«æåŠçš„ç‰¹æ€§ï¼Œå°±åƒâ€œç®€å•â€ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—éœ€è¦åŒºåˆ†ä¸‹ï¼šæˆ‘è®¤ä¸ºè¿™ä¸æ˜¯é€šå¸¸æ„ä¹‰ä¸Šçš„å¹¶å‘æ€§ï¼Œå®ƒä¸èƒ½è®¤ä¸ºæ˜¯ Go çš„ä¼˜åŠ¿ã€‚ä¸è¦è¯¯è§£æˆ‘çš„æ„æ€ï¼ŒGo çš„å¹¶å‘æ€§æ˜¯æ²¡é—®é¢˜çš„ã€‚åªæ˜¯è¯´è¿™æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ã€‚ä½ æœ‰ channelï¼Œè¿™è‚¯å®šæ˜¯å¥½çš„ï¼Œä½†åŸºæœ¬ä¸Šï¼Œå®ƒä»¬åªæ˜¯åƒæˆ‘åœ¨åˆ«å¤„å¸¸ç”¨çš„å¹¶å‘é˜Ÿåˆ—ã€‚ç„¶åä½ æœ‰å¸¸è§„çš„å¹¶å‘åŸè¯­ï¼Œåƒ mutexï¼Œè¯»å†™é”ï¼Œæ¡ä»¶å˜é‡ç­‰ã€‚ä½ å¯ä»¥åŒæ­¥ä½ çš„ä»£ç ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°åƒè®¸å¤šå…¶ä»–è¯­è¨€ä¸€æ ·çš„ç«äº‰æ¡ä»¶å’Œæ­»é”ã€‚</p><p>æˆ‘å–œæ¬¢ <code>goroutines</code>ï¼ˆé™¤äº†æ˜æ˜¾çš„äº‹å®ï¼Œå®ƒä»¬æ˜¯è½»é‡çº§çš„ç”¨æˆ·ç©ºé—´çº¿ç¨‹ï¼‰æ˜¯å®ƒä»¬å¯ä»¥ä½¿ç”¨ I/O çš„æ–¹å¼ - è°ƒåº¦è¿æ¥åˆ°ä¸»æœºæ“ä½œç³»ç»Ÿçš„ä½çº§ I/O API çš„æ–¹å¼ï¼ˆå¦‚ epollã€kqueueã€IOCPâ€¦ï¼‰ã€‚è¿™å¯¹äºç¨‹åºå‘˜æ¥è¯´é€šå¸¸å¾ˆéš¾åšå‡ºä»¤äººæ„‰å¿«å’Œæœ‰ç”¨çš„ä¸œè¥¿ï¼Œç‰¹åˆ«æ˜¯åœ¨ç¼–è¯‘æœ¬åœ°è¯­è¨€çš„æ—¶å€™ã€‚æˆ‘ä»ç„¶åœ¨è¿™é‡Œäº†è§£ç»†èŠ‚ï¼Œä½†åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘è®¤ä¸º Go æ˜¯æœªæ¥å·¥ç¨‹çš„ä¸€ä¸ªäº®ç‚¹ã€‚</p><p>æ­£å¦‚å·²ç»æš—ç¤ºçš„ï¼Œæˆ‘ä¹Ÿå–œæ¬¢ Go è¿™ç§ç¼–è¯‘ä¸ºæœ¬åœ°ä»£ç çš„è¯­è¨€ã€‚çœ‹åˆ°æ–°çš„è¯­è¨€ä½¿ç”¨åƒåœ¾æ”¶é›†æ¥ä¿æŒè¿™ç§ä¸å¯æ€è®®çš„æ•ˆæœçœŸæ˜¯å¤ªå¥½äº†ã€‚ï¼ˆæˆ–å…¶ä»–å½¢å¼çš„è‡ªåŠ¨å†…å­˜ç®¡ç† - <code>Swift</code> ä¸­æœ‰æåŠï¼‰</p><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>æ‰€ä»¥ï¼Œè¯»è€…ä»¬ï¼Œä¸ºä»€ä¹ˆæ‰€æœ‰è¿™äº›éƒ½ç¦»å¼€äº†ä½ å‘¢ï¼Ÿæ˜¯ Go å¤æ‚è¿˜æ˜¯å…¶ä»–ä»€ä¹ˆåŸå› ï¼Ÿ</p><p>å½“ç„¶ä¸æ˜¯ï¼Œç»å¯¹ä¸åƒ <code>C++</code> æˆ– <code>Haskell</code> é‚£æ ·å¤æ‚ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒGo çš„ç¡®å¾ˆç®€å•ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¯”è¾ƒ Go å’Œå…¶ä»–å¸¸è§è¯­è¨€ï¼ˆå¦‚<code>Java</code> ï¼Œ<code>JavaScript</code> ï¼Œ<code>Python</code> ç­‰ï¼‰çš„å¤æ‚æ€§æ—¶ï¼Œæƒ…å†µå°±ä¸å¤ªæ¸…æ¥šäº†ï¼Œæ­£å¦‚æˆ‘å¸Œæœ›çš„é‚£æ ·ã€‚ ï¼ˆæ­¤å¤–ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆéš¾ï¼Œæ²¡æœ‰æ˜ç¡®å®šä¹‰çš„ä»»åŠ¡ã€‚ï¼‰</p><p>æˆ‘å¯ä»¥æä¾›ç±»ä¼¼çš„ä¾‹å­ã€‚åœ¨æŸäº›æ–¹é¢ï¼ŒGo å¯èƒ½æ¯”è¿™äº›è¯­è¨€æ›´ç®€å•ï¼Œæœ‰äº›åˆ™ä¸æ˜¯â€¦å¤§è‡´ä¸Šæˆ‘ä¼šè¯´å®ƒå’Œå…¶ä»–å¸¸ç”¨è¯­è¨€çš„å¹³å‡å·®ä¸å¤šã€‚æˆ‘ä¹Ÿä¸è®¤ä¸ºç®€å•ï¼Œæ— è®ºæ˜¯æ„Ÿè§‰ä¸Šè¿˜æ˜¯å®é™…ä½¿ç”¨ä¸­ï¼Œæœ€ç»ˆçš„ä½“éªŒå¾ˆé‡è¦ã€‚</p><p>æœ€åï¼Œè¿™ç¯‡æ–‡ç« ä»å“ªé‡Œæ¥ï¼Œä½œè€…æ˜¯è°ï¼Ÿæˆ‘ä¸è‚¯å®šã€‚æˆ‘è¿˜ä¸çŸ¥é“ Go æ˜¯å¦ä¼šåœ¨æˆ‘çš„æ—¥å¸¸å·¥ä½œä¸­è¢«é€‰ä¸ºä¸€ä¸ªï¼ˆå­ï¼‰é¡¹ç›®ï¼Œæˆ–è€…æˆ‘æ˜¯å¦å¯èƒ½å°†å®ƒç”¨äºå…´è¶£çˆ±å¥½é¡¹ç›®ã€‚æˆ‘æƒ³é¿å…åƒæœ¬æ–‡æåˆ°çš„é‚£ç§æ•™æ¡çš„ç¤¾åŒºæ¨å¹¿çš„ä¸€ä»½å­ã€‚æœ‰æ²¡æœ‰æ„è¯†å½¢æ€å¯¼å‘çš„åœ°æ–¹å‘¢ï¼Ÿ å¤§å®¶å¯ä»¥éšæ„å°±æ­¤æå‡ºå»ºè®®ã€‚</p><p>æˆ‘å’Œ <code>Rust</code> ç¤¾åŒºæœ‰åŒæ ·çš„é—®é¢˜ï¼Œè¯·ä¸è¦ä»‹æ„ï¼Œæˆ‘ä¹ŸçŸ¥é“ç¦»å¼€é‚£äº›æ›´ç‹‚çƒ­çš„æ”¯æŒè€…ä¼šæ›´å¥½ã€‚ ï¼ˆQï¼šâ€œä½ èƒ½å¦åœ¨ <code>Rust</code> é‡å†™ä½ çš„é¡¹ç›®ï¼Ÿâ€Aï¼šâ€œè¿·å¤±äº†â€ï¼‰ä¹Ÿè®¸è¿™å°±æ˜¯è¿™äº›æ–°è¯­è¨€çš„æ€§è´¨ï¼Œä»¥åŠä»–ä»¬ä¸ºæ¿€åŠ±äººä»¬å¦‚æ­¤æ¿€åŠ±é˜³å…‰çš„äº‰æ–—ã€‚</p><hr><p>via: <a href="https://medium.com/@bob.clark_34506/go-is-not-very-simple-folks-3e84220e73c7" target="_blank" rel="noopener">https://medium.com/@bob.clark_34506/go-is-not-very-simple-folks-3e84220e73c7</a></p><p>ä½œè€…ï¼š<a href="https://medium.com/@bob.clark_34506" target="_blank" rel="noopener">The Other Bob</a><br>è¯‘è€…ï¼š<a href="https://github.com/yuhanle" target="_blank" rel="noopener">yuhanle</a><br>æ ¡å¯¹ï¼š<a href="https://github.com/polaris1119" target="_blank" rel="noopener">polaris1119</a></p><p>æœ¬æ–‡ç”± <a href="https://github.com/studygolang/GCTT" target="_blank" rel="noopener">GCTT</a> åŸåˆ›ç¼–è¯‘ï¼Œ<a href="https://studygolang.com/" target="_blank" rel="noopener">Go ä¸­æ–‡ç½‘</a> è£èª‰æ¨å‡º</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å·²å‘å¸ƒï¼š&lt;a href=&quot;https://studygolang.com/articles/12330&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://studygolang.com/articles/12330&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;ä¼™è®¡ä»¬ï¼ŒGo-å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•&quot;&gt;&lt;a href=&quot;#ä¼™è®¡ä»¬ï¼ŒGo-å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•&quot; class=&quot;headerlink&quot; title=&quot;ä¼™è®¡ä»¬ï¼ŒGo å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•&quot;&gt;&lt;/a&gt;ä¼™è®¡ä»¬ï¼ŒGo å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•&lt;/h1&gt;&lt;p&gt;å‡ºäºå¥½å¥‡ï¼Œæˆ‘æœ€è¿‘å¼€å§‹æ¥è§¦ä¸€äº› Go çš„ä»£ç ã€‚æˆ‘ä¹‹å‰å¯¹å®ƒæœ‰ä¸€äº›äº†è§£ï¼Œä½†æ˜¯ä»æ¥æ²¡æœ‰å°è¯•å»å†™ï¼ˆæ²¡æœ‰éœ€æ±‚ï¼‰ã€‚ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å›¢é˜Ÿé€‰æ‹©ä½¿ç”¨ Go æ¥å¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—è¿™æ˜¯ä¸€ä¸ªè·å¾—å®é™…ç»éªŒçš„å¥½æœºä¼šã€‚&lt;/p&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå…³äºè¿™é—¨è¯­è¨€æˆ‘å·²ç»å­¦ä¹ äº†å¾ˆé•¿æ—¶é—´ã€‚åœ¨è¿™ä¸ªåšæ–‡çš„æœ«å°¾ï¼Œæˆ‘ä¼šå†™æ›´å¤šå…³äº Go çš„å¹²è´§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Translate" scheme="https://blog.yuhanle.com/categories/Translate/"/>
    
      <category term="Go" scheme="https://blog.yuhanle.com/categories/Translate/Go/"/>
    
    
      <category term="Translate" scheme="https://blog.yuhanle.com/tags/Translate/"/>
    
      <category term="Go" scheme="https://blog.yuhanle.com/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>GCD åŒæ­¥å¼‚æ­¥ä»¥åŠä¸²å¹¶è¡Œè¯¦è§£</title>
    <link href="https://blog.yuhanle.com/2017/05/02/gcd-sync-parallel/"/>
    <id>https://blog.yuhanle.com/2017/05/02/gcd-sync-parallel/</id>
    <published>2017-05-02T00:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.336Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://cdn.yuhanle.com/gcd/wind-surfing-67627_1920.jpg" alt="æµªèµ·æ¥"></p><p>GCDæ˜¯iOSå¼€å‘å¤šçº¿ç¨‹ä¸­ç»å¸¸ä½¿ç”¨çš„æŠ€æœ¯ï¼Œå…ˆçœ‹ä¸€ä¸‹GCDä¸­çš„å¸¸è§çš„æœ¯è¯­<br><a id="more"></a></p><p>æè¿°å¤šä¸ªä»»åŠ¡ä¹‹é—´åŒä¸€æ—¶åˆ»çš„è¿è¡Œå…³ç³»ï¼š</p><ul><li>serialï¼ˆä¸²è¡Œï¼‰ æŸä¸€æ—¶åˆ»ï¼Œåªæ‰§è¡Œä¸€ä¸ªä»»åŠ¡</li><li>concurrentï¼ˆå¹¶è¡Œï¼‰ å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡</li></ul><p>ä¾§é‡æè¿°ä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œå®Œæˆï¼Œå¯¹å…¶ä»–ä»»åŠ¡çš„å½±å“ (æ—¢ æ˜¯å¦ä»»åŠ¡åœ¨ç­‰å¾…æŸä¸ªå‡½æ•°å®Œæˆï¼Œç„¶åæ‰å¯ä»¥è¿è¡Œ)ï¼š</p><ul><li>synchronousï¼ˆåŒæ­¥ï¼‰ ä»»åŠ¡æ‰§è¡Œå®Œæˆåretureï¼Œï¼ˆé˜»å¡ï¼‰</li><li>asynchronousï¼ˆå¼‚æ­¥ï¼‰ ä¸ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œç«‹å³retureï¼Œï¼ˆä¸é˜»å¡å½“å‰ï¼‰</li></ul><p>åœ¨GCDä¸­ï¼Œæˆ‘ä»¬ç”¨ä¸²è¡Œå¹¶è¡Œæè¿°é˜Ÿåˆ—ã€‚è¿™å°±æ˜¯åœ¨æè¿°ï¼Œè¯¥é˜Ÿåˆ—é‡Œé¢çš„æ‰€æœ‰ä»»åŠ¡ï¼Œç›¸äº’ä¹‹é—´åœ¨åŒä¸€æ—¶åˆ»ï¼Œæ˜¯æ€æ ·çš„è¿è¡Œå…³ç³»ã€‚æ˜¯æŒ‡é˜Ÿåˆ—å†…æœ¬èº«çš„ä»»åŠ¡è¿è¡Œé¡ºåºã€‚ </p><p>æˆ‘ä»¬è¿˜ç”¨åŒæ­¥å¼‚æ­¥ï¼Œæè¿°æŸä¸€ä¸ªä»»åŠ¡ã€‚æ¯”å¦‚è¯´ä»»åŠ¡Aæ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚è¿™å°±æ˜¯åœ¨è¯´ï¼ŒAä»»åŠ¡ï¼Œä¼šé˜»å¡å½“å‰ä»»åŠ¡ï¼Œç›´åˆ°Aç»“æŸã€‚è¿™æ˜¯æŒ‡ä¸åŒä»»åŠ¡ä¹‹é—´çš„å…³ç³»ï¼Œä¸é˜Ÿåˆ—æ— å…³ï¼Œå¯ä»¥æ˜¯ä¸åŒé˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸åŒé˜Ÿåˆ—ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ï¼ŒGCDé‡Œé¢çš„ä¸åŒé˜Ÿåˆ—ã€‚</p><h2 id="Serial-Queues"><a href="#Serial-Queues" class="headerlink" title="Serial Queues"></a>Serial Queues</h2><p>åœ¨ä¸²è¡Œé˜Ÿåˆ—é‡Œï¼ŒåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚ä»»åŠ¡æŒ‰ç…§è¢«æ·»åŠ è¿›å…¥é˜Ÿåˆ—çš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚æ¯ä¸€ä¸ªä»»åŠ¡åªæœ‰åœ¨å‰é¢çš„ä»»åŠ¡å®Œæˆåï¼Œæ‰å¯ä»¥å¼€å§‹æ‰§è¡Œã€‚</p><p>ç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„ä¸²è¡Œé˜Ÿåˆ—</p><ul><li>main queue ( dispatch_get_main_queue )</li></ul><p>main queueæ˜¯ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œæœ‰ä¸²è¡Œé˜Ÿåˆ—çš„ä¸€åˆ‡ç‰¹æ€§ã€‚æ¯”è¾ƒç‰¹æ®Šçš„ä¸€ç‚¹æ˜¯åŠ å…¥è¿™ä¸ªé˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œéƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ã€‚</p><h2 id="Concurrent-Queues"><a href="#Concurrent-Queues" class="headerlink" title="Concurrent Queues"></a>Concurrent Queues</h2><p>åŠ å…¥å¹¶è¡Œé˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œæ‰§è¡Œçš„é¡ºåºä¹Ÿæ˜¯æŒ‰ç…§ä»»åŠ¡è¢«åŠ å…¥é˜Ÿåˆ—çš„é¡ºåºæ‰§è¡Œï¼Œè¿™æ˜¯æˆ‘ä»¬å”¯ä¸€å¯ä»¥ä¿è¯çš„ã€‚æ¯ä¸ªä»»åŠ¡éƒ½ä¸ç”¨ç­‰å¾…ä¹‹å‰çš„ä»»åŠ¡å®Œæˆï¼ŒåŒä¸€æ—¶åˆ»å¯ä»¥å¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œã€‚</p><p>ç³»ç»ŸåŒæ ·æœ‰ä¸€ä¸ªå…¨å±€çš„å¹¶å‘é˜Ÿåˆ—</p><ul><li>global dispatch queue ( dispatch_get_global_queue )</li></ul><p>è¿™æ˜¯å¦ä¸€ä¸ªæˆ‘ä»¬ç†Ÿæ‚‰çš„å¹¶å‘é˜Ÿåˆ—ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ç›´æ¥ä½¿ç”¨è¿™ä¸ªé˜Ÿåˆ—ï¼Œå¯ä»¥ç®€å•å¤„ç†ä¸€äº›æˆ‘ä»¬éœ€è¦å¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p><h2 id="Custom-Queue"><a href="#Custom-Queue" class="headerlink" title="Custom Queue"></a>Custom Queue</h2><p>é™¤äº†ç³»ç»Ÿæä¾›çš„å…¨å±€é˜Ÿåˆ—ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ä¸²è¡Œæˆ–è€…å¹¶è¡Œçš„é˜Ÿåˆ—ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t mySerialQueue = dispatch_queue_create(&quot;com.mySerialQueue&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">dispatch_queue_t myConcurrentQueue = dispatch_queue_create(&quot;com.myConcurrentQueue&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯å‡ ç§æˆ‘ä»¬ç”¨GCDæ—¶ï¼Œéœ€è¦ä½¿ç”¨åˆ°çš„é˜Ÿåˆ—ã€‚</p><p>å¦å¤–ï¼Œä½¿ç”¨GCDï¼Œé™¤äº†é€‰æ‹©æ­£ç¡®çš„é˜Ÿåˆ—å¤–ï¼Œè¿˜è¦å…³æ³¨ï¼šæˆ‘ä»¬è¦æ‰§è¡Œçš„ä»»åŠ¡æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œã€‚</p><h2 id="dispatch-async-å¼‚æ­¥æ‰§è¡Œ"><a href="#dispatch-async-å¼‚æ­¥æ‰§è¡Œ" class="headerlink" title="dispatch_async å¼‚æ­¥æ‰§è¡Œ"></a>dispatch_async å¼‚æ­¥æ‰§è¡Œ</h2><p>dispatch_async ç”¨æ¥ç”¨å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œä¸²è¡Œæˆ–è€…å¹¶è¡Œé˜Ÿåˆ—é‡Œé¢çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä½¿ç”¨ dispatch_async çš„å‡ ç§å¸¸è§æƒ…å†µï¼š</p><ul><li>custom Serial Queueï¼šå½“æˆ‘ä»¬éœ€è¦æ‰§è¡Œå‡ ä¸ªåº”è¯¥ä¸²è¡Œæ‰§è¡Œçš„ä»»åŠ¡ï¼Œåˆä¸é˜»å¡å½“å‰çš„æ—¶å€™ã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// task1 task2 é¡ºåºä¾æ¬¡æ‰§è¡Œï¼ŒåŒæ—¶ä¸é˜»å¡others</span><br><span class="line"></span><br><span class="line">dispatch_queue_t mySerialQueue = dispatch_queue_create(&quot;com.mySerialQueue&quot;, NULL);</span><br><span class="line"></span><br><span class="line">dispatch_async(mySerialQueue, ^&#123;</span><br><span class="line">   ...task1</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">dispatch_async(mySerialQueue, ^&#123;</span><br><span class="line">  ...task2</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...others</span><br></pre></td></tr></table></figure><ul><li><p>main Queueï¼šå½“æˆ‘ä»¬æ‰§è¡Œå¹¶å®Œæˆäº†ä¸€æ®µå¼‚æ­¥çš„ä»»åŠ¡ï¼Œéœ€è¦å›åˆ°ä¸»çº¿ç¨‹æ›´æ–°UIçš„æ—¶å€™ï¼Œå¾ˆå¸¸è§çš„é€‰æ‹©å°±æ˜¯ä½¿ç”¨GCDçš„ main queueã€‚</p></li><li><p>custom or global concurrent Queueï¼šè¿™ä¸ªæ˜¯æˆ‘ä»¬æ‰§è¡ŒéUIä»»åŠ¡çš„å¸¸è§é€‰æ‹©ã€‚è¦æ³¨æ„çš„æ˜¯ï¼ŒåŠ å…¥é˜Ÿåˆ—çš„å¤šä¸ªä»»åŠ¡ä¹‹é—´å¹¶å‘æ‰§è¡Œï¼Œæˆ‘ä»¬æ— æ³•çŸ¥é“é‚£ä¸ªä»»åŠ¡å…ˆå®Œæˆã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t myConcurrentQueue = dispatch_queue_create(&quot;com.myConcurrentQueue&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line"></span><br><span class="line">dispatch_async(myConcurrentQueue, ^&#123;</span><br><span class="line">  </span><br><span class="line">  ...task1    </span><br><span class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">          Update UI </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="dispatch-sync-åŒæ­¥æ‰§è¡Œ"><a href="#dispatch-sync-åŒæ­¥æ‰§è¡Œ" class="headerlink" title="dispatch_sync åŒæ­¥æ‰§è¡Œ"></a>dispatch_sync åŒæ­¥æ‰§è¡Œ</h2><p>å¤§éƒ¨åˆ†æ—¶å€™æˆ‘ä»¬æ‰§è¡Œdispatch_syncæ“ä½œï¼Œéƒ½è¦æ ¼å¤–å°å¿ƒäº›ã€‚</p><ul><li>custom or main Serial Queueï¼š åŒæ­¥æ‰§è¡Œä¸²è¡Œé˜Ÿåˆ—æ—¶ï¼Œè¦æ³¨æ„é˜²æ­¢å‘ç”Ÿæ­»é”ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç :</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/ä¸²è¡Œé˜Ÿåˆ—ä¸­ï¼Œtask2 ç­‰å¾… task1å®Œæˆï¼Œæ‰€ä»¥ä¸ä¼šå¼€å§‹ã€‚è€Œtask1åˆå®Œæˆä¸äº†ï¼Œå› ä¸ºtask2è¿˜æ²¡æœ‰æ‰§è¡Œå®Œ(ç”šè‡³éƒ½æ²¡æœ‰å¼€å§‹)ã€‚æ­»é”ã€‚</span><br><span class="line">  </span><br><span class="line">dispatch_queue_t mySerialQueue = dispatch_queue_create(&quot;com.mySerialQueue&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    </span><br><span class="line">dispatch_sync(mySerialQueue, ^&#123;</span><br><span class="line">    </span><br><span class="line">    ...task1</span><br><span class="line">    dispatch_sync(mySerialQueue, ^&#123;</span><br><span class="line">       </span><br><span class="line">       ...task2            </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>concurrent Queueï¼šåˆç†ä½¿ç”¨å¯ä»¥è§£å†³ä¸€äº›å¹¶å‘è¯»å†™é—®é¢˜ã€‚ä¾‹å¦‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//task1 æ‰§è¡Œç»“æŸåï¼Œtask2æ‰ä¼šå¼€å§‹æ‰§è¡Œã€‚</span><br><span class="line">dispatch_queue_t myConcurrentQueue = dispatch_queue_create(&quot;com.myConcurrentQueue&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line"></span><br><span class="line">dispatch_sync(myConcurrentQueue, ^&#123;</span><br><span class="line">    </span><br><span class="line">  ...task1 è¯»</span><br><span class="line">&#125;);</span><br><span class="line">    </span><br><span class="line">dispatch_async(myConcurrentQueue, ^&#123;</span><br><span class="line">    </span><br><span class="line">  ...task2 å†™</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="dispatch-after"><a href="#dispatch-after" class="headerlink" title="dispatch_after"></a>dispatch_after</h2><p>å¼‚æ­¥å»¶è¿Ÿæ“ä½œã€‚å®é™…ä¸Š dispatch_after å°±åƒä¸€ä¸ªå»¶è¿Ÿæ‰§è¡Œçš„ dispatch_asyncã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">double delayInSeconds = 1.0;</span><br><span class="line">dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * NSEC_PER_SEC));</span><br><span class="line"> dispatch_after(popTime, dispatch_get_main_queue(), ^(void)&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://cdn.yuhanle.com/gcd/wind-surfing-67627_1920.jpg&quot; alt=&quot;æµªèµ·æ¥&quot;&gt;&lt;/p&gt;
&lt;p&gt;GCDæ˜¯iOSå¼€å‘å¤šçº¿ç¨‹ä¸­ç»å¸¸ä½¿ç”¨çš„æŠ€æœ¯ï¼Œå…ˆçœ‹ä¸€ä¸‹GCDä¸­çš„å¸¸è§çš„æœ¯è¯­&lt;br&gt;
    
    </summary>
    
      <category term="iOS" scheme="https://blog.yuhanle.com/categories/iOS/"/>
    
    
      <category term="iOS" scheme="https://blog.yuhanle.com/tags/iOS/"/>
    
      <category term="GCD" scheme="https://blog.yuhanle.com/tags/GCD/"/>
    
  </entry>
  
  <entry>
    <title>GCD åŒæ­¥æ“ä½œä¹‹ Resource Competition</title>
    <link href="https://blog.yuhanle.com/2017/04/28/gcd-sync-barriers-groups-semaphore/"/>
    <id>https://blog.yuhanle.com/2017/04/28/gcd-sync-barriers-groups-semaphore/</id>
    <published>2017-04-28T00:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.335Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://cdn.yuhanle.com/gcd/surfer-2212948_1920.jpg" alt="æ›´å¿«æ›´é«˜æ›´å¼º"></p><p>åœ¨å­¦ä¼šç®€å•çš„ä½¿ç”¨GCDå¤„ç†å¤šçº¿ç¨‹ä¹‹åï¼Œæˆ‘ä»¬æ¥å†æ·±å…¥äº†è§£ä¸‹GCDå¯¹å¤šçº¿ç¨‹çš„ä¸€äº›åŒæ­¥æ§åˆ¶ã€‚<br><a id="more"></a></p><h2 id="dispatch-barriers"><a href="#dispatch-barriers" class="headerlink" title="dispatch barriers"></a>dispatch barriers</h2><p>åœ¨ä½¿ç”¨ Concurrent Queue çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›é˜Ÿåˆ—ä¸­çš„æŸé¡¹ä»»åŠ¡ï¼Œèƒ½å¤Ÿè¢«ä¸²è¡Œæ‰§è¡Œï¼Œæ¥é¿å…èµ„æºç«äº‰ç­‰å¤šçº¿ç¨‹é—®é¢˜ã€‚æ¯”å¦‚é‡åˆ°è¯»å†™é—®é¢˜ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ dispatch barriersã€‚æ¥ä¿è¯å³ä½¿åœ¨å¹¶è¡Œé˜Ÿåˆ—ä¸­ï¼Œå¯¹æŸä¸ªå¯¹è±¡çš„è¯»å’Œå†™æ“ä½œï¼Œåœ¨åŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªå¯ä»¥è¢«æ‰§è¡Œã€‚è¿™æ—¶å€™å°±å¯ä»¥ç”¨åˆ° dispatch barriersäº†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹ï¼Œä¸åŒçš„é˜Ÿåˆ—ä¸­barriersçš„ä½¿ç”¨ï¼š</p><ul><li><p>Custom Serial Queue: åœ¨ä¸²è¡Œé˜Ÿåˆ—ä¸­ï¼Œé˜Ÿåˆ—éƒ½æ˜¯é¡ºåºä¸²è¡Œæ‰§è¡Œï¼Œä½¿ç”¨barriersæ²¡æœ‰ä»»ä½•å¥½å¤„ã€‚ä¸€èˆ¬æ¥è®²æˆ‘ä»¬ä¸éœ€è¦è¿™ä¹ˆåšã€‚</p></li><li><p>Global Concurrent Queue: è¿™é‡Œè™½ç„¶æ˜¯å¹¶è¡Œé˜Ÿåˆ—ï¼Œä½†è¿™ä¸ªé˜Ÿåˆ—æ˜¯å…¨å±€çš„ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯åˆ«äººæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªé˜Ÿåˆ—ã€‚å¯¹è¿™ä¸ªé˜Ÿåˆ—åŠ barriersï¼Œå¯èƒ½ä¼šå½±å“åˆ°å…¶ä»–æ¨¡å—çš„åŠŸèƒ½ã€‚æ‰€ä»¥ä¸å»ºè®®åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸­ä½¿ç”¨ã€‚</p></li><li><p>Custom Concurrent Queue: åœ¨è‡ªå®šä¹‰çš„å¹¶è¡Œé˜Ÿåˆ—ä¸­ä½¿ç”¨barriersï¼Œæ˜¯æ¯”è¾ƒåˆé€‚çš„æ–¹å¼ã€‚</p></li></ul><p>æ‰€ä»¥å½“æˆ‘ä»¬è¦åšçš„å¹¶è¡Œæ“ä½œï¼Œå¯èƒ½å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜çš„æ—¶å€™ã€‚æˆ‘ä»¬æœ€å¥½è€ƒè™‘æ–°å»ºè‡ªå®šä¹‰å¹¶è¡Œé˜Ÿåˆ—ï¼Œè€Œä¸æ˜¯ç®€å•åœ°ä½¿ç”¨ç³»ç»Ÿæä¾›çš„ Global Queueã€‚</p><p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æŸä¸€ä¸ªç±»è¦ç®¡ç†MyClassè¿™ä¸ªç±»å‹çš„è¯»å†™ï¼Œä¸‹é¢åˆ—ä¸¾è¿™ä¸ªç±»çš„ä¸€äº›ç›¸å…³æ–¹æ³•:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">//åˆå§‹åŒ–è‡ªå®šä¹‰å¹¶å‘é˜Ÿåˆ—</span><br><span class="line">  - (instancetype)init&#123;</span><br><span class="line">      </span><br><span class="line">      if(self = [super init])&#123;</span><br><span class="line">          customConcurrentQueue = dispatch_queue_create(&quot;com.customConcurrentQueue&quot;, DISPATCH_QUEUE_CONCURRENT); </span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //å†™æ–¹æ³•</span><br><span class="line">  - (void)write:(MyClass *)myClass &#123;</span><br><span class="line">  </span><br><span class="line">      if( myClass )&#123;</span><br><span class="line">          </span><br><span class="line">          //ä½¿ç”¨barrierï¼Œä¿è¯å†™æ–¹æ³•ï¼Œå¯ä»¥ä¸²è¡Œæ‰§è¡Œ</span><br><span class="line">            dispatch_barrier_async(self.customConcurrentQueue, ^&#123; </span><br><span class="line">              </span><br><span class="line">              //å†™æ“ä½œ</span><br><span class="line">              ...</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //è¯»æ–¹æ³•</span><br><span class="line">  - (MyClass *)read&#123;</span><br><span class="line">      </span><br><span class="line">      //è¦ä¿è¯ï¼Œè¯»å’Œå†™æ–¹æ³•ä¸èƒ½åŒæ—¶æ‰§è¡Œï¼Œ</span><br><span class="line">      //é¦–å…ˆï¼Œä»–ä»¬è¦åœ¨åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­ ï¼šself.customConcurrentQueue</span><br><span class="line">      //å…¶æ¬¡ï¼Œè¯»æ–¹æ³•è¦ç­‰å¾…è¯»å‡ºæ•°æ®åè¿”å›ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯åŒæ­¥æ“ä½œ ï¼šdispatch_sync</span><br><span class="line">      </span><br><span class="line">      __block MyClass *myClass = [[MyClass alloc] init];</span><br><span class="line">      </span><br><span class="line">      dispatch_sync(self.customConcurrentQueue, ^&#123;</span><br><span class="line">      </span><br><span class="line">          //è¯»æ“ä½œ</span><br><span class="line">          myClass = ...</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      return myClass;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="dispatch-groups"><a href="#dispatch-groups" class="headerlink" title="dispatch groups"></a>dispatch groups</h2><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¤šä¸ªå¹¶è¡Œä»»åŠ¡å…¨éƒ¨å®Œæˆåï¼Œåšä¸€äº›æ“ä½œï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ° groupæ¥ç®¡ç†äº†ã€‚</p><p>ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚æˆ‘æœ‰4ä¸ªä»»åŠ¡è¦ä½¿ç”¨å¹¶å‘å¤„ç†ï¼Œä»»åŠ¡4è¦ç­‰å¾…ï¼Œä»»åŠ¡1ã€2ã€3å®Œæˆåæ‰§è¡Œã€‚åŒæ—¶ï¼Œä»»åŠ¡4ä¸é˜»å¡å½“å‰çš„çº¿ç¨‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">- (void)testDispatchGroup&#123;</span><br><span class="line"></span><br><span class="line">  dispatch_queue_t concurrentQueue = dispatch_queue_create(&quot;com.test.testConcurrent&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line"></span><br><span class="line">  dispatch_group_t group = dispatch_group_create();</span><br><span class="line"></span><br><span class="line">  //å¼‚æ­¥æ“ä½œ</span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">         </span><br><span class="line">      ä»»åŠ¡1</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">         </span><br><span class="line">      ä»»åŠ¡2</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">         </span><br><span class="line">      ä»»åŠ¡3</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  //dispatch_group_notify ä¸­çš„blockæ‰§è¡Œçš„æ˜¯æˆ‘ä»¬æœ€åè¦åšçš„ä»»åŠ¡ã€‚åŒæ—¶ï¼Œè¿™é‡Œæ˜¯å¼‚æ­¥æ“ä½œï¼Œä¸ä¼šé˜»å¡åé¢å…¶ä»–ä»£ç çš„æ‰§è¡Œã€‚</span><br><span class="line">  dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</span><br><span class="line">      </span><br><span class="line">      //å‰é¢3ä¸ªä»»åŠ¡ï¼Œéƒ½æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œé‡Œé¢çš„block</span><br><span class="line">      ä»»åŠ¡4</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†çœ‹å¦ä¸€ä¸ªéœ€æ±‚ï¼Œè¿˜æ˜¯ä¹‹å‰çš„4ä¸ªä»»åŠ¡ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œä»»åŠ¡4é™¤äº†è¦ç­‰å¾…å…¶ä»–ä»»åŠ¡å®Œæˆï¼Œè¿˜è¦é˜»å¡å½“å‰çº¿ç¨‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (void)testDispatchGroup&#123;</span><br><span class="line"></span><br><span class="line">  dispatch_group_t group = dispatch_group_create();</span><br><span class="line"></span><br><span class="line">  //å¼‚æ­¥æ“ä½œ</span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">         </span><br><span class="line">      ä»»åŠ¡1</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">         </span><br><span class="line">      ä»»åŠ¡2</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">         </span><br><span class="line">      ä»»åŠ¡3</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  //dispatch_group_wait ç­‰å¾…ä¸Šé¢ä»»åŠ¡å…¨éƒ¨å®Œæˆï¼Œé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°è¶…è¿‡è®¾ç½®çš„æ—¶é—´</span><br><span class="line">  //ä½¿ç”¨æ—¶ï¼Œè¦æ³¨æ„é¿å…é˜»å¡ä¸»çº¿ç¨‹ç­‰é—®é¢˜</span><br><span class="line">  dispatch_group_wait(group, DISPATCH_TIME_FOREVER);</span><br><span class="line">  </span><br><span class="line">  ä»»åŠ¡4</span><br><span class="line">  </span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œé™¤äº†ä½¿ç”¨<code>dispatch_group_async</code>ç®¡ç†è¦åšçš„ä»»åŠ¡ã€‚è¿˜å¯ä»¥ä½¿ç”¨<code>dispatch_group_enter</code>ã€ <code>dispatch_group_leave</code> ç»„åˆçš„æ–¹å¼ï¼Œæ‰‹åŠ¨é€šçŸ¥ä»»åŠ¡å®Œæˆã€‚å¦‚æœä½¿ç”¨æ‰‹åŠ¨ç®¡ç†çš„è¯ï¼Œæˆ‘ä»¬è¦æ³¨æ„ï¼š<code>enter</code>å’Œ<code>leave</code>æ–¹æ³•ï¼Œåº”è¯¥æ˜¯æˆå¯¹å‡ºç°çš„ã€‚</p><p>dispatch_group_enter(customGroup) : æ‰‹åŠ¨å‘ŠçŸ¥customGroupï¼Œè¡¨ç¤ºä¸€ä¸ªä»»åŠ¡å·²ç»å¼€å§‹æ‰§è¡Œã€‚</p><p>dispatch_group_leave(customGroup) : æ‰‹åŠ¨å‘ŠçŸ¥<code>customGroup</code>ï¼Œè¡¨ç¤ºä¸€ä¸ªä»»åŠ¡å·²ç»å®Œæˆã€‚å½“æ‰€æœ‰<code>enter</code>å¯¹åº”çš„<code>leave</code>æ–¹æ³•éƒ½æ‰§è¡Œè¿‡åã€‚æˆ‘ä»¬çš„<code>dispatch_group_notify()</code>æˆ–è€…<code>dispatch_group_wait()</code>ï¼Œå°±å¯ä»¥æ¥åˆ°ä»»åŠ¡å®Œæˆçš„é€šçŸ¥ã€‚</p><h2 id="dispatch-semaphore-ä¿¡å·é‡"><a href="#dispatch-semaphore-ä¿¡å·é‡" class="headerlink" title="dispatch semaphore ä¿¡å·é‡"></a>dispatch semaphore ä¿¡å·é‡</h2><p>å½“æœ‰å¤šä¸ªæ¶ˆè´¹è€…ï¼Œè®¿é—®æœ‰é™çš„èµ„æºçš„æ—¶å€™ï¼Œ<a href="https://en.wikipedia.org/wiki/Semaphore_(programming" target="_blank" rel="noopener">ä¿¡å·é‡</a>) å¯ä»¥è®©æˆ‘ä»¬æ›´å¥½çš„æ§åˆ¶ã€‚ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹ä¿¡å·ä¸ªæ•°çš„æ§åˆ¶ï¼Œæ¥è¾¾åˆ°çº¿ç¨‹é—´çš„åŒæ­¥æ“ä½œã€‚å½“ä¿¡å·ä¸ªæ•°ä¸º0çš„æ—¶å€™ï¼Œå½“å‰çº¿ç¨‹è¢«é˜»å¡ï¼Œç­‰å¾…ä¿¡å·é‡å¢åŠ ï¼Œå½“ä¿¡å·é‡ä¸ªæ•°å¤§äº0çš„æ—¶å€™ï¼Œåˆ™çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚</p><p>æ³¨æ„ï¼ŒåŒæ­¥çš„æ“ä½œéƒ½è¦å°å¿ƒä½¿ç”¨ï¼Œé¿å…æ­»é”ç­‰é—®é¢˜ã€‚</p><p>å¦å¤–ï¼Œæ ¹æ®dispatch_semaphore_waitçš„è¿”å›å€¼ï¼Œå¯ä»¥ç”¨äºåˆ¤æ–­æŸä»»åŠ¡æ˜¯å¦è¶…æ—¶æ“ä½œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">- (void)testSemaphore&#123;</span><br><span class="line"></span><br><span class="line">  //åˆ›å»º ä¿¡å·é‡ å‚æ•°ä»£è¡¨åˆå§‹ä¸ªæ•°</span><br><span class="line">  dispatch_semaphore_t semaphore = dispatch_semaphore_create(0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  dispatch_async(concurrentQueue, ^&#123;</span><br><span class="line">  </span><br><span class="line">      sleep(2);</span><br><span class="line">  </span><br><span class="line">      //å‘é€ä¸€ä¸ªä¿¡å·ï¼Œä¿¡å·é‡ä¸ªæ•° +1   </span><br><span class="line">      dispatch_semaphore_signal(semaphore);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  dispatch_async(concurrentQueue, ^&#123;</span><br><span class="line">  </span><br><span class="line">      dispatch_time_t timeoutTime = dispatch_time(DISPATCH_TIME_NOW, 1 * NSEC_PER_SEC);</span><br><span class="line">  </span><br><span class="line">      //çº¿ç¨‹ç­‰å¾…ï¼Œå½“ä¿¡å·é‡å¤§äº0æ—¶ ä»»åŠ¡ç»§ç»­æ‰§è¡Œï¼Œä¿¡å·é‡ -1</span><br><span class="line">      //çº¿ç¨‹ç­‰å¾…ï¼Œè¶…è¿‡é¢„å®šçš„è¶…æ—¶æ—¶é—´ ä»»åŠ¡ç»§ç»­æ‰§è¡Œ ä¿¡å·é‡ä¸å˜</span><br><span class="line">      //å…³äºè¿”å›å€¼ï¼šå½“è¿”å›å€¼ ä¸ä¸º0 çš„æ—¶å€™ï¼Œè¯´æ˜è¶…æ—¶</span><br><span class="line">      if( dispatch_semaphore_wait(semaphore, timeoutTime) )&#123;</span><br><span class="line">          NSLog(@&quot;time out&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://cdn.yuhanle.com/gcd/surfer-2212948_1920.jpg&quot; alt=&quot;æ›´å¿«æ›´é«˜æ›´å¼º&quot;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å­¦ä¼šç®€å•çš„ä½¿ç”¨GCDå¤„ç†å¤šçº¿ç¨‹ä¹‹åï¼Œæˆ‘ä»¬æ¥å†æ·±å…¥äº†è§£ä¸‹GCDå¯¹å¤šçº¿ç¨‹çš„ä¸€äº›åŒæ­¥æ§åˆ¶ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="iOS" scheme="https://blog.yuhanle.com/categories/iOS/"/>
    
    
      <category term="iOS" scheme="https://blog.yuhanle.com/tags/iOS/"/>
    
      <category term="GCD" scheme="https://blog.yuhanle.com/tags/GCD/"/>
    
  </entry>
  
  <entry>
    <title>ç¦»å¼€è±¡ç‰™å¡”ä»¥å</title>
    <link href="https://blog.yuhanle.com/2017/04/18/say-hello-work/"/>
    <id>https://blog.yuhanle.com/2017/04/18/say-hello-work/</id>
    <published>2017-04-18T00:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.339Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://cdn.yuhanle.com/nenshuocijun/architecture-768432_1920.jpg" alt="ç¦»å¼€è±¡ç‰™å¡”ä»¥å"></p><p>å­¦æ ¡å‡ºæ¥æœ‰å¾ˆå¤šåŒºåˆ«ï¼Œå…¶ä¸­æœ‰ä¸€ç‚¹æ˜¯æœ€æ— èŠçš„ã€‚</p><a id="more"></a><p>ç”±è¿‡å»çš„ä¸‰ç‚¹ä¸€çº¿ï¼Œè½¬å˜æˆä¸¤ç‚¹ä¸€çº¿ï¼Œæ²¡äº†æ•™å®¤ï¼Œæ²¡äº†é£Ÿå ‚ï¼Œå˜æˆäº†å…¬å¸å’Œå®¿èˆã€‚</p><p>æ²¡æœ‰è®¤çœŸæ•°è¿‡ï¼Œå¹³å‡æ¯å¤©ï¼Œåœ¨åŒä¸€æ¡è·¯ä¸Šæ¥å›ï¼Œå°†è¿‘ä¸‰å¹´ï¼Œç£¨å¹³äº†å‡ åŒé‹å­ï¼Œæ“¦ç¢°è¿‡å¤šå°‘æ¬¡è·¯è¾¹çš„æ§æ ‘ã€‚</p><p>å‡ºäº†åœ°é“ç«™ï¼Œæœ‰ä¸€ä¸ªçº¢ç»¿ç¯è·¯å£ï¼Œå…«ç‚¹åŠé’Ÿæ˜¯é«˜å³°æœŸï¼Œäººæ­£å¤šï¼Œå¾ˆå¤šäººè¿«ä¸åŠå¾…ï¼Œè¶ç€è½¦æ¥è½¦å¾€ï¼Œè¿…é€Ÿçš„çªœåˆ°å¯¹é¢ï¼Œæ€¥åŒ†åŒ†åœ°æ¶ˆå¤±åœ¨è§†çº¿é‡Œã€‚</p><p>ä¹ æƒ¯è¿‡äº†é©¬è·¯ï¼Œç©¿è¿‡åœè½¦åœºï¼Œå› ä¸ºè·¯è¾¹çš„å°è·¯å¾ˆçª„ï¼Œå¦‚æœå¯¹é¢åŒæ—¶èµ°è¿‡æ¥ä¸€ä¸ªäººï¼Œå°±éœ€è¦ç›¸äº’ä¾§èº«ï¼Œå°±åƒé‚£ç¯‡é›¨å··ï¼Œä¹Ÿç»å¸¸çš„ä¸å°å¿ƒè¸©åˆ°çŸ³å‘ï¼Œæ±¡æ³¥æº…åˆ°å¦ä¸€åŒé‹å­ã€‚</p><p>åœè½¦åœºé‡Œèµ°ç€ï¼Œå¾ˆå±é™©ï¼Œå¯èƒ½æ­£åœ¨ç©æ‰‹æœºï¼Œæˆ‘æ²¡æ³¨æ„ã€‚æœ‰ä¸€æ¬¡ï¼Œæœ‰ä½å¥³å£«ï¼Œä½ç€å¤´èµ°ç€èµ°ç€ï¼Œç©¿è¿‡åœè½¦æ†ï¼Œæ²¡æƒ³åˆ°åœè½¦æ†å½“æ—¶æ­£åœ¨ä¸‹è½ï¼Œæˆ‘èƒ½å¬åˆ°æ•²å‡»å¤´éƒ¨çš„å£°éŸ³ï¼Œå¾ˆè„†ï¼Œæ¥ç€å°±æ˜¯æ­‡æ–¯åº•é‡Œçš„å—·å«ã€‚</p><p>è·¯è¾¹æœ‰ä¸ªå¿«å®¢ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºä»–æ˜¯å‡çš„å¿«å®¢ï¼Œåœ¨æˆ‘å°è±¡ä¸­ï¼Œè¿™ä¸ªåå­—ä¸åº”è¯¥æ˜¯æ„Ÿå†’è¯å—ï¼Ÿå¾ˆå°‘å»å…‰é¡¾è¿™å®¶ä¾¿åˆ©åº—ï¼Œå› ä¸ºä¸œè¥¿å°‘ï¼Œä¸åˆå£å‘³ï¼Œè¿˜ç‰¹åˆ«çš„è´µï¼Œé™¤äº†æ—©é¤ï¼Œè¿˜æœ‰åˆé¥­ï¼Œé›¶é£Ÿï¼Œå¦‚æœæ—¶é—´æ¥å¾—åŠï¼Œæˆ‘ä¼šå»é‚£å®¶ç½—æ£®ä¹°æ¯æ°¸å’Œè±†æµ†ï¼Œè™½ç„¶å–èµ·æ¥æ²¡æœ‰å¤§è±†çš„å‘³é“ï¼Œä½†è¿˜è›®åˆå£å‘³ï¼Œç‰¹åˆ«æ˜¯å†¬å¤©ï¼Œè·¯ä¸Šé¡ºä¾¿æš–æš–æ‰‹ã€‚</p><p>åŠå…¬æ¥¼é‡Œçš„ç”µæ¢¯ï¼Œå·¥ä½œæ—¥ä¸Šç­æ—¶é—´ï¼Œæˆ‘æ²¡æœ‰ä¹˜è¿‡ã€‚å°±åœ¨äº”æ¥¼ï¼Œé—­ç€çœ¼æˆ‘éƒ½æ‘¸ä¸Šå»äº†ï¼Œå¹³æ—¥é‡Œå¹å˜˜ç€é”»ç‚¼èº«ä½“ï¼Œè¦å‡è‚¥ï¼Œè¿™ä¹Ÿæ˜¯å”¯ä¸€èƒ½å¤ŸåšæŒä¸‹å»ï¼Œé”»ç‚¼çš„æ–¹å¼äº†ã€‚</p><p>å¾ˆæƒ³å¿µï¼Œä¸¤å¹´å‰æ¯å¤©æ¥å›éª‘è¡Œ20å…¬é‡Œçš„æ—¥å­ï¼Œèº«ä½“æ˜¯å¥½äº†äº›ï¼Œè…¿è¶Šæ¥è¶Šç²—ï¼Œè¶Šæœ‰åŠ›ï¼Œå‡Œæ™¨ä¸¤ç‚¹çš„è·¯ä¸Šï¼Œè¿ç€é£ï¼Œéª‘åœ¨å¿«è½¦é“ä¸Šï¼Œè‚šå­é¥¿çš„è¯å°±åœ¨è·¯è¾¹åƒç‚¹è·¯è¾¹æ‘Šã€‚æ‘Šä¸»ä»¬å‡ºæ¥çš„å¾ˆæ™šï¼Œä»¥è‡³äºæˆ‘çš„å¾ˆå¤šæœ‹å‹éƒ½è¯´æ²¡è§è¿‡è·¯è¾¹æ‘Šï¼Œä¹Ÿè®¸æ˜¯ä¸Šæµ·æ•´æ²»çš„å¾ˆä¸¥æ ¼å§ï¼</p><p>ä¸ç®¡è¿™ä¸€å¤©ï¼Œå¦‚ä½•å¦‚ä½•ï¼Œä¹Ÿä¸ä¼šå½±å“æ–°çš„ä¸€å¤©ã€‚</p><p>æˆ–è®¸ï¼Œåªæœ‰æ¸…ååŒ—å¤§æ‰èƒ½ç§°ä¹‹ä¸ºè±¡ç‰™å¡”å§ï¼Ÿ</p><hr><p>é¢˜å›¾ï¼šaobahorse ä¸è¦æ±‚ç½²å</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://cdn.yuhanle.com/nenshuocijun/architecture-768432_1920.jpg&quot; alt=&quot;ç¦»å¼€è±¡ç‰™å¡”ä»¥å&quot;&gt;&lt;/p&gt;
&lt;p&gt;å­¦æ ¡å‡ºæ¥æœ‰å¾ˆå¤šåŒºåˆ«ï¼Œå…¶ä¸­æœ‰ä¸€ç‚¹æ˜¯æœ€æ— èŠçš„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="suibi" scheme="https://blog.yuhanle.com/categories/suibi/"/>
    
    
      <category term="motion" scheme="https://blog.yuhanle.com/tags/motion/"/>
    
  </entry>
  
  <entry>
    <title>é€šè¿‡Sonar åˆæ­¥æ„å»ºä»£ç æŒç»­å®¡æŸ¥</title>
    <link href="https://blog.yuhanle.com/2017/02/15/continuous-code-quality-sonarqube-install/"/>
    <id>https://blog.yuhanle.com/2017/02/15/continuous-code-quality-sonarqube-install/</id>
    <published>2017-02-15T00:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.334Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/Benefits-of-Using-SonarQube-For-Code-Reviews.jpg" alt="SonarQube"></p><h2 id="ä»‹ç»ç¯‡"><a href="#ä»‹ç»ç¯‡" class="headerlink" title="ä»‹ç»ç¯‡"></a>ä»‹ç»ç¯‡</h2><h3 id="SonarQube-ä»‹ç»"><a href="#SonarQube-ä»‹ç»" class="headerlink" title="SonarQube ä»‹ç»"></a>SonarQube ä»‹ç»</h3><p><a href="https://www.sonarqube.org/" target="_blank" rel="noopener">SonarQube</a> æ˜¯ä¸€æ¬¾é¢†å…ˆçš„æŒç»­ä»£ç è´¨é‡ç›‘æ§å¹³å°ï¼Œå¼€æºåœ¨github ä¸Šï¼Œç°åœ¨å·²æ›´æ–°åˆ°6.2 ç‰ˆæœ¬ï¼Œstar æ•°é‡è¶…è¿‡ 1400+ï¼Œå¯ä»¥è½»æ¾é…ç½®åœ¨å†…ç½‘æœåŠ¡å™¨ï¼Œå®æ—¶ç›‘æ§ä»£ç ï¼Œå¸®åŠ©äº†è§£æå‡æå‡å›¢é˜Ÿé¡¹ç›®ä»£ç è´¨é‡ã€‚é€šè¿‡æ’ä»¶æœºåˆ¶ï¼ŒSonarQubeå¯ä»¥ç»§æ‰¿ä¸åŒçš„æµ‹è¯•å·¥å…·ï¼Œä»£ç åˆ†æå·¥å…·ï¼Œä»¥åŠæŒç»­é›†æˆå·¥å…·ã€‚</p><a id="more"></a><p>ä¸æŒç»­é›†æˆå·¥å…·ï¼ˆä¾‹å¦‚ Hudson/Jenkins ç­‰ï¼‰ä¸åŒï¼ŒSonarQube å¹¶ä¸æ˜¯ç®€å•åœ°æŠŠä¸åŒçš„ä»£ç æ£€æŸ¥å·¥å…·ç»“æœï¼ˆä¾‹å¦‚ FindBugsï¼ŒPMD ç­‰ï¼‰ç›´æ¥æ˜¾ç¤ºåœ¨ Web é¡µé¢ä¸Šï¼Œè€Œæ˜¯é€šè¿‡ä¸åŒçš„æ’ä»¶å¯¹è¿™äº›ç»“æœè¿›è¡Œå†åŠ å·¥å¤„ç†ï¼Œé€šè¿‡é‡åŒ–çš„æ–¹å¼åº¦é‡ä»£ç è´¨é‡çš„å˜åŒ–ï¼Œä»è€Œå¯ä»¥æ–¹ä¾¿åœ°å¯¹ä¸åŒè§„æ¨¡å’Œç§ç±»çš„å·¥ç¨‹è¿›è¡Œä»£ç è´¨é‡ç®¡ç†ã€‚</p><p>åœ¨å¯¹å…¶ä»–å·¥å…·çš„æ”¯æŒæ–¹é¢ï¼ŒSonar ä¸ä»…æä¾›äº†å¯¹ IDE çš„æ”¯æŒï¼Œå¯ä»¥åœ¨ Eclipse å’Œ IntelliJ IDEA è¿™äº›å·¥å…·é‡Œè”æœºæŸ¥çœ‹ç»“æœï¼›åŒæ—¶ SonarQube è¿˜å¯¹å¤§é‡çš„æŒç»­é›†æˆå·¥å…·æä¾›äº†æ¥å£æ”¯æŒï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨æŒç»­é›†æˆä¸­ä½¿ç”¨ SonarQubeã€‚</p><p>æ­¤å¤–ï¼ŒSonarQube çš„æ’ä»¶è¿˜å¯ä»¥å¯¹ Java ä»¥å¤–çš„å…¶ä»–ç¼–ç¨‹è¯­è¨€æä¾›æ”¯æŒï¼Œå¯¹å›½é™…åŒ–ä»¥åŠæŠ¥å‘Šæ–‡æ¡£åŒ–ä¹Ÿæœ‰è‰¯å¥½çš„æ”¯æŒã€‚</p><p>è¡Œä¸šå†…æåˆ°â€ä»£ç è´¨é‡ç®¡ç†, è‡ªåŠ¨åŒ–è´¨é‡ç®¡ç†â€, ä¸€èˆ¬æŒ‡çš„éƒ½æ˜¯é€šè¿‡Sonaræ¥å®ç°ã€‚æœ¬æ–‡çš„ç›®æ ‡æ˜¯å®ç°åœ¨Sonarä¸Šæ˜¾ç¤ºå‡ºiOSé¡¹ç›®, å…ˆçœ‹å¼ æœ€ç»ˆçš„æ•ˆæœå›¾:</p><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/main-des.png" alt="SonarQube"></p><p>ç”¨Sonarèƒ½å¤Ÿå®ç°ä»€ä¹ˆ?</p><ul><li>æŠ€æœ¯å€ºåŠ¡(sonaræ ¹æ®â€è§„åˆ™â€æ‰«æå‡ºä¸ç¬¦åˆè§„åˆ™çš„ä»£ç )</li><li>è¦†ç›–ç‡(å•å…ƒæµ‹è¯•è¦†ç›–ç‡)</li><li>é‡å¤(é‡å¤çš„ä»£ç , æœ‰åˆ©äºæé†’å°è£…)</li><li>ç»“æ„</li></ul><p>é—®é¢˜1: â€œè§„åˆ™â€æŒ‡çš„æ˜¯ä»€ä¹ˆ? </p><pre><code>åœ¨Sonarå·¥å…·ä¸­é…ç½®æ£€æµ‹å·¥å…·(è§„åˆ™), ç„¶åsonaræ ¹æ®è§„åˆ™æ£€æµ‹&quot;è´¨é‡æŠ¥å‘Šæ–‡ä»¶&quot;, å¾—å‡ºé—®é¢˜æ•°ç›®ã€‚ æ¯”å¦‚æœ¬æ–‡é…ç½®çš„è§„åˆ™æ˜¯OCLint</code></pre><p>é—®é¢˜2: æŠ€æœ¯å€ºåŠ¡çš„å¤©æ•°æ€ä¹ˆå¾—å‡º?</p><pre><code>æ¯ä¸ªè§„åˆ™éƒ½æœ‰å¯¹åº”çš„å¤„ç†æ—¶é—´, æœ€å:é—®é¢˜ç±»å‹1æ•°ç›® * å¯¹åº”æ—¶é—´ + é—®é¢˜ç±»å‹2æ•°ç›® * å¯¹åº”æ—¶é—´ +... å¾—åˆ°æ—¶é—´ã€‚</code></pre><h3 id="SonarQube-å·¥ä½œæµç¨‹"><a href="#SonarQube-å·¥ä½œæµç¨‹" class="headerlink" title="SonarQube å·¥ä½œæµç¨‹"></a>SonarQube å·¥ä½œæµç¨‹</h3><p>SonarQube å¹¶ä¸æ˜¯ç®€å•åœ°å°†å„ç§è´¨é‡æ£€æµ‹å·¥å…·çš„ç»“æœï¼ˆä¾‹å¦‚ FindBugsï¼ŒPMD ç­‰ï¼‰ç›´æ¥å±•ç°ç»™å®¢æˆ·ï¼Œè€Œæ˜¯é€šè¿‡ä¸åŒçš„æ’ä»¶ç®—æ³•æ¥å¯¹è¿™äº›ç»“æœè¿›è¡Œå†åŠ å·¥ï¼Œæœ€ç»ˆä»¥é‡åŒ–çš„æ–¹å¼æ¥è¡¡é‡ä»£ç è´¨é‡ï¼Œä»è€Œæ–¹ä¾¿åœ°å¯¹ä¸åŒè§„æ¨¡å’Œç§ç±»çš„å·¥ç¨‹è¿›è¡Œç›¸åº”çš„ä»£ç è´¨é‡ç®¡ç†ã€‚</p><p>SonarQube åœ¨è¿›è¡Œä»£ç è´¨é‡ç®¡ç†æ—¶ï¼Œä¼šä»å›¾ 1 æ‰€ç¤ºçš„ä¸ƒä¸ªçº¬åº¦æ¥åˆ†æé¡¹ç›®çš„è´¨é‡ã€‚</p><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/image001.png" alt="å›¾ 1"></p><p>SonarQube ä¸æ˜¯é‚£ç§å®‰è£…å³å¯ç”¨çš„å·¥å…·ï¼Œä»–éœ€è¦æ•°æ®åº“çš„æ”¯æŒï¼Œç”¨äºå­˜å‚¨æ£€æµ‹é¡¹ç›®åçš„åˆ†ææ•°æ®ï¼ŒåŒæ—¶ä¸ºäº†å®ç°å¯æŒç»­ç›‘æµ‹ï¼Œè¿˜éœ€è¦é¡¹ç›®æŒç»­é›†æˆå·¥å…·ï¼ˆå¦‚Jenkinsï¼‰çš„æ”¯æŒï¼Œåœ¨æ„å»ºç‰ˆæœ¬å‰ï¼Œé€šè¿‡Jenkins+Sonar æ’ä»¶æ‰§è¡Œé¡¹ç›®åˆ†ææŒ‡ä»¤ï¼Œæœ€ç»ˆçš„ç»“æœä¼šé€šè¿‡SonarQube æœåŠ¡å™¨çš„Web é¡µé¢å±•ç¤ºã€‚</p><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/image4.png" alt="ç½‘ç»œå›¾"></p><p>ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡mysql+Jenkins+SonarQube å®ç°é¡¹ç›®ä»£ç è´¨é‡çš„å¯æŒç»­ç›‘æµ‹</p><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/SQ55Integration.png" alt></p><h2 id="å®‰è£…ç¯‡"><a href="#å®‰è£…ç¯‡" class="headerlink" title="å®‰è£…ç¯‡"></a>å®‰è£…ç¯‡</h2><h3 id="SonarQube-çš„å®‰è£…"><a href="#SonarQube-çš„å®‰è£…" class="headerlink" title="SonarQube çš„å®‰è£…"></a>SonarQube çš„å®‰è£…</h3><h4 id="æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹"><a href="#æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹" class="headerlink" title="æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹"></a>æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹</h4><ul><li>XCToolå·¥å…·</li><li>OClintå·¥å…·</li><li>Gcovrå·¥å…·</li><li>Git, SVNå‘½ä»¤</li><li>Linux å‘½ä»¤</li><li>mysql æ“ä½œ</li><li>Jenkinså·¥å…·</li><li>Sonarå·¥å…·</li><li>Shellè¯­æ³•</li><li>Sonar-runnerå·¥å…·</li></ul><h4 id="è½¯ä»¶åŠç¡¬ä»¶çš„è¦æ±‚"><a href="#è½¯ä»¶åŠç¡¬ä»¶çš„è¦æ±‚" class="headerlink" title="è½¯ä»¶åŠç¡¬ä»¶çš„è¦æ±‚"></a>è½¯ä»¶åŠç¡¬ä»¶çš„è¦æ±‚</h4><p>SonarQube çš„å®‰è£…é€šå¸¸éœ€è¦æ»¡è¶³ä¸€å®šçš„è½¯ç¡¬ä»¶æ¡ä»¶ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol><li><p>Server è¦æ±‚</p><p> Web server æœ€å°‘éœ€è¦ 500MB çš„å†…å­˜ç©ºé—´ï¼Œæ¨èå†…å­˜ç©ºé—´å¤§å° 2GBã€‚Sonar åœ¨è¿›è¡Œä»£ç è´¨é‡åˆ†ææ—¶ï¼Œé€šå¸¸å¤§çº¦æ¯ 1 KLOC éœ€è¦å­˜å‚¨ 350KB å·¦å³çš„æ•°æ®ï¼Œæ‰€ä»¥è¦å°½é‡ä¸º SonarQube çš„ web server æä¾›å¤§çš„å†…å­˜ã€‚</p></li><li><p>Database è¦æ±‚</p><p> å°½ç®¡ SonarQube æœ¬èº«è‡ªå¸¦åµŒå…¥çš„ Derby æ•°æ®åº“ï¼Œä½†æ˜¯ç”±äº Derby æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¼ºçƒˆæ¨èå®‰è£…ç›¸åº”çš„ä¼ä¸šç‰ˆæ•°æ®åº“ï¼ŒSonarQube æ”¯æŒçš„æ•°æ®åº“åŒ…æ‹¬ï¼š MySQL 5.x+ã€Oracle10g+ã€PostgreSQL 9.x å’Œ MS SQLServer 2005 and 2008ï¼Œæ¨èä½¿ç”¨ MySQLã€‚</p></li><li><p>Browser è¦æ±‚</p><p> SonarQube æ”¯æŒå¤§å¤šæ•°çš„æµè§ˆå™¨ï¼ŒåŒ…æ‹¬ Firefoxã€Internet Explorer 7.x and 8.x and chromed ç­‰ï¼Œæ¨èä½¿ç”¨ chromedã€‚</p><p> <del>ç›®å‰å®˜æ–¹æœ€æ–°çš„ç‰ˆæœ¬æ˜¯6.2ï¼Œä½†æ˜¯å¯¹äºéƒ¨åˆ†æ’ä»¶ä¼šå­˜åœ¨ä¸å…¼å®¹çš„é—®é¢˜ï¼Œå¯¼è‡´Sonar æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæ‰€ä»¥ä¸ºäº†ä½¿ç”¨å’Œæ¼”ç¤ºï¼Œæˆ‘é‡‡ç”¨äº†æ—§ç‰ˆæœ¬4.5.7ï¼Œå› ä¸ºæ­¤ç‰ˆæœ¬å…¼å®¹ sonar-objective-c-plugin-0.3.1 æ’ä»¶ã€‚</del></p><p> <strong>æ›´æ–°ï¼š</strong></p><p> å…³äºXCode8çš„å…¼å®¹æ–¹æ¡ˆ, è¯·çœ‹<a href="https://my.oschina.net/ChenTF/blog/806565" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a></p></li></ol><h4 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h4><ol><li><p>æ•°æ®åº“é…ç½®</p><p> è¿›å…¥æ•°æ®åº“å‘½ä»¤æ¨¡å¼æˆ–è€…ç›´æ¥ä½¿ç”¨GUI å·¥å…·ï¼Œåˆ›å»ºSonar-Qube æœåŠ¡æ‰€éœ€çš„æ•°æ®åº“</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">mysql&gt; CREATE DATABASE sonar CHARACTER SET utf8 COLLATE utf8_general_ci; </span><br><span class="line">mysql&gt; CREATE USER &apos;sonar&apos; IDENTIFIED BY &apos;sonar&apos;;</span><br><span class="line">mysql&gt; GRANT ALL ON sonar.* TO &apos;sonar&apos;@&apos;%&apos; IDENTIFIED BY &apos;sonar&apos;;</span><br><span class="line">mysql&gt; GRANT ALL ON sonar.* TO &apos;sonar&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;sonar&apos;;</span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><p> <img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/init-sql.png" alt="åˆ›å»ºæ•°æ®åº“"></p><p> å®Œæˆä»¥åæµ‹è¯•ä¸€ä¸‹è¿æ¥æ˜¯å¦æ­£ç¡®</p></li><li><p>å®‰è£…SonarQube ä¸SonarQube-Runner</p><p> SonarQube Runner 2.4 <a href="https://docs.sonarqube.org/display/SONARQUBE45/Installing+and+Configuring+SonarQube+Runner" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a></p><p> ä»å®˜ç½‘ä¸‹è½½ SonarQube çš„æœ€æ–°ç‰ˆæœ¬å¹¶è§£å‹åˆ°<code>/usr/local/</code>æ–‡ä»¶å¤¹    </p><p> <img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/sonar-install-2.png" alt="SonarQube"></p><p> æ·»åŠ SONAR_HOMEã€SONAR_RUNNER_HOME ç¯å¢ƒå˜é‡ï¼Œå¹¶å°†SONAR_RUNNER_HOME åŠ å…¥PATH</p></li><li><p>ä¿®æ”¹Sonar-Qube é…ç½®æ–‡ä»¶</p><p> é…ç½®æ–‡ä»¶è·¯å¾„åœ¨ <code>./conf/sonar.properties</code></p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># è®¾ç½®æ•°æ®åº“çš„è´¦æˆ·å¯†ç </span><br><span class="line">sonar.jdbc.username=ua</span><br><span class="line">sonar.jdbc.password=pwd</span><br><span class="line"></span><br><span class="line">sonar.jdbc.url=jdbc:mysql://localhost:3306/sonar?useUnicode=true&amp;characterEncoding=utf8&amp;rewriteBatchedStatements=true&amp;useConfigs=maxPerformance</span><br><span class="line"></span><br><span class="line"># By default, ports will be used on all IP addresses associated with the server.</span><br><span class="line">sonar.web.host=0.0.0.0</span><br><span class="line"></span><br><span class="line"># The default value is root context (empty value).</span><br><span class="line">sonar.web.context=/</span><br><span class="line"># TCP port for incoming HTTP connections. Default value is 9000.</span><br><span class="line">sonar.web.port=9003</span><br></pre></td></tr></table></figure></li><li><p>è¿è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨ Sonar-Qubeï¼Œæ ¹æ®æ“ä½œç³»ç»Ÿé€‰æ‹©</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Last login: Wed Feb 15 18:15:05 on ttys000</span><br><span class="line">localhost:~ tianyi$ /usr/local/sonarqube-6.2/bin/macosx-universal-64/sonar.sh start</span><br><span class="line"></span><br><span class="line">localhost:~ tianyi$ /usr/local/sonarqube-6.2/bin/macosx-universal-64/sonar.sh start</span><br><span class="line">Starting SonarQube...</span><br><span class="line">Started SonarQube.</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºä¸€ä¸ªç®€å•çš„å·¥ç¨‹</p><p> é»˜è®¤å¯†ç æ˜¯adminï¼šadminï¼Œç™»é™†ç®¡ç†å‘˜è´¦å·ä»¥åï¼Œé…ç½®ç³»ç»Ÿå‚æ•°</p><p> åˆ›å»ºä¸€ä¸ªDemo å·¥ç¨‹</p><p> <img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/make-new1.png" alt="åˆ›å»ºä¸€ä¸ªå·¥ç¨‹"></p><p> Demo å·¥ç¨‹ç®€ä»‹</p><p> <img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/make-demo.png" alt="Demo å·¥ç¨‹ç®€ä»‹"></p><p> å› ä¸ºè¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆ†æï¼Œæ‰€ä»¥Demo æš‚æ—¶åªèƒ½é…ç½®ï¼Œåœ¨ä½¿ç”¨ç¯‡æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»å¦‚æœé€šè¿‡æŒ‡ä»¤æˆ–è‡ªåŠ¨åŒ–æ‰§è¡Œåˆ†æå®¡æŸ¥ã€‚</p></li><li><p>å®‰è£…ä¸€äº›å¿…å¤‡æ’ä»¶ï¼Œéƒ½å¯ä»¥ä»å®˜ç½‘æˆ–è€…github ä¸Šæœç´¢åˆ°</p><p> Sonaræ”¯æŒå¤šç§æ’ä»¶ï¼Œæ’ä»¶çš„ä¸‹è½½åœ°å€ä¸ºï¼š<a href="http://docs.codehaus.org/display/SONAR/Plugin+Library" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/Plugin+Library</a></p><p> å°†ä¸‹è½½åçš„æ’ä»¶ä¸Šä¼ åˆ°${SONAR_HOME}extensions\pluginsç›®å½•ä¸‹ï¼Œé‡æ–°å¯åŠ¨sonarã€‚</p></li></ol><h4 id="å¸¸ç”¨æ’ä»¶"><a href="#å¸¸ç”¨æ’ä»¶" class="headerlink" title="å¸¸ç”¨æ’ä»¶"></a>å¸¸ç”¨æ’ä»¶</h4><p>ï¼ˆæ³¨æ„ç‰ˆæœ¬å·å…¼å®¹æ€§é—®é¢˜ï¼‰</p><ul><li>SonarQube æ±‰åŒ–åŒ…ï¼š<a href="https://github.com/SonarQubeCommunity/sonar-l10n-zh" target="_blank" rel="noopener">https://github.com/SonarQubeCommunity/sonar-l10n-zh</a></li><li>Objective-C ä»£ç æ£€æŸ¥ï¼š<a href="https://github.com/octo-technology/sonar-objective-c" target="_blank" rel="noopener">https://github.com/octo-technology/sonar-objective-c</a></li><li>JavaScript ä»£ç æ£€æŸ¥ï¼š<a href="http://docs.codehaus.org/display/SONAR/JavaScript+Plugin" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/JavaScript+Plugin</a></li><li>python ä»£ç æ£€æŸ¥ï¼š<a href="http://docs.codehaus.org/display/SONAR/Python+Plugin" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/Python+Plugin</a></li><li>Webé¡µé¢æ£€æŸ¥ï¼ˆHTMLã€JSPã€JSFã€Rubyã€PHPç­‰ï¼‰ï¼š<a href="http://docs.codehaus.org/display/SONAR/Web+Plugin" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/Web+Plugin</a></li><li>xmlæ–‡ä»¶æ£€æŸ¥ï¼š<a href="http://docs.codehaus.org/display/SONAR/XML+Plugin" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/XML+Plugin</a></li><li>scmæºç åº“ç»Ÿè®¡åˆ†æï¼š<a href="http://docs.codehaus.org/display/SONAR/SCM+Stats+Plugin" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/SCM+Stats+Plugin</a></li><li>æ–‡ä»¶åº¦é‡ï¼š<a href="http://docs.codehaus.org/display/SONAR/Tab+Metrics+Plugin" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/Tab+Metrics+Plugin</a></li><li>ä¸­æ–‡è¯­è¨€åŒ…ï¼š<a href="http://docs.codehaus.org/display/SONAR/Chinese+Pack" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/Chinese+Pack</a></li><li>æ—¶é—´è¡¨æ˜¾ç¤ºåº¦é‡ç»“æœï¼š<a href="http://docs.codehaus.org/display/SONAR/Timeline+Plugin" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/Timeline+Plugin</a></li><li>åº¦é‡ç»“æœæ¼”è¿›å›¾ï¼š<a href="http://docs.codehaus.org/display/SONAR/Motion+Chart+Plugin" target="_blank" rel="noopener">http://docs.codehaus.org/display/SONAR/Motion+Chart+Plugin</a></li></ul><h4 id="æˆ‘çš„èµ„æº"><a href="#æˆ‘çš„èµ„æº" class="headerlink" title="æˆ‘çš„èµ„æº"></a>æˆ‘çš„èµ„æº</h4><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/commonly-used1.png" alt></p><h2 id="ä½¿ç”¨ç¯‡"><a href="#ä½¿ç”¨ç¯‡" class="headerlink" title="ä½¿ç”¨ç¯‡"></a>ä½¿ç”¨ç¯‡</h2><h3 id="ä½¿ç”¨SonarQube-Runneråˆ†ææºç "><a href="#ä½¿ç”¨SonarQube-Runneråˆ†ææºç " class="headerlink" title="ä½¿ç”¨SonarQube Runneråˆ†ææºç "></a>ä½¿ç”¨SonarQube Runneråˆ†ææºç </h3><h4 id="é¢„ç½®æ¡ä»¶"><a href="#é¢„ç½®æ¡ä»¶" class="headerlink" title="é¢„ç½®æ¡ä»¶"></a>é¢„ç½®æ¡ä»¶</h4><p>å·²å®‰è£…SonarQube Runnerä¸”ç¯å¢ƒå˜é‡å·²é…ç½®ï¼Œå³sonar-runnerå‘½ä»¤å¯åœ¨ä»»æ„ç›®å½•ä¸‹æ‰§è¡Œ</p><p>å¦‚ä½•é…ç½®ç¯å¢ƒå˜é‡ï¼Œå‚è€ƒ<a href="http://www.cnblogs.com/caowei/p/mac-path_2013-08-26.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a></p><h4 id="å¦‚ä½•åˆ†æ"><a href="#å¦‚ä½•åˆ†æ" class="headerlink" title="å¦‚ä½•åˆ†æ"></a>å¦‚ä½•åˆ†æ</h4><p><strong>1. åœ¨é¡¹ç›®æºç çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºsonar-project.propertiesé…ç½®æ–‡ä»¶</strong></p><p>ä»¥iOS é¡¹ç›®ä¸ºä¾‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Required metadata</span><br><span class="line">sonar.projectKey=iOS::Demo</span><br><span class="line">sonar.projectName=iOS::Demo</span><br><span class="line">sonar.projectVersion=1.0</span><br><span class="line"></span><br><span class="line"># Comma-separated paths to directories with sources (required)</span><br><span class="line">sonar.sources=Demo</span><br><span class="line"></span><br><span class="line"># Language</span><br><span class="line">sonar.language=objectivec</span><br><span class="line"></span><br><span class="line"># Encoding of the source files</span><br><span class="line">sonar.sourceEncoding=UTF-8</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šsonar.language å’Œå®‰è£…çš„ä»£ç å®¡æŸ¥æ’ä»¶æœ‰å…³ï¼Œéœ€è¦å®‰è£… sonar-objective-c æ’ä»¶ï¼Œå¦åˆ™è¿è¡Œæ—¶ä¼šæç¤ºæ— æ³•æ‰¾åˆ°è¿™ä¸ªè¯­è¨€</strong></p><p><strong>2. æ‰§è¡Œåˆ†æ</strong></p><p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ‰§è¡Œåˆ†ææŒ‡ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/sonar-runner-2.4/bin/sonar-runner</span><br></pre></td></tr></table></figure><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/sonar-ext.png" alt="æ‰§è¡Œåˆ†ææŒ‡ä»¤"></p><p>æŸ¥çœ‹Sonar åˆ†æçš„ç»“æœ</p><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/sonar-ext-result.png" alt="åˆ†æç»“æœ"></p><p>ä»¥ä¸Šæ˜¯åˆ›å»ºDemo å·¥ç¨‹åï¼Œé€šè¿‡æ‰‹åŠ¨æ‰§è¡Œåˆ†ææŒ‡ä»¤å®Œæˆä»£ç å®¡æŸ¥åˆ†æã€‚</p><h3 id="ä¸Jenkins-æŒç»­é›†æˆ"><a href="#ä¸Jenkins-æŒç»­é›†æˆ" class="headerlink" title="ä¸Jenkins æŒç»­é›†æˆ"></a>ä¸Jenkins æŒç»­é›†æˆ</h3><h4 id="æ„å»ºå‰æ“ä½œ"><a href="#æ„å»ºå‰æ“ä½œ" class="headerlink" title="æ„å»ºå‰æ“ä½œ"></a>æ„å»ºå‰æ“ä½œ</h4><p>åœ¨jenkinsçš„æ’ä»¶ç®¡ç†ä¸­é€‰æ‹©å®‰è£…SonarQube-Scannerï¼Œè¯¥æ’ä»¶å¯ä»¥ä½¿é¡¹ç›®æ¯æ¬¡æ„å»ºéƒ½è°ƒç”¨sonarè¿›è¡Œä»£ç åº¦é‡ã€‚</p><p>è¿›å…¥é…ç½®é¡µé¢å¯¹sonaræ’ä»¶è¿›è¡Œé…ç½®ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/jenkins-goujian.png" alt="æ–°å¢æ„å»ºå‰æ“ä½œ"></p><p>ä»¥ä¸Šé…ç½®å¯ä»¥ä½¿é¡¹ç›®åœ¨æ„å»ºå‰ï¼Œè‡ªåŠ¨æ‰§è¡Œä»£ç å®¡æŸ¥å’Œåˆ†æï¼Œç»“æœä¼šè‡ªåŠ¨ä¿å­˜å¹¶ä¸Šä¼ åˆ°æ•°æ®åº“ï¼Œé€šè¿‡Sonar æœåŠ¡å™¨å±•ç¤ºç»™å¼€å‘è€…ã€‚</p><h4 id="è®¾ç½®è§¦å‘å™¨"><a href="#è®¾ç½®è§¦å‘å™¨" class="headerlink" title="è®¾ç½®è§¦å‘å™¨"></a>è®¾ç½®è§¦å‘å™¨</h4><p>æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ä»“åº“ï¼Œè‹¥æœ‰ä¸Šåº“ï¼Œåˆ™è‡ªåŠ¨æ‰§è¡Œä»£ç æ£€æµ‹</p><p><img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/jenkins-chufa.png" alt="è®¾ç½®è§¦å‘å™¨"></p><p>è‡³æ­¤ï¼Œé€šè¿‡Sonar åˆæ­¥æ„å»ºä»£ç æŒç»­å®¡æŸ¥çš„å·¥ä½œå®Œæˆã€‚</p><h2 id="é—®é¢˜ç¯‡"><a href="#é—®é¢˜ç¯‡" class="headerlink" title="é—®é¢˜ç¯‡"></a>é—®é¢˜ç¯‡</h2><h3 id="å®‰è£…ä¸­çš„é—®é¢˜"><a href="#å®‰è£…ä¸­çš„é—®é¢˜" class="headerlink" title="å®‰è£…ä¸­çš„é—®é¢˜"></a>å®‰è£…ä¸­çš„é—®é¢˜</h3><ol><li><p>èµ„æºæ‰¾å¯»çš„é—®é¢˜</p><p> æ–‡ä¸­æåˆ°çš„èµ„æºæ–‡ä»¶ï¼Œç½‘ä¸Šè°·æ­Œç™¾åº¦éƒ½ç”¨ä¸Šï¼Œä¹Ÿæ‰¾äº†å¾ˆä¹…ï¼ŒåŒ…æ‹¬ä¸€äº›æ’ä»¶çš„é—®é¢˜ï¼Œå¿…é¡»å®‰è£…çš„å°±æ˜¯ Sonar-Qubeï¼ŒRunner å…¶å®ä¸å¿…è¦å®‰è£…ï¼Œå› ä¸ºJenkins é‡Œæœ‰æ’ä»¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p></li><li><p>ç¯å¢ƒé…ç½®é—®é¢˜</p><p> å¦‚æœä¸å¸¸ç”¨æŒ‡ä»¤çš„è¯ï¼Œå¯ä»¥ä¸é…ç½®ï¼Œç›´æ¥é€šè¿‡ç»å¯¹è·¯å¾„åšæ“ä½œï¼Œç¯å¢ƒé…ç½®çš„æ–¹æ³•å‚è€ƒ<a href="http://www.cnblogs.com/caowei/p/mac-path_2013-08-26.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a></p></li><li><p>åˆå§‹åŒ–æ—¶é‡åˆ°Sorry çš„é—®é¢˜</p><p> é‡åˆ°è¿™ç§é—®é¢˜å¯ä»¥å»æ ¹ç›®å½• /log/xx.log ä¸­æŸ¥çœ‹æ—¥å¿—ï¼Œå…·ä½“é—®é¢˜å…·ä½“è§£å†³</p><p> <img src="http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/qa-3.png" alt="sorry"></p></li><li><p>æ±‰åŒ–åŒ…çš„é—®é¢˜</p><p> å¦‚æœä½ ä¸ä¹ æƒ¯è‹±æ–‡çš„ä½¿ç”¨ï¼Œæƒ³åšä¸€åšæ±‰åŒ–çš„äº‹æƒ…æ—¶ï¼Œæ±‰åŒ–åŒ…ä¸€å®šè¦å¯¹ï¼Œå¦‚æœæœ‰é—®é¢˜ä¼šå¯¼è‡´æœåŠ¡å¯åŠ¨å¤±è´¥ã€‚</p><p> é™„ä¸Šï¼š<a href="https://github.com/SonarQubeCommunity/sonar-l10n-zh" target="_blank" rel="noopener">æ±‰åŒ–åŒ…ä¸‹è½½åœ°å€</a></p></li></ol><h3 id="SonarQube-å®é™…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"><a href="#SonarQube-å®é™…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ" class="headerlink" title="SonarQube å®é™…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"></a>SonarQube å®é™…ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3><p>åœ¨ä½¿ç”¨ SonarQube6.2 åˆ†æä»£ç è´¨é‡æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼š</p><ol><li><p>Xcode 8 å…¼å®¹æ€§é—®é¢˜</p><p> åŸæœ‰çš„xctoolå·²ä¸æ”¯æŒXCode8, æ”¹ç”¨xcodebuild + xcpretty æ¥æ›¿ä»£xctoolç¯èŠ‚ç”Ÿæˆå¯¹åº”çš„äº§å‡ºç‰©ã€‚</p><p> å…³äºXCode8çš„å…¼å®¹æ–¹æ¡ˆ, è¯·çœ‹<a href="https://my.oschina.net/ChenTF/blog/806565" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a></p></li></ol><h2 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h2><p>ä»£ç è´¨é‡ç®¡ç†å¯¹æé«˜é¡¹ç›®è´¨é‡æ„ä¹‰é‡å¤§ã€‚æœ¬æ–‡ä»‹ç»äº† SonarQube çš„å·¥ä½œåŸç†ï¼Œå¹¶ä»é¡¹ç›®å®æˆ˜çš„è§’åº¦è®²è§£äº†ä½¿ç”¨ SonarQube è¿›è¡Œé¡¹ç›®ä»£ç è´¨é‡ç®¡ç†çš„æµç¨‹å’Œæ³¨æ„äº‹é¡¹ã€‚</p><p>ä»£ç è§„èŒƒè´µåœ¨åšæŒä¸æ‰§è¡ŒåŠ›ï¼Œè‡ªåŠ¨å®¡æŸ¥åªæ˜¯åšäº†æé†’çš„ä½œç”¨ï¼Œå½“ç„¶æ ¹æ®è¯­è¨€çš„è§„åˆ™ï¼Œå¾ˆå¤šè§„èŒƒåœ¨ä½¿ç”¨è€…æ¥è®²çœ‹ä¼¼ä¸åˆç†æˆ–è€…ä¸å¥½ç”¨ï¼Œæœ‰äº†è¿™ä¸ªå·¥å…·ï¼Œå‚ä¸è€…ä»¬å¯ä»¥åˆ‡èº«æ„Ÿå—åˆ°å›¢é˜Ÿçš„æˆé•¿ã€‚</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://my.oschina.net/ChenTF/blog/708646" target="_blank" rel="noopener">[å®è·µ]iOS Sonaré›†æˆæµç¨‹è¯¦è§£</a></p><p><a href="https://my.oschina.net/ChenTF/blog/806565" target="_blank" rel="noopener">[å®è·µ]Sonar Xcode8å…¼å®¹</a></p><p><a href="http://www.uml.org.cn/rjzl/201312132.asp" target="_blank" rel="noopener">SonarQubeä»£ç è´¨é‡ç®¡ç†å¹³å°å®‰è£…ä¸ä½¿ç”¨</a></p><p><a href="http://www.cnblogs.com/gao241/p/3190701.html" target="_blank" rel="noopener">é…ç½®sonarã€jenkinsè¿›è¡ŒæŒç»­å®¡æŸ¥</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://cdn.yuhanle.com/continuous-code-quality-sonarqube-install/Benefits-of-Using-SonarQube-For-Code-Reviews.jpg&quot; alt=&quot;SonarQube&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;ä»‹ç»ç¯‡&quot;&gt;&lt;a href=&quot;#ä»‹ç»ç¯‡&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»ç¯‡&quot;&gt;&lt;/a&gt;ä»‹ç»ç¯‡&lt;/h2&gt;&lt;h3 id=&quot;SonarQube-ä»‹ç»&quot;&gt;&lt;a href=&quot;#SonarQube-ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;SonarQube ä»‹ç»&quot;&gt;&lt;/a&gt;SonarQube ä»‹ç»&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://www.sonarqube.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SonarQube&lt;/a&gt; æ˜¯ä¸€æ¬¾é¢†å…ˆçš„æŒç»­ä»£ç è´¨é‡ç›‘æ§å¹³å°ï¼Œå¼€æºåœ¨github ä¸Šï¼Œç°åœ¨å·²æ›´æ–°åˆ°6.2 ç‰ˆæœ¬ï¼Œstar æ•°é‡è¶…è¿‡ 1400+ï¼Œå¯ä»¥è½»æ¾é…ç½®åœ¨å†…ç½‘æœåŠ¡å™¨ï¼Œå®æ—¶ç›‘æ§ä»£ç ï¼Œå¸®åŠ©äº†è§£æå‡æå‡å›¢é˜Ÿé¡¹ç›®ä»£ç è´¨é‡ã€‚é€šè¿‡æ’ä»¶æœºåˆ¶ï¼ŒSonarQubeå¯ä»¥ç»§æ‰¿ä¸åŒçš„æµ‹è¯•å·¥å…·ï¼Œä»£ç åˆ†æå·¥å…·ï¼Œä»¥åŠæŒç»­é›†æˆå·¥å…·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="continue" scheme="https://blog.yuhanle.com/categories/continue/"/>
    
    
      <category term="iOS" scheme="https://blog.yuhanle.com/tags/iOS/"/>
    
      <category term="Sonar" scheme="https://blog.yuhanle.com/tags/Sonar/"/>
    
      <category term="Quality" scheme="https://blog.yuhanle.com/tags/Quality/"/>
    
  </entry>
  
  <entry>
    <title>è§å­—å¦‚é¢çš„è¿‡å»ä¸€å¹´</title>
    <link href="https://blog.yuhanle.com/2017/01/22/see-words-as-face/"/>
    <id>https://blog.yuhanle.com/2017/01/22/see-words-as-face/</id>
    <published>2017-01-22T04:29:59.000Z</published>
    <updated>2021-10-21T08:18:48.339Z</updated>
    
    <content type="html"><![CDATA[<p>è§å­—å¦‚é¢ï¼Œç”šæ˜¯æƒ³å¿µã€‚<br><a id="more"></a></p><center><br><img src="http://cdn.yuhanle.com/see-words-as-face/children-1807511_1920.jpg" alt><br></center><p>2016ï¼Œæ—¶é—´æ€»æ˜¯å¦‚æ­¤ï¼Œè¿‡çš„å¾ˆå¿«ã€‚å·¥ä½œåå¯¹äºæ—¶é—´çš„æ¦‚å¿µåªæœ‰åœ¨ç™½å¤©äº†ï¼Œæ€»è§‰å¾—ä¸å¤Ÿç”¨ï¼Œä¸Šç­ä¸‹ç­ï¼Œåƒé¥­ç¡è§‰ï¼Œä¸€å¦‚æ—¢å¾€çš„é‡å¤é‡å¤ï¼Œå°±åƒèŠ±é’±ä¸€æ ·ï¼Œæ¯ä¸€ç¬”å¾®å°çš„å¼€æ”¯ï¼Œç´¯ç§¯èµ·æ¥éƒ½è®©äººä¸æ•¢ç›¸ä¿¡ã€‚</p><p>è·Ÿä½ åœ¨ä¸€èµ·çš„è¿™ä¸€å¹´ï¼Œåº¸åº¸ç¢Œç¢Œï¼Œæœ¬è¯¥åœ¨å…ƒæ—¦å°±è·Ÿä½ å‘Šåˆ«ï¼Œæ²¡æƒ³åˆ°ä¸€æ‹–å°±æ˜¯ä¸€ä¸ªæœˆï¼Œä»æœªæƒ³è¿‡ä½ ä¼šèµ°çš„å¦‚æ­¤ä¹‹å¿«ï¼Œå¯èƒ½æ˜¯æˆ‘æ²¡å¤ªåœ¨æ„ï¼Œå› ä¸ºä½ å¸¦ç»™æˆ‘çš„è¿™æ˜¯ç–²æƒ«å’Œä¸å ªï¼Œç”šè‡³æ˜¯æˆ‘è‡³ä»Šéƒ½ä¸æ„¿æ¥å—çš„æœªæ›¾æ”¹å˜ã€‚</p><p>è¿™ä¸ª365å¤©ï¼Œæˆ‘å¾—åˆ°äº†è¿™äº›ï¼š</p><h2 id="è¿™ä¸€å¹´çš„ç”Ÿæ´»"><a href="#è¿™ä¸€å¹´çš„ç”Ÿæ´»" class="headerlink" title="è¿™ä¸€å¹´çš„ç”Ÿæ´»"></a>è¿™ä¸€å¹´çš„ç”Ÿæ´»</h2><p>åœ¨2015 å¹´11æœˆåº•ï¼Œå¥³æœ‹å‹æ¥åˆ°äº†è¿™ä¸ªæˆ‘ä»¬éƒ½å¾ˆé™Œç”Ÿçš„å¤§éƒ½å¸‚ï¼Œæ¥ç€åˆ°äº†2016 å¹´4æœˆï¼Œå¥¹å¼€å§‹äº†æ­£å¼çš„å·¥ä½œï¼Œå°ä¿©å£æŒ£å¾—ä¸å¤šï¼Œéƒ¨åˆ†æˆ¿ç§Ÿï¼Œéƒ¨åˆ†åƒå–ï¼Œä½™ä¸‹çš„å°±æ›´å°‘äº†ã€‚</p><p>4æœˆåº•ï¼Œæˆ‘ä»¬æ‘†è„±äº†ä¸åˆ°20å¹³ç±³çš„å•èº«å…¬å¯“ï¼Œæ‘†è„±äº†éš”ä¸‰å·®äº”åœç”µï¼Œè¿˜å¾—å»çŒå¤©ç„¶æ°”ï¼Œèµ°å¾ˆè¿œå»ä¹°èœçš„ç”Ÿæ´»ï¼Œæ¬åˆ°äº†æŸå°åŒº50+ å¹³ç±³çš„ä¸€å®¤ä¸€å…ã€‚æ²¡é”™ï¼Œæˆ¿ç§Ÿå¾ˆè´µï¼Œè¶³è¶³ç¿»äº†ä¸€å€å¤šï¼Œè·ç¦»æˆ‘ä»¬ä¸Šç­çš„åœ°æ–¹ä¹Ÿå¾ˆè¿œï¼Œä½†è¿™äº›éƒ½ä¸é‡è¦ï¼Œæˆ‘ä»¬éƒ½å¾ˆå¼€å¿ƒï¼Œé™„è¿‘æœ‰äº›æœ‹å‹ï¼Œå‘¨æœ«å¯ä»¥èšèšï¼Œæ¥¼ä¸‹å°±æœ‰èœå¸‚åœºï¼Œæœ€æ€»è¦çš„æ˜¯ä¸»å§æœå—ï¼Œå†ä¹Ÿä¸ç”¨å®…åœ¨å†·å†°å†°çš„å°æˆ¿é—´é‡Œç©æ‰‹æœºäº†ã€‚</p><p>ç´§æ¥ç€ï¼Œ5æœˆä»½æœ€é‡è¦çš„æ˜¯å¤§å­¦èˆå‹ä»æ–°ç–†è¿‡æ¥ç©ï¼Œé‚£ä¸€å¤©ï¼Œæˆ‘ä»¬å»äº†ä¸ƒå®ï¼Œç”°å­åŠï¼Œåœ¨æ¸¯æ±‡å¹¿åœºåƒè¿‡é¥­ï¼Œå¤œæ™šè¿˜å»äº†å¤–æ»©çœ‹å¤œæ™¯ï¼Œå›æƒ³èµ·æ¥ï¼Œè¿™æ˜¯æ¥è¿™ä¸ªåŸå¸‚ä»¥åæœ€å¥½ç©çš„ä¸€å¤©ã€‚æ—¶é—´æ¯”è¾ƒæ•¢ï¼Œå¤§å®¶ä¸€è·¯ä¸Šå‡ ä¹éƒ½æ˜¯è·‘èµ·æ¥çš„ï¼Œä¸ºäº†å¤–æ»©çš„å¤œæ™¯ï¼Œä¹Ÿå€¼ã€‚</p><p>æ¥ä¸‹æ¥çš„å‡ ä¸ªæœˆï¼Œå¤©æ°”å¾ˆçƒ­ï¼Œé™¤äº†å‘¨æœ«çˆ¬çˆ¬å±±ï¼Œä¹Ÿå°±åœ¨å®¶å¾…ç€å•ƒè¥¿ç“œã€‚</p><p>ä¸­ç§‹èŠ‚å‡æœŸï¼Œæˆ‘å’Œå¥³å‹çº¦å¥½å»äº†è¶Ÿå—äº¬ï¼Œå¤éƒ½å—äº¬æ˜¯ä¸ªå¾ˆé€‚åˆæ¸¸ç©çš„åœ°æ–¹ï¼Œä¸ä»…æœ‰å¾ˆå¤šè‘—åæ™¯ç‚¹ï¼Œè¿˜æœ‰å¾ˆå¤šå„è‰²å°åƒï¼Œä¸¤å¤©ä¸€å¤œçš„æ—¶é—´ï¼Œåˆšåˆšå¥½ï¼Œåªæ˜¯ç´¯äº†äº›ï¼Œå‰åŒäº‹ä½œä¸ºåœ°é“çš„å—äº¬äººï¼Œå¸¦æˆ‘ä»¬åƒäº†ä¸€éå¤§æ’æ¡£é‡Œçš„æ‹›ç‰Œèœï¼ŒçœŸæ˜¯æµè¿å¿˜è¿”ï¼Œå› ä¸ºå›å»å°±å¾—é©¬ä¸Šä¸Šç­ã€‚</p><p>åˆ°äº†10 æœˆï¼Œå›½åº†èŠ‚çš„å‡æœŸå¾ˆé•¿ï¼Œæå‰å›äº†è¶Ÿå®¶ï¼Œåˆšå¥½å®¶é‡Œçš„æˆ¿å­è£…ä¿®å¥½ï¼Œå‡†å¤‡æ¬å®¶å‘¢ã€‚å‰å‰ååå¿™æ´»äº†ä¸‰å››å¤©ï¼Œæ¥ç€å°±ä¸€å®¶äººå¸¦ç€å½©ç¤¼ï¼Œå»å’Œå¥³å‹çš„å®¶äººè§é¢äº†ã€‚è¯´èµ·æ¥ä¹Ÿè®¤è¯†è¿‘7 å¹´ï¼Œé˜»åŠ›è¿˜å¥½ï¼Œæ—¥ä¹…è§äººå¿ƒå˜›ï¼ç°åœ¨çš„çˆ¶æ¯éƒ½å¾ˆå¼€æ˜ï¼Œæˆ‘ä»¬ä¹‹é—´è¿˜æ˜¯æ¯”è¾ƒé¡ºåˆ©çš„ï¼Œè‡³å°‘å½¼æ­¤è¿˜ç®—æ»¡æ„ï¼Œä¸ä¼šè®©å®¶é‡Œçæ“å¿ƒã€‚</p><p>å›½åº†èŠ‚ç»“æŸåï¼Œåœ¨éƒ‘å·è§äº†å‡ ä¸ªæœ‹å‹ï¼Œä¸´èµ°å‰ä¸€ç›´åœ¨é”…å¤§ä¾ äºŒä¸ƒåº—åƒäº†é¡¿ç«é”…ï¼Œä¹‹æ‰€ä»¥é€‰åœ¨è¿™ä¸ªåœ°æ–¹ï¼Œæ˜¯å› ä¸ºé©¬ä¸Šå°±è¦åä¸Šç«è½¦æ‹œæ‹œäº†ã€‚è¿™é¡¿é¥­åƒèµ·æ¥ï¼Œå¤§å®¶å®Œå…¨æ²¡æœ‰å¥½ä¹…ä¸è§çš„æ ·å­ï¼Œéƒ½åœ¨èŠç€å·¥ä½œï¼ŒèŠç€æˆ¿ä»·ï¼Œè¿™ä¸€å¹´ï¼Œæˆ¿ä»·æ²¡æœ‰éª—äººï¼Œä¸€ç›´åœ¨æ¶¨ã€‚å›åˆ°ä¸Šæµ·ä»¥åï¼Œæˆ‘å°±å¼€å§‹ç€æ€¥äº†ï¼ŒæŒ‰ç…§æˆ‘ä»¬çš„å®¶åº­æ¡ä»¶æ¥è®²ï¼Œé¦–ä»˜çš„é—®é¢˜å¾ˆå¤§ï¼Œä¹Ÿæ˜¯æœ€ä¸»è¦çš„é—®é¢˜ã€‚åæ¥æˆ‘ä»¬è¿˜æ˜¯å†³å®šï¼Œåœ¨æˆ¿ä»·è¶‹äºç¨³å®šçš„11 æœˆä»½ï¼Œå¤šæ¬¡å¾€è¿”ä¸¤ä¸ªåŸå¸‚ï¼Œå°†æ­¤äº‹å®šäº†ä¸‹æ¥ã€‚å½“ç„¶è¿˜æœ‰ä¸€ä»¶å¥½äº‹ï¼Œæˆ‘ä»¬é¢†äº†ç»“å©šè¯ï¼Œè¿™ä¸ªæ„ä¹‰å¾ˆå¤§ã€‚</p><p>å¾ˆå¿«ï¼Œè¿™ä¸€å¹´å°±ç»“æŸäº†ï¼Œ17 å¹´å…ƒæ—¦ï¼Œå¸¦ç€å¥³æœ‹å‹å»äº†è¶Ÿå·´é»æ˜¥å¤©ï¼Œä¹°äº†å¥¹å‘å¾€å·²ä¹…çš„é’»æˆ’ï¼Œå¯¹æ­¤æ¯«æ— æ¦‚å¿µï¼Œ30+ åˆ†ï¼Œè™½ç„¶æ²¡æœ‰é¹…åµçŸ³é‚£ä¹ˆå¤§ï¼Œä½†æ˜¯ä½è°ƒä¸€äº›ï¼Œæˆ‘ä»¬éƒ½è¿˜æ˜¯å¾ˆé«˜å…´çš„ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œä¹Ÿè®¢å¥½äº†17 å¹´3 æœˆä»½å»ä¸‰äºšæ—…è¡Œçš„äº‹æƒ…ï¼Œé¡ºä¾¿æ‹æ‹ç»“å©šç…§ï¼Œå‡†å¤‡å¥½äº†ï¼Œå°±è¯¥æ­¥å…¥å©šå§»çš„æ®¿å ‚äº†ã€‚</p><h2 id="è¿™ä¸€å¹´çš„å·¥ä½œ"><a href="#è¿™ä¸€å¹´çš„å·¥ä½œ" class="headerlink" title="è¿™ä¸€å¹´çš„å·¥ä½œ"></a>è¿™ä¸€å¹´çš„å·¥ä½œ</h2><p>åŸæœ¬ä¸€ä¸ªäººçš„é¡¹ç›®ï¼Œ15 å¹´åº•æ–°å¢äº†ä¸ªå°ä¼™ä¼´ï¼Œ91 å¹´çš„ç ”ç©¶åƒ§ï¼Œå¤§å®¶ç›¸äº’å­¦ä¹ ï¼Œå·¥ä½œèµ·æ¥é…åˆä¹Ÿå¾ˆé»˜å¥‘ï¼Œå¾ˆæ»¡æ„ã€‚</p><p>åŸæœ‰çš„1.0 ç‰ˆæœ¬æ–°å¢åŠŸèƒ½ï¼Œç»´æŠ¤äº†ä¸€æ•´å¹´ã€‚è“ç‰™çš„é¡¹ç›®åœ¨15 å¹´åº•å°±æç½®äº†ï¼Œä¸‰å››æœˆä»½çš„æ—¶å€™ï¼Œé¢†å¯¼è¯´ï¼Œå¯èƒ½è¦ç»§ç»­å¯åŠ¨è“ç‰™çš„é¡¹ç›®ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰åŠ äº†ä¸€ä¸ªå°ä¼™ä¼´ï¼Œäºæ˜¯3 ä¸ªç”·äººçš„å°å›¢é˜Ÿå°±å¼€å¯äº†ã€‚</p><p>æ¥ç€å°±æ˜¯ä¸€ä¸ªæœˆçš„è“ç‰™é¡¹ç›®ï¼Œ1.0 ç‰ˆæœ¬çš„æ›´æ–°è¿­ä»£ï¼Œå†…éƒ¨é”€å”®ç³»ç»Ÿçš„æ›´æ–°è¿­ä»£ï¼Œæ²¡æœ‰æ·±å…¥çš„å­¦ä¹ æœºä¼šï¼Œä½†æ˜¯äº‹æƒ…å¤šè€Œæ‚ï¼Œæœ‰åšä¸å®Œçš„ä¸œè¥¿ã€‚</p><p>å¾ˆå¿«åˆ°äº†6 æœˆä»½ï¼Œ1.0 çš„æ›´æ–°å˜æ…¢äº†ï¼Œæ›´å¤šçš„æ—¶é—´ï¼Œæˆ‘ä»¬å¼€å§‹äº†2.0 çš„è½¯ä»¶ç ”å‘ï¼Œç›¸æ¯”è¾ƒè€Œè¨€ï¼Œ2.0 çš„è½¯ä»¶æ›´é€‚åˆç”¨æˆ·ï¼Œä½“éªŒæå‡äº†ä¸å°‘ï¼Œä½†ä¹Ÿå¢å¤§äº†ç ”å‘çš„éš¾åº¦ï¼Œå¯¹æŠ€æœ¯çš„è¦æ±‚ä¹Ÿé«˜äº†å¾ˆå¤šã€‚ä½†æ˜¯åŸæœ¬è®¡åˆ’å…«ä¹æœˆä»½å‘å¸ƒï¼Œæ²¡æƒ³åˆ°åˆ°äº†ä»Šå¤©è¿˜åªæ˜¯åœ¨å…¬æµ‹é˜¶æ®µï¼Œä¸­é—´é‡åˆ°çš„é‚£äº›å‘ï¼Œè¿˜æœ‰éœ€æ±‚çš„å˜æ›´ï¼Œç®€ç›´è®©äººç”Ÿä¸å¦‚æ­»ã€‚</p><p>æ¥ç€8 æœˆä»½ï¼Œä¸€ä½åŒäº‹å› ä¸ºä¸ªäººåŸå› ç¦»èŒäº†ï¼Œå…±äº‹äº†ä¸€å¹´ï¼ŒçœŸçš„æ˜¯æŒºèˆä¸å¾—ï¼Œå…¬å¸å°±åƒå¸‚é›†ï¼Œæ¥æ¥å¾€å¾€å¾ˆå¤šäººï¼Œè°ä¹Ÿä¸çŸ¥é“å›å»ä¹°è°å®¶çš„ä¸œè¥¿ã€‚é¡¹ç›®ä»ç„¶å¦‚æ­¤ï¼ŒåŒäº‹ç¦»èŒä»¥åï¼Œ2.0 ç‰ˆæœ¬åˆè¿æ¥äº†å¤§æ”¹ç‰ˆï¼Œä¸çŸ¥é“æ˜¯è¯¥é«˜å…´è¿˜æ˜¯æ€ä¹ˆåœ°ï¼Œæ€»ä¹‹ï¼Œç»§ç»­æ”¹ï¼Œç»§ç»­åŒæ—¶ç»´æŠ¤å‡ ä¸ªç‰ˆæœ¬ï¼Œçœ‹èµ·æ¥æ€»æ˜¯é‚£ä¹ˆé¥é¥æ— æœŸã€‚</p><p>åˆ°äº†11æœˆä»½ï¼Œé¡¹ç›®åˆå¤šäº†ä¸¤ä¸ªï¼Œä¸å¾—ä¸å†æ‰¾ä¸€ä¸ªå°ä¼™ä¼´ï¼Œè¿˜å¥½è¿™ä¸ªè¡Œä¸šï¼Œèµ„æºå¾ˆå¤šï¼Œåªæ˜¯é¢è¯•èµ·æ¥ï¼Œæ‰¾åˆ°åˆé€‚çš„ä¹ŸæŒºéš¾ï¼Œæœ€åè¦äº†ä¸€ä¸ªå†…æ¨çš„å°å§‘å¨˜ï¼Œæ€»ç®—æ˜¯è°ƒå’Œäº†ä¸€ä¸‹æˆ‘ä»¬éƒ¨é—¨çš„ç”·å¥³æ¯”ä¾‹ï¼Œä¸è¿‡å¹´é¾„æƒŠäººï¼Œç¬é—´æ‹‰ä½äº†å…¬å¸çš„å¹³å‡å¹´é¾„ã€‚</p><p>æˆªæ­¢åˆ°17 å¹´1 æœˆä¸­æ—¬ï¼Œ2.0 ç‰ˆæœ¬ç»ˆäºå…¬æµ‹ï¼Œæ–°å¢çš„ä¸¤ä¸ªé¡¹ç›®ä¹Ÿå¯ä»¥æ‹¿å‡ºæ¥å±•ç¤ºï¼Œä½œä¸ºç ”å‘ï¼Œä¸åœ¨æ„è¯„ä»·ï¼Œæœ‰äººå°Šé‡åŠ³åŠ¨æˆæœå°±å¿ƒæ»¡æ„è¶³ã€‚</p><p>ä»¥ä¸Šæ˜¯è¿™ä¸€å¹´çš„å·¥ä½œï¼Œä»£ç æ²¡å°‘äº›ï¼Œåªæ˜¯å¤šäº†å¾ˆå¤šç®¡ç†ç»éªŒä¸Šçš„å­¦ä¹ å’Œå†ç»ƒã€‚</p><h2 id="è¿™ä¸€å¹´çš„å­¦ä¹ "><a href="#è¿™ä¸€å¹´çš„å­¦ä¹ " class="headerlink" title="è¿™ä¸€å¹´çš„å­¦ä¹ "></a>è¿™ä¸€å¹´çš„å­¦ä¹ </h2><p>è¿™å—ä¸œè¥¿å¾ˆå°‘ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯åœ¨å·¥ä½œå˜›~</p><p>ä¸­é—´æœ‰ä¸€å¤©æ—¶é—´å‚åŠ äº†é¥¿äº†ä¹ˆç§»åŠ¨æŠ€æœ¯åˆ†äº«ï¼Œåœ¨æ­¤ä¹‹å‰ä¹Ÿè®¤è¯†äº†å“åŒå­¦ï¼Œè¿˜æœ‰å†°éœœå’Œå†¬ç“œï¼Œåªè§äº†ä¸€æ¬¡é¢ï¼Œæœ¬äººä¸å–„è¨€è¯­ï¼Œåªæ˜¯å¬ä»–ä»¬èŠå¾—å¤šäº†ä¸€äº›ï¼ŒæŠ€æœ¯åœˆçš„å¾®ä¿¡ç¾¤å’ŒQQ ç¾¤åŠ äº†ä¸å°‘ï¼Œæ¯å¤©éƒ½èƒ½çœ‹åˆ°æœ‰äººé—®æœ‰äººç­”ï¼Œå¶å°”ä¹Ÿä¼šå‚ä¸è®¨è®ºã€‚</p><p>å…·ä½“çš„é¡¹ç›®ä¸­ï¼Œé€æ¸å‰¥ç¦»äº†å„ä¸ªæ¨¡å—ä¹‹é—´çš„è”ç³»ï¼Œæ•°æ®åº“æ–¹é¢ä¹Ÿå°è¯•äº†Realm å’ŒCoreDataï¼Œåšäº†ä¸€äº›æ¯”è¾ƒå’Œåˆ†æï¼Œæœ€åé€‰æ‹©äº†åè€…ã€‚</p><p>å·¥ä½œä¹‹ä½™ä¹Ÿæ­å»ºäº†æŒç»­é›†æˆå¹³å°å’Œè¿œç¨‹æŒç»­ä»£ç å®¡æ ¸å¹³å°ï¼Œè¿™äº›éƒ½æ¯”è¾ƒç®€å•ï¼Œç½‘ä¸Šçš„æ•™ç¨‹çœ‹çš„ç»†è‡´éƒ½ä¸ä¼šå­˜åœ¨ä»€ä¹ˆé—®é¢˜ã€‚</p><p>æ€»ä¹‹ï¼Œå­¦ä¹ çš„å¾ˆæ¬ ç¼ºã€‚</p><h2 id="ä¸‹ä¸€å¹´çš„å°ç›®æ ‡"><a href="#ä¸‹ä¸€å¹´çš„å°ç›®æ ‡" class="headerlink" title="ä¸‹ä¸€å¹´çš„å°ç›®æ ‡"></a>ä¸‹ä¸€å¹´çš„å°ç›®æ ‡</h2><p>å¥æ—å…ˆç”Ÿçš„ç›®æ ‡æˆ‘å¾ˆæ¬£èµï¼Œæ¯”å¦‚å…ˆæŒ£ä»–ä¸€ä¸ªäº¿ã€‚</p><center><br><img src="http://cdn.yuhanle.com/see-words-as-face/lens-1209823_1920.jpg" alt><br></center><ul><li>Swift ä¸€å®šè¦ç©è½¬ï¼Œè‡³å°‘è¦åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨Swift å¼€å‘</li><li>ç»ˆèº«å¤§äº‹è¦å°½æ—©è§£å†³</li><li>è§æ›´å¤šçš„æœ‹å‹</li><li>æƒ…å•†</li></ul><p>2016 å¹´ï¼Œä¹Ÿå¹¶ä¸æ˜¯æ¯«æ— æ”¶è·ï¼Œåº”å½“ä¿æŒæ¿€æƒ…ï¼Œåšå¥½æ¯ä¸€ä»¶äº‹ï¼Œå–„å¾…æ¯ä¸€ä¸ªäººã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è§å­—å¦‚é¢ï¼Œç”šæ˜¯æƒ³å¿µã€‚&lt;br&gt;
    
    </summary>
    
      <category term="word" scheme="https://blog.yuhanle.com/categories/word/"/>
    
    
      <category term="see a word" scheme="https://blog.yuhanle.com/tags/see-a-word/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•è®¾è®¡æ‰«ä¸€æ‰«åŠŸèƒ½æ‰èƒ½æ›´ä¼˜é›…</title>
    <link href="https://blog.yuhanle.com/2016/12/04/design-scan-function/"/>
    <id>https://blog.yuhanle.com/2016/12/04/design-scan-function/</id>
    <published>2016-12-04T00:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.335Z</updated>
    
    <content type="html"><![CDATA[<p>å½“å‰äºŒç»´ç åœ¨ç”Ÿæ´»ä¸­éšå¤„å¯è§ï¼Œä»–çš„åŠŸèƒ½æ— éœ€å¤šè¨€ï¼Œå½»åº•çš„æ”¹å˜äº†æ¶ˆè´¹è€…çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œæå‡äº†ç”¨æˆ·çš„æ“ä½œä½“éªŒï¼ŒåŒæ—¶ä¹Ÿæ‹‰è¿‘äº†äººä¸äººï¼Œäººä¸ç‰©ä¹ƒè‡³ç‰©ä¸ç‰©ä¹‹é—´çš„è·ç¦»<a id="more"></a>ã€‚</p><center><br><img src="http://cdn.yuhanle.com/Elegant-design-scan-function/Thematic1.jpg" alt="Thematic"><br></center><h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>æ­£å¦‚é¢˜å›¾ï¼Œå½“å‰äºŒç»´ç åœ¨ç”Ÿæ´»ä¸­éšå¤„å¯è§ï¼Œä»–çš„åŠŸèƒ½æ— éœ€å¤šè¨€ï¼Œå½»åº•çš„æ”¹å˜äº†æ¶ˆè´¹è€…çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œæå‡äº†ç”¨æˆ·çš„æ“ä½œä½“éªŒï¼ŒåŒæ—¶ä¹Ÿæ‹‰è¿‘äº†äººä¸äººï¼Œäººä¸ç‰©ä¹ƒè‡³ç‰©ä¸ç‰©ä¹‹é—´çš„è·ç¦»ã€‚</p><p>äºŒç»´ç çš„ä½¿ç”¨åœºæ™¯å¾ˆå¤šï¼Œæ¯”å¦‚æ·»åŠ å¥½å‹ï¼Œå…³æ³¨å…¬ä¼—å·ï¼Œç§»åŠ¨æ”¯ä»˜ï¼Œè¿˜æœ‰å¾ˆå¤šçš„æŸæŸæ´»åŠ¨å…¥å£ï¼Œç”¨æˆ·æ— éœ€è®°ä½å¤ªå¤šä¿¡æ¯ï¼Œæ‹¿å‡ºæ‰‹æœºï¼Œè½»è½»çš„æ‰«ä¸€æ‰«å¯¹æ–¹çš„èµ„æ–™å°±èƒ½å®Œæˆæ“ä½œï¼›ç§»åŠ¨æ”¯ä»˜æ—¶ä»£ï¼Œä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŠŸèƒ½çš„ä¾¿æ·ï¼Œæ‰èƒ½å‘å±•çš„æ›´æ™®éï¼Œå‰èµ·æ‰‹æ¥ä¹Ÿå°±ä¸€ç¬é—´ï¼›åœ¨å•†å®¶ä¸¾åŠçš„å¾ˆå¤šæ´»åŠ¨ä¸­ï¼Œåªéœ€è¦æä¾›ä¸€ä¸ªäºŒç»´ç å›¾ç‰‡ï¼Œå†é€šè¿‡æœ‹å‹åœˆç­‰ç¤¾äº¤åª’ä½“çš„ç–¯ç‹‚è½¬å‘ï¼Œäº¿ä¸‡ç”¨æˆ·éƒ½èƒ½ä¸å•†å®¶é›¶è·ç¦»å‚ä¸æ´»åŠ¨ï¼Œæ¥ç€äºŒæ¬¡åˆ†äº«ï¼Œä»è€Œç»™å•†å®¶å¸¦æ¥è¹­è¹­è¹­çš„æµé‡ã€‚</p><p>ç„¶è€Œï¼Œä»¥ä¸Šçš„ç§ç§ä¾¿æ·ï¼Œéƒ½ç¦»ä¸å¼€æ‰«ä¸€æ‰«è¿™ä¸ªåŠŸèƒ½ã€‚ä¸‹é¢ï¼Œæœ¬äººå°±ç«™åœ¨ä¸€ä¸ªåˆšåˆšæ¥è§¦æ­¤è¡Œä¸šçš„åŸºç¡€ä¸Šï¼Œè·Ÿå¤§å®¶èŠä¸€èŠæˆ‘è„‘è¢‹é‡Œçš„æ‰«ä¸€æ‰«æ˜¯å¦‚ä½•è®¾è®¡çš„ï¼ˆå¦‚æœ‰éè®®ï¼Œè¯·è‰¾ç‰¹æˆ‘ï¼‰ã€‚</p><h2 id="æ­£æ­£æ­£æ–‡"><a href="#æ­£æ­£æ­£æ–‡" class="headerlink" title="æ­£æ­£æ­£æ–‡"></a>æ­£æ­£æ­£æ–‡</h2><h3 id="å¸‚åœºä¸Šä¸»å¯¼åº”ç”¨æ˜¯å¦‚ä½•åšçš„"><a href="#å¸‚åœºä¸Šä¸»å¯¼åº”ç”¨æ˜¯å¦‚ä½•åšçš„" class="headerlink" title="å¸‚åœºä¸Šä¸»å¯¼åº”ç”¨æ˜¯å¦‚ä½•åšçš„"></a>å¸‚åœºä¸Šä¸»å¯¼åº”ç”¨æ˜¯å¦‚ä½•åšçš„</h3><p>æƒ³å¿…æ¥è§¦è¿™ä¸ªè¡Œä¸šçš„äº§å“å’Œå¼€å‘äººå‘˜éƒ½äº†è§£ï¼Œæ— è®ºä»€ä¹ˆåº”ç”¨ï¼Œè¿™å—çš„åŠŸèƒ½åº”è¯¥éƒ½æ˜¯å¤§å·®ä¸å·®ï¼Œæ¡æ¡å¤§è·¯é€šç½—é©¬ï¼Œä½†å…¶ä¸­çš„è§„åˆ™ï¼Œåº”è¯¥éƒ½æ˜¯ç»Ÿä¸€çš„ã€‚</p><p>é‚£æˆ‘åœ¨è¿™é‡Œå°±ç­é—¨å¼„æ–§ï¼Œé¡ºä¾¿ä½“éªŒä¸€ä¸‹å¾®ä¿¡çš„æ‰«ä¸€æ‰«åŠŸèƒ½ã€‚</p><center><br><img src="http://cdn.yuhanle.com/Elegant-design-scan-function/wechat_qrcode_meitu_1.png" alt="è¯¥äºŒç»´ç å›¾ç‰‡ç”±å¾®ä¿¡APPæä¾›" title="è¯¥äºŒç»´ç å›¾ç‰‡ç”±å¾®ä¿¡APPæä¾›"><br></center><center><br>è¯¥äºŒç»´ç å›¾ç‰‡ç”±å¾®ä¿¡APPæä¾›<br></center><p><b>1. å…ˆçœ‹ä¸€ä¸‹å¾®ä¿¡æ‰«æç»“æœ</b></p><center><br><img src="http://cdn.yuhanle.com/Elegant-design-scan-function/wechat_result_meitu_2.png" alt="è¯¥å›¾ç‰‡ç”±å¾®ä¿¡APPæä¾›" title="è¯¥å›¾ç‰‡ç”±å¾®ä¿¡APPæä¾›"><br></center><center><br>è¯¥å›¾ç‰‡ç”±å¾®ä¿¡APPæä¾›<br></center><p>è¿™é‡Œå› ä¸ºæ˜¯æœ¬äººçš„äºŒç»´ç ï¼Œæ‰€ä»¥ä¸‹é¢æ˜¾ç¤ºçš„æ“ä½œæ˜¯<code>å‘æ¶ˆæ¯</code>ï¼Œå¦‚æœæ˜¯é™Œç”Ÿäººçš„äºŒç»´ç ï¼Œå°±æ˜¯<code>æ·»åŠ åˆ°é€šè®¯å½•</code>ã€‚è¿™é‡Œå¯ä»¥çŸ¥é“ï¼Œæ‰«æè¿™ä¸ªäºŒç»´ç çš„æ“ä½œï¼Œå°±æ˜¯æŸ¥çœ‹è¯¥ç”¨æˆ·çš„ä¸ªäººèµ„æ–™ã€‚é‚£è¿™ä¸ªäºŒç»´ç é‡Œç©¶ç«Ÿè—æœ‰ä»€ä¹ˆä¿¡æ¯ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶ä»–å·¥å…·æ‰«æä¸€ä¸‹ç»“æœã€‚</p><p><b>2. çœ‹ä¸€ä¸‹è‰æ–™æ‰«æç»“æœ</b></p><center><br><img src="http://cdn.yuhanle.com/Elegant-design-scan-function/cli_result.png" alt="è¯¥å›¾ç‰‡ç”±è‰æ–™äºŒç»´ç æä¾›" title="è¯¥å›¾ç‰‡ç”±è‰æ–™äºŒç»´ç æä¾›"><br></center><center><br>è¯¥å›¾ç‰‡ç”±è‰æ–™äºŒç»´ç æä¾›<br></center><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªhttp çš„url é“¾æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://weixin.qq.com/r/35zcxLnE_uSFrf2n98nN</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆåˆ†æä¸€ä¸‹è¿™url çš„å¤§æ¦‚å‚æ•°ï¼Œä¸‹é¢ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥è¯´æ˜ï¼š</p><table><thead><tr><th>å‚æ•°</th><th style="text-align:center">ç±»å‹</th><th style="text-align:right">è¯´æ˜</th></tr></thead><tbody><tr><td><a href="http://weixin.qq.com" target="_blank" rel="noopener">http://weixin.qq.com</a></td><td style="text-align:center">String</td><td style="text-align:right">åŸŸå</td></tr><tr><td>r</td><td style="text-align:center">String</td><td style="text-align:right">çœ‹èµ·æ¥æ˜¯è·¯ç”± è¡¨ç¤ºè¦æŸ¥çœ‹èµ„æ–™</td></tr><tr><td>35zcxLnE_uSFrf2n98nN</td><td style="text-align:center">String</td><td style="text-align:right">çœ‹èµ·æ¥æ˜¯åŠ å¯†åçš„èƒ½æ ‡è¯†ç”¨æˆ·å”¯ä¸€å±æ€§</td></tr></tbody></table><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™ä¸ªurl æ˜¯çœŸå®å¯ä»¥è®¿é—®çš„ï¼Œé€šè¿‡ç”µè„‘æ‰“å¼€ä¼šç›´æ¥è·³è½¬åˆ°å®˜æ–¹ç½‘ç«™ã€‚å¯èƒ½ä¼šæœ‰å¾ˆå¤šäººï¼ˆåŒ…æ‹¬æˆ‘ä»¬çš„QAäººå‘˜ï¼‰æå‡ºç–‘é—®ï¼Œå¦‚æ­¤ç®€å•çš„ä¸€ä¸ªæ‰«ç æŸ¥çœ‹èµ„æ–™çš„åŠŸèƒ½ï¼Œä¸ºä»€ä¹ˆè¦åšæˆä¸€ä¸ªå¤æ‚é€»è¾‘çš„url è¶…é“¾æ¥å‘¢ï¼Ÿ</p><p><b>3. UC æ‰«ç ç»“æœ</b></p><center><br><img src="http://cdn.yuhanle.com/Elegant-design-scan-function/uc_result.png" alt="è¯¥å›¾ç‰‡ç”±UCæä¾›" title="è¯¥å›¾ç‰‡ç”±UCæä¾›"><br></center><center><br>è¯¥å›¾ç‰‡ç”±UCæä¾›<br></center><p>ä»¥ä¸Šæ˜¯UC æµè§ˆå™¨æ‰«ç çš„ç»“æœï¼ŒåŒæ ·æ˜¯è·³è½¬åˆ°å¾®ä¿¡å®˜ç½‘ï¼Œä½†æ˜¯ä¸ä¹‹ä¸åŒçš„æ˜¯ï¼Œç´§æ¥ç€ç›´æ¥æ‰“å¼€å¾®ä¿¡APPï¼ˆå¦‚æœå®‰è£…å¾®ä¿¡çš„è¯ï¼‰ï¼Œå¦åˆ™å°±è·³åˆ°åº”ç”¨å¸‚åœºå‘ŠçŸ¥ç”¨æˆ·ä¸‹è½½å¾®ä¿¡APPã€‚é‚£è¿™é‡Œå°±å¯ä»¥å¾ˆå¥½çš„è§£é‡Šä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆäºŒç»´ç çš„æ‰«æç»“æœä½¿ç”¨url è¶…é“¾æ¥ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥æ›´å¥½ä½“éªŒçš„å¼•å¯¼ç”¨æˆ·ï¼Œä»è€Œæå‡è‡ªèº«äº§å“çš„æµé‡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ é€šè¿‡ä½•ç§æ–¹å¼ï¼Œä»€ä¹ˆåº”ç”¨æ‰«ç ï¼Œå¯¹äºç”¨æˆ·æ¥è®²ï¼Œä½ å¯ä»¥å¾ˆå¿«é€Ÿå¾ˆç›´è§‚çš„äº†è§£åˆ°ä½ æ‰«æçš„ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Œä¸å†æ˜¯äºŒç»´ç å®é™…æ„ä¹‰ä¸Šçš„ä¸€æ®µå­—ç¬¦ï¼Œä»äº§å“çš„è§’åº¦æ¥è¯´ï¼Œä¹Ÿèƒ½å¤Ÿä¿è¯è¿™å—çš„ç”¨æˆ·æµé‡æµå¤±å‡å°‘ï¼Œæ“ä½œä½“éªŒä¸Šä¹Ÿæœ‰å¾ˆå¤§çš„æå‡ã€‚</p><h3 id="æˆ‘ä»¬çš„åº”ç”¨è¯¥å¦‚ä½•è®¾è®¡"><a href="#æˆ‘ä»¬çš„åº”ç”¨è¯¥å¦‚ä½•è®¾è®¡" class="headerlink" title="æˆ‘ä»¬çš„åº”ç”¨è¯¥å¦‚ä½•è®¾è®¡"></a>æˆ‘ä»¬çš„åº”ç”¨è¯¥å¦‚ä½•è®¾è®¡</h3><p>é‚£è¿™ä¸ªï¼Œè·Ÿäº§å“æœ¬èº«çš„éœ€æ±‚æœ‰å¾ˆå¤§å…³ç³»ï¼Œä½†æ˜¯å¼€å‘çš„æ€è·¯å’Œé€»è¾‘éƒ½æ˜¯ç»Ÿä¸€çš„ï¼Œç±»ä¼¼å¾®ä¿¡è¿™ç§è¶…çº§APPï¼Œæœ‰å„ç§ç‰›äººé›†æ€å¹¿ç›Šï¼Œé¡¹ç›®ä¸­åº”è¯¥æ˜¯ä¼šå„ç§ç»„ä»¶åŒ–ï¼Œæ¨¡å—åŒ–çš„è®¾è®¡ï¼Œæ‹¿ä¸€ä¸ªç®€å•çš„æ‰«ä¸€æ‰«åŠŸèƒ½æ¥è¯´ï¼Œä½œä¸ºä¸€ä¸ªæ¨¡å—ï¼Œåœ¨ä»–çš„åŠŸèƒ½ä»¥åŠå’Œå…¶ä»–æ¨¡å—ä¹‹é—´çš„è€¦åˆæ€§æ¥è¯´ï¼Œè‚¯å®šæ˜¯å€¼å¾—æˆ‘ä»¬å€Ÿé‰´å’Œå­¦äº›çš„ï¼Œå½“ç„¶æˆ‘æ²¡æœ‰æ‰¾åˆ°ä»»ä½•ç›¸å…³èµ„æ–™ï¼Œä¸‹é¢åªèƒ½æŒ‰ç…§è¿‘æœŸçš„é¡¹ç›®æ¥èŠèŠæˆ‘æ˜¯å¦‚ä½•å¤„ç†çš„ã€‚</p><p><b>1. äºŒç»´ç æ‰«æçš„ç»“æœå¿…å®šæ˜¯ä¸€ä¸ªå¯ä»¥è®¿é—®çš„è¶…é“¾æ¥</b></p><p>è¿™ä¸ªåº”è¯¥æ˜¯æ²¡äººåé©³çš„ã€‚</p><p>ä¹‹æ‰€ä»¥è¿™ä¹ˆå®šä¹‰ï¼Œæœ‰ä¸¤ç‚¹ä¼˜åŠ¿ã€‚ç¬¬ä¸€ï¼Œç”¨æˆ·ä½“éªŒå’Œå¯¼æµä¸Šï¼Œå¯ä»¥åšåˆ°æ›´å¥½ï¼Œå…·ä½“ä¸Šé¢çš„åˆ†æä¸­ä¹Ÿæåˆ°ï¼Œå°±ä¸å†èµ˜è¿°ï¼›ç¬¬äºŒï¼Œåœ¨ç ”å‘ä¸Šï¼Œé€šè¿‡è¶…é“¾æ¥ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†åŠŸèƒ½é›†æˆåˆ°æˆ‘ä»¬çš„è·¯ç”±æ¨¡å—ï¼Œå½“ç„¶è¿™é‡Œä¹Ÿæœ‰å…¶ä»–çš„æ–¹æ³•ï¼Œä¸è¿‡ä¹ŸåŒæ ·æ˜¯ä¸ºäº†å¤„ç†æ‰«ç ç»“æœæ¥å®šä¹‰çš„ã€‚</p><center><br><img src="http://cdn.yuhanle.com/Elegant-design-scan-function/router.001.png" alt="è·¯ç”±æ¨¡å—çš„è€¦åˆè®¾è®¡" title="è·¯ç”±æ¨¡å—çš„è€¦åˆè®¾è®¡"><br><br></center><center><br>è·¯ç”±æ¨¡å—çš„è€¦åˆè®¾è®¡<br></center><p>ä¸Šå›¾ä¸­ï¼Œæ‰«ä¸€æ‰«åŠŸèƒ½é€šè¿‡è¶…é“¾æ¥çš„å½¢å¼ï¼Œå¯ä»¥ç›´æ¥æ•´åˆåˆ°è·¯ç”±æ¨¡å—ä¸­ï¼Œ<b>é€šè¿‡scheme çš„æ–¹å¼ï¼Œå…ˆå°†åŸŸå æ›¿æ¢æˆ è‡ªå®šä¹‰çš„schemeï¼Œå¦‚æœè·¯ç”±æ¨¡å—å¯ä»¥å¤„ç†å°±ä¸¢è¿‡å»å¤„ç†ï¼Œä¸èƒ½å¤„ç†çš„æƒ…å†µä¸‹ï¼Œå°±é€šè¿‡APP å†…éƒ¨çš„æµè§ˆå™¨æ‰“å¼€è¯¥é“¾æ¥ï¼Œå…¶ä»–é€»è¾‘çš„æ“ä½œå°±ä¸¢ç»™web é¡µé¢å¤„ç†ï¼Œæ¯”å¦‚å¼•å¯¼ç”¨æˆ·åˆ°å®˜ç½‘ï¼Œæé†’ç”¨æˆ·ä¸‹è½½åº”ç”¨</b>ï¼Œç­‰ä¸€äº›é”™è¯¯çš„å¤„ç†ã€‚</p><p><b>2.ä¸ºäº†æ›´å¥½åœ°å…¼å®¹æ‰«ç åŠŸèƒ½ï¼Œåšä¸€äº›ä¼˜åŒ– </b></p><center><br><img src="http://cdn.yuhanle.com/Elegant-design-scan-function/router.002.png" alt="è·¯ç”±æ¨¡å—çš„æ‰«ç åŠŸèƒ½ä¼˜åŒ–" title="è·¯ç”±æ¨¡å—çš„æ‰«ç åŠŸèƒ½ä¼˜åŒ–"><br></center><center>è·¯ç”±æ¨¡å—çš„æ‰«ç åŠŸèƒ½ä¼˜åŒ–</center><p>è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠä¸€äº›é€šç”¨çš„å¤„ç†æ“ä½œï¼Œé€šè¿‡ç±»åˆ«æˆ–è€…ä»£ç†åè®®çš„æ–¹æ³•ï¼ŒæŒ‰åŠŸèƒ½åˆ†åˆ«æ·»åŠ åˆ°è·¯ç”±æ¨¡å—ä¸­ï¼Œè¿™ç§ä¼˜åŒ–ä¸ä»…ä¼˜åŒ–äº†æ‰«ä¸€æ‰«çš„åŠŸèƒ½ï¼Œä¹ŸåŒæ—¶ä¼˜åŒ–äº†å…¶ä»–å„æ¨¡å—ä½¿ç”¨è·¯ç”±æ¨¡å—çš„é€»è¾‘ã€‚</p><h3 id="é‚£æˆ‘ä»¬å¯ä»¥å¼€å§‹ç€æ‰‹ç ”å‘äº†"><a href="#é‚£æˆ‘ä»¬å¯ä»¥å¼€å§‹ç€æ‰‹ç ”å‘äº†" class="headerlink" title="é‚£æˆ‘ä»¬å¯ä»¥å¼€å§‹ç€æ‰‹ç ”å‘äº†"></a>é‚£æˆ‘ä»¬å¯ä»¥å¼€å§‹ç€æ‰‹ç ”å‘äº†</h3><h4 id="é€‚ç”¨ç¯å¢ƒ"><a href="#é€‚ç”¨ç¯å¢ƒ" class="headerlink" title="é€‚ç”¨ç¯å¢ƒ"></a>é€‚ç”¨ç¯å¢ƒ</h4><p>Webæˆ–å…¶ä»–åº”ç”¨è°ƒç”¨XXXåº”ç”¨ç‰¹å®šåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨äºåº”ç”¨å†…éƒ¨åŠŸèƒ½è·³è½¬</p><h4 id="æ”¯æŒç³»ç»Ÿ"><a href="#æ”¯æŒç³»ç»Ÿ" class="headerlink" title="æ”¯æŒç³»ç»Ÿ"></a>æ”¯æŒç³»ç»Ÿ</h4><p>iOSï¼ŒAndroidï¼ŒH5</p><p>å¦‚æœ‰å› ç³»ç»Ÿç‰¹æ€§å¯¼è‡´çš„ä¸ä¸€è‡´ï¼Œåœ¨åè®®ä¸­è¯¦ç»†åˆ—å‡º</p><h4 id="è°ƒç”¨æ–¹å¼"><a href="#è°ƒç”¨æ–¹å¼" class="headerlink" title="è°ƒç”¨æ–¹å¼"></a>è°ƒç”¨æ–¹å¼</h4><h5 id="Webç«¯"><a href="#Webç«¯" class="headerlink" title="Webç«¯"></a>Webç«¯</h5><p><a href="http://appwebv2.xxx.cn/" target="_blank" rel="noopener">http://appwebv2.xxx.cn/</a><action>/?parms (å¼€å‘æµ‹è¯•ç¯å¢ƒä¸ºappwebv2test.xxx.cn)</action></p><h5 id="Appç«¯"><a href="#Appç«¯" class="headerlink" title="Appç«¯"></a>Appç«¯</h5><p>xxxapp://<action>/?params</action></p><p>Web è°ƒç”¨ç«¯éœ€è¦å…ˆåˆ¤æ–­XXXåº”ç”¨æ˜¯å¦å·²ç»å®‰è£…<br>å¦‚å·²å®‰è£…ï¼Œåˆ™é€šè¿‡xxxapp://è°ƒç”¨<br>å¦‚æœªå®‰è£…ï¼Œè§†å®é™…å®šä¹‰åŠåŠŸèƒ½ï¼Œé€šè¿‡webè°ƒç”¨æˆ–è€…æç¤ºç”¨æˆ·ä¸‹è½½åº”ç”¨</p><p>App ç«¯éœ€è¦å…ˆé€šè¿‡xxxapp:// è·¯ç”±</p><p>å¦‚æœæœ¬åœ°å·²ç»æ³¨å†Œï¼Œç»§ç»­æ‰§è¡Œ</p><p>æ²¡æœ‰æ³¨å†Œï¼Œç›´æ¥é€šè¿‡åº”ç”¨å†…æµè§ˆå™¨æ‰“å¼€ Web é¡µé¢ï¼ˆéœ€è¦åŒ¹é…æ¨¡æ¿å¡«å……å¿…è¦å‚æ•°ï¼‰</p><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p><a href="http://appwebv2.xxx.cn/action/bind/bike/{bikeid}/" target="_blank" rel="noopener">http://appwebv2.xxx.cn/action/bind/bike/{bikeid}/</a>?<font color="red">appversion={version}&amp;platform={platform}&amp;xxxkey={xxxkey}</font></p><p>é“¾æ¥å‰åŠéƒ¨åˆ†ï¼Œç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œåé¢çº¢è‰²éƒ¨åˆ†å‚æ•°éœ€è¦å®¢æˆ·ç«¯åœ¨ä¸èƒ½æ­£å¸¸é€šè¿‡è·¯ç”±æ‰“å¼€è¯¥åŠŸèƒ½ï¼Œè°ƒç”¨æµè§ˆå™¨æ—¶æ‹¼æ¥åœ¨ url é‡Œã€‚</p><p>åé¢çº¢è‰²éƒ¨åˆ†å‚æ•°ï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ¨¡æ¿é“¾æ¥åŒ¹é…å¡«å……ï¼Œç„¶åç”ŸæˆäºŒç»´ç å±•ç¤ºã€‚</p><h5 id="å¿…è¦å‚æ•°"><a href="#å¿…è¦å‚æ•°" class="headerlink" title="å¿…è¦å‚æ•°"></a>å¿…è¦å‚æ•°</h5><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>action/</td><td>Router</td><td>æ­¤è·¯ç”±æ˜¯action è¡¨ç¤ºè¯¥é“¾æ¥æ˜¯è¦å®ç°æŸåŠŸèƒ½</td></tr><tr><td>bind</td><td>String</td><td>è¡¨ç¤ºç»‘å®šçš„æ“ä½œ</td></tr><tr><td>bike</td><td>String</td><td>è¡¨ç¤ºè¦ç»‘å®šçš„æ˜¯è½¦</td></tr><tr><td>bikeid</td><td>String</td><td>éœ€è¦å¤„ç†çš„å‚æ•°</td></tr></tbody></table><h3 id="åŠŸèƒ½å·²ç»å®ç°"><a href="#åŠŸèƒ½å·²ç»å®ç°" class="headerlink" title="åŠŸèƒ½å·²ç»å®ç°"></a>åŠŸèƒ½å·²ç»å®ç°</h3><p>æŒ‰ç…§ä¸Šé¢çš„å®šä¹‰å’Œé€»è¾‘ï¼Œæ‰«ä¸€æ‰«çš„åŠŸèƒ½å·²ç»å¯ä»¥æ®æ­¤å®šä¹‰ç Œç –å®ç°ã€‚å¯¹äºè·¯ç”±çš„åŠŸèƒ½ï¼Œå¯ä»¥æœ¬åœ°å®ç°ï¼Œä¹Ÿå¯ä»¥åƒè˜‘è‡è¡—é‚£æ ·ï¼Œé€šè¿‡åå°çš„é…ç½®å¯ä»¥éšæ—¶æ›´æ”¹å¤„ç†æ“ä½œã€‚</p><p>äºæ˜¯ï¼Œweb ç«¯å‡†å¤‡äº†ä¸€ä¸ªé¡µé¢ï¼Œè¶…é“¾æ¥æ˜¯ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://appwebv2.xxx.cn/action/bind/bike</span><br></pre></td></tr></table></figure><p>ç”ŸæˆäºŒç»´ç ä¹‹å‰ï¼ŒæœåŠ¡ç«¯ç»™äº†ä½ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå†…å®¹æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://appwebv2.xxx.cn/action/bind/bike/11234/?appversion=&#123;version&#125;&amp;platform=&#123;platform&#125;&amp;xxxkey=&#123;xxxkey&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯æ ¹æ®å­—ç¬¦ä¸²ï¼Œé€šè¿‡åŒ¹é…å’Œå¡«å……ï¼Œç”Ÿæˆä¸€ä¸ªäºŒç»´ç </p><center><br><img src="http://cdn.yuhanle.com/Elegant-design-scan-function/qr_result.png" alt="ç”ŸæˆäºŒç»´ç " title="ç”ŸæˆäºŒç»´ç "><br></center><center>ç”ŸæˆäºŒç»´ç </center><p>äºŒç»´ç çš„å®é™…ç»“æœå°±æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://appwebv2.xxx.cn/action/bind/bike/11234/?appversion=V1.0&amp;platform=iOS&amp;xxxkey=3a10362d077cd27b5f2c537e1ff2fc48</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œé€šè¿‡XXX åº”ç”¨æ‰«ç ï¼Œå°±ä¼šè°ƒç”¨æ·»åŠ è½¦è¾†çš„åŠŸèƒ½ã€‚<br>é€šè¿‡ç¬¬ä¸‰æ–¹APP æ‰«ç çš„è¯ï¼Œä¼šå…ˆæ‰“å¼€æµè§ˆå™¨ï¼Œweb é¡µé¢ä¼šå†é€šè¿‡ç³»ç»Ÿæ–¹æ³•å…ˆå°è¯•è°ƒç”¨XXX åº”ç”¨ï¼Œå¦‚æœä¸èƒ½è°ƒèµ·ï¼Œå°±æé†’ç”¨æˆ·å»å•†åº—ä¸‹è½½ï¼Œå¦‚æœèƒ½è°ƒèµ·åº”ç”¨ï¼ŒXXX åº”ç”¨åœ¨å¯åŠ¨ä»¥åï¼Œé€šè¿‡è·¯ç”±æ¨¡å—å¤„ç†ï¼Œé¦–å…ˆè·³è½¬åˆ°æ‰«ä¸€æ‰«ç•Œé¢ï¼Œç„¶åè°ƒç”¨æ·»åŠ è½¦è¾†çš„åŠŸèƒ½ï¼Œå¦‚æœè·¯ç”±æ— æ³•å¤„ç†è¿™ä¸ªhttp è¶…é“¾æ¥ï¼Œå°±ä¼šè°ƒç”¨æµè§ˆå™¨å†åŠ è½½è¿™ä¸ªweb é¡µé¢ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘è„‘æµ·é‡Œèƒ½æƒ³åˆ°çš„åŸºæœ¬åˆ†æå®Œäº†ï¼Œå¦‚æœæœ‰æ›´å¥½çš„æƒ³æ³•æˆ–å»ºè®®ï¼Œè¯·è‰¾ç‰¹æˆ‘~ æ–°æµªå¾®åšï¼š<a href="http://weibo.com/2621837475/profile?topnav=1&amp;wvr=6&amp;is_all=1" target="_blank" rel="noopener">ç…œå¯’äº†</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å½“å‰äºŒç»´ç åœ¨ç”Ÿæ´»ä¸­éšå¤„å¯è§ï¼Œä»–çš„åŠŸèƒ½æ— éœ€å¤šè¨€ï¼Œå½»åº•çš„æ”¹å˜äº†æ¶ˆè´¹è€…çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œæå‡äº†ç”¨æˆ·çš„æ“ä½œä½“éªŒï¼ŒåŒæ—¶ä¹Ÿæ‹‰è¿‘äº†äººä¸äººï¼Œäººä¸ç‰©ä¹ƒè‡³ç‰©ä¸ç‰©ä¹‹é—´çš„è·ç¦»
    
    </summary>
    
      <category term="mobile" scheme="https://blog.yuhanle.com/categories/mobile/"/>
    
    
      <category term="scan" scheme="https://blog.yuhanle.com/tags/scan/"/>
    
  </entry>
  
  <entry>
    <title>ObjC&amp;JavaScript äº¤äº’ï¼Œåœ¨æ°å½“çš„æ—¶æœºæ³¨å…¥å¯¹è±¡</title>
    <link href="https://blog.yuhanle.com/2016/11/30/oc-js-inpourjs-in-goodtime/"/>
    <id>https://blog.yuhanle.com/2016/11/30/oc-js-inpourjs-in-goodtime/</id>
    <published>2016-11-30T00:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.338Z</updated>
    
    <content type="html"><![CDATA[<p>è­¦å‘Šï¼šæ–‡ç« ä¸­æåˆ°çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)webView:(id)unuse didCreateJavaScriptContext:(JSContext *)ctx forFrame:(id)frame;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•æ¶‰åŠç§æœ‰APIï¼Œæœ‰ç½‘å‹åé¦ˆè¯´å®¡æ ¸ä¼šè¢«æ‹’ç»ï¼Œå¸Œæœ›çœ‹åˆ°çš„æœ‹å‹ä»¬æ…ç”¨</p><p>ç§»åŠ¨ç«¯é¡¹ç›®å¼€å‘ä¸­ï¼Œå…ä¸äº†å‡ºç° Native App ï¼ˆä»¥ä¸‹ç®€ç§°Nativeï¼‰å’Œ H5 é¡µé¢ï¼ˆä»¥ä¸‹ç®€ç§°H5ï¼‰çš„äº¤äº’ï¼Œç½‘ç»œä¸Šæœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œæ¯”å¦‚<a href="https://github.com/marcuswestin/WebViewJavascriptBridge" target="_blank" rel="noopener">WebViewJavascriptBridge</a>ï¼Œå¯¹äºä¸€äº›å°çš„é¡¹ç›®éœ€æ±‚æ¥è¯´ï¼Œå…¶å®ä¸ç”¨é‚£ä¹ˆéº»çƒ¦ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆä»åŸºç¡€ç€æ‰‹ã€‚<a id="more"></a></p><p><img src="http://cdn.yuhanle.com/inpurejs-in-goodtime/16.jpg" alt="å›¾æ–‡æ— å…³"></p><h2 id="å…ˆäº†è§£å‡ ä¸ªåŸºç¡€æ–¹æ³•"><a href="#å…ˆäº†è§£å‡ ä¸ªåŸºç¡€æ–¹æ³•" class="headerlink" title="å…ˆäº†è§£å‡ ä¸ªåŸºç¡€æ–¹æ³•"></a>å…ˆäº†è§£å‡ ä¸ªåŸºç¡€æ–¹æ³•</h2><ul><li>ç½‘é¡µå³å°†åŠ è½½ï¼ˆæœ€å…ˆæ‰§è¡Œçš„ä»£ç†æ–¹æ³•ï¼‰ï¼Œåœ¨æ¯æ¬¡load é¡µé¢çš„æ—¶å€™éƒ½ä¼šå…ˆèµ°è¿™ä¸ªå›è°ƒï¼Œå¯ä»¥åœ¨æ­¤åšä¸€äº›è‡ªå·±çš„æ“ä½œï¼Œç»å¸¸ä¼šåœ¨è¿™å„¿æ‹¦æˆªåè®®</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType &#123; </span><br><span class="line">    // do something...</span><br><span class="line">    </span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç½‘é¡µå·²ç»åŠ è½½å®Œæˆï¼ˆæœ€åæ‰§è¡Œçš„ä»£ç†æ–¹æ³•ï¼‰ï¼Œæ‰§è¡Œåˆ°è¿™ä¸ªåœ°æ–¹ï¼Œweb é¡µé¢å·²ç»åŠ è½½å®Œæˆï¼Œç›¸å…³ä»£ç ä¹Ÿéƒ½æ‰§è¡Œå®Œæ¯•</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (void)webViewDidFinishLoad:(UIWebView *)webView &#123;</span><br><span class="line">    // åŠ è½½å®Œæˆ éšè—HUD</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ ¹æ®ä¸åŒçš„åœºæ™¯ï¼Œæ‰¾ä¸€ä¸ªæœ€åˆé€‚çš„æ–¹æ³•"><a href="#æ ¹æ®ä¸åŒçš„åœºæ™¯ï¼Œæ‰¾ä¸€ä¸ªæœ€åˆé€‚çš„æ–¹æ³•" class="headerlink" title="æ ¹æ®ä¸åŒçš„åœºæ™¯ï¼Œæ‰¾ä¸€ä¸ªæœ€åˆé€‚çš„æ–¹æ³•"></a>æ ¹æ®ä¸åŒçš„åœºæ™¯ï¼Œæ‰¾ä¸€ä¸ªæœ€åˆé€‚çš„æ–¹æ³•</h2><h3 id="åœºæ™¯1"><a href="#åœºæ™¯1" class="headerlink" title="åœºæ™¯1"></a>åœºæ™¯1</h3><blockquote><p>ï¼ˆH5 é€šä¿¡ Nativeï¼Œå‘ŠçŸ¥Native è¦åšçš„äº‹å„¿ï¼‰</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">H5 é¡µé¢åœ¨æŸä¸ªæ ‡ç­¾ç‚¹å‡»åï¼Œè¦å…³é—­å½“å‰åŠ è½½ç½‘é¡µçš„æ§åˆ¶å™¨VC</span><br></pre></td></tr></table></figure><p>éœ€æ±‚åˆ†æï¼š</p><blockquote><p>è¿™åº”è¯¥ä¸æ˜¯æœ€ç®€å•çš„ä¸€ä¸ªéœ€æ±‚ï¼Œæœ€ç®€å•çš„æ˜¯Native é€šè¿‡url ç»™H5 é¡µé¢ä¼ å‚æ•°ï¼Œå‘ŠçŸ¥H5 è¦åšçš„äº‹å„¿ã€‚</p><p>è¿™ä¸ªéœ€æ±‚ä¸­ï¼ŒH5 é¡µé¢å·²ç»åŠ è½½å®Œæ¯•ï¼Œæ­¤æ—¶å¯ä»¥è¯´H5 é¡µé¢ç›¸å…³çš„Bug å’ŒUI ç¼ºé™·éƒ½ä¸Native æ— å…³ï¼Œæˆ‘æ¯æ¬¡éƒ½æ˜¯è¿™ä¹ˆè·Ÿæµ‹è¯•äººå‘˜è®²ï¼Œç±»ä¼¼é—®é¢˜ç›´æ¥assign ç»™ä»–ä»¬ã€‚</p></blockquote><p>åŠŸèƒ½å®ç°ï¼š</p><blockquote><p>å¯¹äºè¿™ç±»æ¯”è¾ƒç®€å•çš„éœ€æ±‚ï¼Œæœ€å¸¸ç”¨çš„åšæ³•å°±æ˜¯ï¼Œé€šè¿‡æ‹¦æˆªåè®®çš„æ–¹æ³•ï¼Œåœ¨ç‚¹å‡»æ ‡ç­¾çš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨è‡ªå®šä¹‰åè®®çš„è¶…é“¾æ¥ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ª <code>yuhanle://action/close</code>çš„é“¾æ¥ï¼Œåœ¨é¡µé¢å³å°†load çš„æ—¶å€™ï¼Œåˆ¤æ–­url çš„åè®®ï¼Œå¦‚æœåè®®æ˜¯ <code>yuhanle</code>ï¼Œå°±æ‹¦æˆªæ‰è¿™ä¸ªè¯·æ±‚ï¼Œåšè‡ªå·±çš„å¤„ç†ã€‚</p></blockquote><p>å›¾è§£ï¼š</p><p><img src="http://cdn.yuhanle.com/inpurejs-in-goodtime/brokenrule.001.png" alt></p><h3 id="åœºæ™¯2"><a href="#åœºæ™¯2" class="headerlink" title="åœºæ™¯2"></a>åœºæ™¯2</h3><blockquote><p>ï¼ˆH5 è°ƒç”¨ Native App çš„JS æ–¹æ³•ï¼ŒåŒ…æ‹¬åŒæ­¥å’Œå¼‚æ­¥æ“ä½œï¼‰</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">H5 é¡µé¢åœ¨åŠ è½½è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä»Native ä¸­å–å¾—éƒ¨åˆ†æ•°æ®ï¼Œæˆ–è°ƒç”¨æŸä¸ªåŠŸèƒ½ï¼Œå‡åŒ…å«åŒæ­¥</span><br><span class="line">æ“ä½œæˆ–å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚åªæ˜¯ç®€å•çš„è·å–tokenï¼Œåˆ™ç›´æ¥åŒæ­¥è¿”å›ï¼Œå¦‚æœéœ€è¦Native å¼‚</span><br><span class="line">æ­¥æ‹¿åˆ°ç»“æœï¼ŒNative åˆ™éœ€è¦è€ƒè™‘ JSExport ä¸­çš„çº¿ç¨‹é—®é¢˜</span><br></pre></td></tr></table></figure><p>éœ€æ±‚åˆ†æï¼š</p><blockquote><p>è¿™ä¸ªéœ€æ±‚ä¸­è‚¯å®šéœ€è¦Native æ³¨å…¥JS æ–¹æ³•ï¼ŒH5 é€šè¿‡è°ƒç”¨JS å’ŒNative é€šä¿¡ï¼Œå…¶ä¸­åŒ…æ‹¬åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§æƒ…å†µä¸‹çš„å¤„ç†ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯å¼‚æ­¥æ“ä½œæ—¶ï¼ŒH5 éœ€è¦åœ¨è°ƒç”¨ App æ—¶ä¼ å…¥ä¸€ä¸ª JS æ–¹æ³•åï¼ŒApp åœ¨æ‹¿åˆ°æ•°æ®åå¯ä»¥å›è°ƒ H5 çš„JS æ–¹æ³•ï¼Œåœ¨è°ƒç”¨è¿™ä¸ªå›è°ƒçš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨webView çš„currentThreadï¼Œä¸ç„¶å°±ä¼šå‡ºç°é¡µé¢å¡æ­»ã€‚</p></blockquote><p>åŠŸèƒ½å®ç°ï¼š</p><blockquote><p>1- å®šä¹‰ä¸€ä¸ªç±»ï¼Œç”¨äºæ³¨å…¥è¿™ä¸ªå¯¹è±¡</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// æ­¤æ¨¡å‹ç”¨äºæ³¨å…¥JSçš„æ¨¡å‹ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡æ¨¡å‹æ¥è°ƒç”¨æ–¹æ³•ã€‚</span><br><span class="line">@interface QWSJsObjCModel : NSObject &lt;JavaScriptObjectiveCDelegate&gt;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, weak) JSContext *jsContext;</span><br><span class="line">@property (nonatomic, weak) UIWebView *webView;</span><br><span class="line">@property (nonatomic, weak) G100WebViewController * webVc;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><blockquote><p>2- å£°æ˜åè®®ï¼Œå®ç°å’ŒJS å¯¹åº”çš„æ–¹æ³•</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;JavaScriptCore/JavaScriptCore.h&gt;</span><br><span class="line"></span><br><span class="line">@protocol JavaScriptObjectiveCDelegate &lt;JSExport&gt;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  è·å–å®¢æˆ·ç«¯çš„token</span><br><span class="line"> *</span><br><span class="line"> *  @param qwsKey å®¢æˆ·ç«¯ç”Ÿæˆçš„å¯†ç key</span><br><span class="line"> *</span><br><span class="line"> *  @return è¿”å›å€¼token</span><br><span class="line"> */</span><br><span class="line">- (NSString *)getToken:(NSString *)qwsKey;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  H5 ä¼ é€’key è·å–newToken åœ¨è°ƒç”¨å…¶ callback æ–¹æ³•</span><br><span class="line"> *</span><br><span class="line"> *  @param key      qwskey</span><br><span class="line"> *  @param callback å›è°ƒæ–¹æ³•å</span><br><span class="line"> *  @param property æ–¹æ³•å‚æ•°</span><br><span class="line"> */</span><br><span class="line">- (void)getNewToken:(NSString *)key callback:(NSString *)callback property:(NSString *)property;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  H5 åœ¨åŠ è½½å®Œæˆå å‘Šè¯‰å®¢æˆ·ç«¯åœ¨è¿”å›çš„æ—¶å€™è°ƒç”¨è¯¥æ–¹æ³•</span><br><span class="line"> *</span><br><span class="line"> *  @param callback js æ–¹æ³•å</span><br><span class="line"> */</span><br><span class="line">- (void)getExitMsgCallback:(NSString *)callback;</span><br></pre></td></tr></table></figure><blockquote><p>3- æˆ‘ä»¬éœ€è¦åœ¨æ‰“å¼€webView çš„æ—¶å€™ï¼Œæ‰¾åˆ°ä¸€ä¸ªå¥½çš„æ—¶æœºæ³¨å…¥ JS</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// é¦–å…ˆæ‹¿åˆ°JSContext</span><br><span class="line">self.jsContext = [_jsWebView valueForKeyPath:@&quot;documentView.webView.mainFrame.javaScriptContext&quot;];</span><br><span class="line">   // é€šè¿‡æ¨¡å‹è°ƒç”¨æ–¹æ³•ï¼Œè¿™ç§æ–¹å¼æ›´å¥½äº›ã€‚</span><br><span class="line">   QWSJsObjCModel *model  = [[QWSJsObjCModel alloc] init];</span><br><span class="line">   self.jsContext[@&quot;nativeObj&quot;] = model;</span><br><span class="line">   model.jsContext = self.jsContext;</span><br><span class="line">   model.webView = _jsWebView;</span><br><span class="line">   </span><br><span class="line">   self.jsContext[@&quot;getUserinfo&quot;] = ^()&#123;</span><br><span class="line">       return @&quot;1234&quot;;</span><br><span class="line">   &#125;;</span><br><span class="line">   </span><br><span class="line">   self.jsContext.exceptionHandler = ^(JSContext *context, JSValue *exceptionValue) &#123;</span><br><span class="line">       context.exception = exceptionValue;</span><br><span class="line">       NSLog(@&quot;å¼‚å¸¸ä¿¡æ¯ï¼š%@&quot;, exceptionValue);</span><br><span class="line">   &#125;;</span><br></pre></td></tr></table></figure><blockquote><p>4- å¯¹åº”H5 é¡µé¢çš„JS å®šä¹‰åŠè°ƒç”¨</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;æµ‹è¯•IOSä¸JSä¹‹å‰çš„äº’è°ƒ&lt;/title&gt;</span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">  * &#123;</span><br><span class="line">  font-size: 40px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">  &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">  var jsFunc = function() &#123;</span><br><span class="line">    alert(&apos;Objective-C call js to show alert&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  var jsParamFunc = function(argument) &#123;</span><br><span class="line">    document.getElementById(&apos;jsParamFuncSpan&apos;).innerHTML</span><br><span class="line">    = argument[&apos;name&apos;];</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  </span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  </span><br><span class="line">&lt;div style=&quot;margin-top: 100px&quot;&gt;</span><br><span class="line">&lt;h1&gt;Test how to use objective-c call js&lt;/h1&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; value=&quot;getToken&quot; onclick=&quot;alert(nativeObj.getToken())&quot;&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; value=&quot;Call ObjC system alert&quot; onclick=&quot;nativeObj.showAlertMsg(&apos;js title&apos;, &apos;js message&apos;)&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; value=&quot;Call ObjC func with JSON &quot; onclick=&quot;nativeObj.callWithDict(&#123;&apos;name&apos;: &apos;testname&apos;, &apos;age&apos;: 10, &apos;height&apos;: 170&#125;)&quot;&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; value=&quot;Call ObjC func with JSON and ObjC call js func to pass args.&quot; onclick=&quot;nativeObj.jsCallObjcAndObjcCallJsWithDict(&#123;&apos;name&apos;: &apos;testname&apos;, &apos;age&apos;: 10, &apos;height&apos;: 170&#125;)&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;a href=&quot;test1.html&quot;&gt;Click to next page&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line">&lt;span id=&quot;jsParamFuncSpan&quot; style=&quot;color: red; font-size: 50px;&quot;&gt;&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§ä»¥ä¸Šçš„åšæ³•ï¼Œå°±èƒ½è¾¾åˆ°Native å’ŒH5 ä¹‹é—´çš„ç›¸äº’é€šä¿¡ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œåœ¨ä»€ä¹ˆæ—¶å€™æ³¨å…¥JS å¯¹è±¡ï¼Œæ‰èƒ½æ»¡è¶³H5 é¡µé¢çš„éœ€æ±‚ï¼Œå› ä¸ºå®é™…æƒ…å†µä¸­ï¼ŒH5 é¡µé¢å¯èƒ½ä¼šéšæ—¶è°ƒç”¨ä½ çš„JSã€‚</p><h3 id="éœ€è¦æ³¨æ„çš„å‡ ä¸ªé—®é¢˜"><a href="#éœ€è¦æ³¨æ„çš„å‡ ä¸ªé—®é¢˜" class="headerlink" title="éœ€è¦æ³¨æ„çš„å‡ ä¸ªé—®é¢˜"></a>éœ€è¦æ³¨æ„çš„å‡ ä¸ªé—®é¢˜</h3><p>1- åœºæ™¯2 ä¸­æˆ‘ä»¬æåˆ°çš„ï¼Œå¼‚æ­¥è°ƒç”¨æ—¶çš„çº¿ç¨‹é—®é¢˜ é¦–å…ˆçœ‹ä¸‹ä¸‹é¢çš„ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- (void)getNewToken:(NSString *)key callback:(NSString *)callback property:(NSString *)property &#123;</span><br><span class="line">    if (_webVc) &#123;</span><br><span class="line">        if ([_webVc.qwsKey isEqualToString:key]) &#123;</span><br><span class="line">            </span><br><span class="line">            __block NSString * newToken = @&quot;&quot;;</span><br><span class="line">            __block NSInteger result = 0;</span><br><span class="line">            </span><br><span class="line">            [[UserManager shareManager] autoLoginWithComplete:^(NSInteger statusCode, ApiResponse *response, BOOL requestSuccess) &#123;</span><br><span class="line">                if (requestSuccess) &#123;</span><br><span class="line">                    newToken = [[G100InfoHelper shareInstance] token];</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    newToken = @&quot;error&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                result = requestSuccess ? response.errCode : statusCode;</span><br><span class="line">                </span><br><span class="line">                JSValue * function = self.jsContext[callback];</span><br><span class="line">                NSArray * params = @[@(result), newToken, property];</span><br><span class="line">                [function callWithArguments:params];</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ï¼Œå°±æ˜¯æƒ³åœ¨H5 é¡µé¢è°ƒç”¨çš„æ—¶å€™ï¼ŒApp è¿™è¾¹è‡ªåŠ¨ç™»é™†ï¼Œé‡æ–°è·å–åˆ°æœ€æ–°çš„tokenï¼Œæ‹¿åˆ°ç»“æœä»¥åå¹¶å›è°ƒH5ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸Šæ˜¯å¼‚æ­¥çš„ï¼Œçœ‹èµ·æ¥æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯ä¸€æ—¦å®é™…æ“ä½œèµ·æ¥ï¼Œä¼šåœ¨è¿™é‡Œå¡æ­»ã€‚å…·ä½“åŸå› ï¼Œæˆ‘ä¹Ÿä¸å¥½è§£é‡Šï¼Œè§£å†³åŠæ³•æ˜¯æœ‰çš„ï¼Œåªèƒ½é€šè¿‡webView çš„currentThread æ¥æ‰§è¡Œperform æ“ä½œã€‚</p><p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">- (void)getNewToken:(NSString *)key callback:(NSString *)callback property:(NSString *)property &#123;</span><br><span class="line">    if (_webVc) &#123;</span><br><span class="line">        if ([_webVc.qwsKey isEqualToString:key]) &#123;</span><br><span class="line">            </span><br><span class="line">            __block NSString * newToken = @&quot;&quot;;</span><br><span class="line">            __block NSInteger result = 0;</span><br><span class="line">            NSThread * webThread = [NSThread currentThread];</span><br><span class="line">            </span><br><span class="line">            [[UserManager shareManager] autoLoginWithComplete:^(NSInteger statusCode, ApiResponse *response, BOOL requestSuccess) &#123;</span><br><span class="line">                if (requestSuccess) &#123;</span><br><span class="line">                    newToken = [[G100InfoHelper shareInstance] token];</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    newToken = @&quot;error&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                result = requestSuccess ? response.errCode : statusCode;</span><br><span class="line">                // è¿™é‡Œé€šè¿‡æ­¤æ–¹æ³• åœ¨å½“å‰çº¿ç¨‹æ“ä½œæ‰ä¸ä¼šé€ æˆå¡æ­»çš„ç°è±¡</span><br><span class="line">                [self performSelector:@selector(callQWSJSWithArgument:) onThread:webThread withObject:@[callback, @(result), newToken, property] waitUntilDone:NO];</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)callQWSJSWithArgument:(NSArray *)argument &#123;</span><br><span class="line">    NSString * callback = argument[0];</span><br><span class="line">    JSValue * function = self.jsContext[callback];</span><br><span class="line">    </span><br><span class="line">    NSMutableArray * params = [NSMutableArray arrayWithArray:argument];</span><br><span class="line">    // ç§»é™¤ç¬¬ä¸€ä¸ª æ–¹æ³•å</span><br><span class="line">    [params removeObjectAtIndex:0];</span><br><span class="line">    [function callWithArguments:params];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2- åŒæ ·æ˜¯åœºæ™¯2 ä¸­çš„ä¸€ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæ—¶å€™æ³¨å…¥å¯¹è±¡</p><p>éœ€æ±‚æ€»æ˜¯è™šæ— ç¼¥ç¼ˆçš„ï¼Œå¯¹äºH5 ç»“åˆ Native çš„å¼€å‘ç»“æ„ä¸­ï¼ŒNative å§‹ç»ˆæ‰®æ¼”ç€æœåŠ¡å’Œå…¥å£çš„è§’è‰²ï¼ŒH5 å¯èƒ½éšæ—¶éƒ½ä¼šä¸»åŠ¨å’ŒNative é€šä¿¡ï¼Œä½†æ˜¯Native åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™å‡†å¤‡å¥½è¿™äº›æœåŠ¡å‘¢ï¼Ÿ</p><p>çœ‹äº†å¾ˆå¤šç½‘ä¸Šçš„èµ„æ–™ï¼Œå‡ ä¹å…¨éƒ¨éƒ½æ˜¯åœ¨é¡µé¢åŠ è½½å®Œæˆ webViewDidFinishLoad è¿™ä¸ªå›è°ƒä¸­æ³¨å…¥æ–¹æ³•ï¼Œä½†å®é™…å¼€å‘ä¸­ï¼Œå¾ˆå¤šé¡µé¢åœ¨åŠ è½½çš„æ—¶å€™å°±éœ€è¦å’ŒNative é€šä¿¡ï¼Œæ¯”å¦‚è¯´æ‹¿åˆ°tokenï¼Œå¦‚æœåœ¨è¿™ä¸ªæ—¶å€™æ‰æ³¨å…¥ï¼Œè‚¯å®šæ˜¯æ¥ä¸åŠçš„ï¼Œåªèƒ½æ— åŠŸè€Œè¿”ã€‚</p><p>ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½æ²¡å¤ªåœ¨æ„è¿™ä¸ªé—®é¢˜ï¼Œå½“ç„¶ï¼Œå¦‚æœå¼ºåˆ¶è®©H5 çš„å¼€å‘äººå‘˜ä¿®æ”¹é€»è¾‘ï¼Œå°†æ‰€æœ‰çš„é€šä¿¡éƒ½æ”¾åœ¨é¡µé¢åŠ è½½å®Œæˆä»¥ååœ¨åšï¼Œä¹Ÿæ²¡é—®é¢˜ï¼Œåªä¸è¿‡å¯¹äºç”¨æˆ·çš„ä½“éªŒä¼šå˜å¾—ç³Ÿç³•ã€‚</p><p>æ·±å…¥ç ”ç©¶å®˜æ–¹æ–‡æ¡£ï¼Œå°±ä¼šå‘ç°ï¼ŒwebView åœ¨åŠ è½½è¿‡ç¨‹ä¸­ï¼Œä¼šæ‰§è¡Œè¿™ä¹ˆä¸€ä¸ªæ–¹æ³•ï¼Œä»–çš„ä½œç”¨æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_:didCreateJavaScriptContext:for:</span><br><span class="line"></span><br><span class="line">Notifies the delegate that a new JavaScript context has been created created.</span><br></pre></td></tr></table></figure><p><img src="http://cdn.yuhanle.com/inpurejs-in-goodtime/webView_didCreateJavaScriptContext.png" alt></p><p>å…·ä½“å‚è§å®˜æ–¹æ–‡æ¡£è¯´æ˜ <a href="https://developer.apple.com/reference/webkit/webframeloaddelegate/1501462-webview?language=objc" target="_blank" rel="noopener">didCreateJavaScriptContext</a></p><p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±èƒ½åœ¨æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯çš„æ—¶å€™ï¼Œæ‹¿åˆ°JSContextï¼Œç„¶åæ³¨å…¥æˆ‘ä»¬çš„Modelã€‚</p><p>é¦–å…ˆï¼Œæ–°å»ºä¸€ä¸ªNSObject çš„Catagoryï¼Œåœ¨è¿™ä¸ªä»£ç†æ–¹æ³•ä¸­å‘é€ä¸€ä¸ªé€šçŸ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@implementation NSObject (JSTest)</span><br><span class="line"></span><br><span class="line">- (void)webView:(id)unuse didCreateJavaScriptContext:(JSContext *)ctx forFrame:(id)frame &#123;</span><br><span class="line">    [[NSNotificationCenter defaultCenter] postNotificationName:@&quot;DidCreateContextNotification&quot; object:ctx];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œåœ¨webView çš„æ§åˆ¶å™¨ä¸­ç›‘å¬è¿™ä¸ªæ¶ˆæ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    // ç›‘å¬å¯ä»¥æ³¨å…¥js æ–¹æ³•çš„é€šçŸ¥</span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(didCreateJSContext:) name:@&quot;DidCreateContextNotification&quot; object:nil];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°@selector æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - å¯ä»¥æ³¨å…¥js çš„ç›‘å¬</span><br><span class="line">- (void)didCreateJSContext:(NSNotification *)notification &#123;</span><br><span class="line">    NSString *indentifier = [NSString stringWithFormat:@&quot;indentifier%lud&quot;, (unsigned long)self.webView.hash];</span><br><span class="line">    NSString *indentifierJS = [NSString stringWithFormat:@&quot;var %@ = &apos;%@&apos;&quot;, indentifier, indentifier];</span><br><span class="line">    [self.webView stringByEvaluatingJavaScriptFromString:indentifierJS];</span><br><span class="line">    </span><br><span class="line">    JSContext *context = notification.object;</span><br><span class="line">    </span><br><span class="line">    if (![context[indentifier].toString isEqualToString:indentifier]) return;</span><br><span class="line">    </span><br><span class="line">    self.jsContext = context;</span><br><span class="line">    // é€šè¿‡æ¨¡å‹è°ƒç”¨æ–¹æ³•ï¼Œè¿™ç§æ–¹å¼æ›´å¥½äº›ã€‚</span><br><span class="line">    QWSJsObjCModel *model  = [[QWSJsObjCModel alloc] init];</span><br><span class="line">    self.jsContext[@&quot;nativeObj&quot;] = model;</span><br><span class="line">    model.jsContext = self.jsContext;</span><br><span class="line">    model.webView   = self.webView;</span><br><span class="line">    model.webVc     = self;</span><br><span class="line">    </span><br><span class="line">    self.jsContext.exceptionHandler = ^(JSContext *context, JSValue *exceptionValue) &#123;</span><br><span class="line">        context.exception = exceptionValue;</span><br><span class="line">        DLog(@&quot;å¼‚å¸¸ä¿¡æ¯ï¼š%@&quot;, exceptionValue);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æ­¤ï¼Œåº”è¯¥æ˜¯ä¸€æ¬¡æ¯”è¾ƒå®Œç¾çš„æ³¨å…¥äº†~</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è­¦å‘Šï¼šæ–‡ç« ä¸­æåˆ°çš„&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- (void)webView:(id)unuse didCreateJavaScriptContext:(JSContext *)ctx forFrame:(id)frame;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ–¹æ³•æ¶‰åŠç§æœ‰APIï¼Œæœ‰ç½‘å‹åé¦ˆè¯´å®¡æ ¸ä¼šè¢«æ‹’ç»ï¼Œå¸Œæœ›çœ‹åˆ°çš„æœ‹å‹ä»¬æ…ç”¨&lt;/p&gt;
&lt;p&gt;ç§»åŠ¨ç«¯é¡¹ç›®å¼€å‘ä¸­ï¼Œå…ä¸äº†å‡ºç° Native App ï¼ˆä»¥ä¸‹ç®€ç§°Nativeï¼‰å’Œ H5 é¡µé¢ï¼ˆä»¥ä¸‹ç®€ç§°H5ï¼‰çš„äº¤äº’ï¼Œç½‘ç»œä¸Šæœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œæ¯”å¦‚&lt;a href=&quot;https://github.com/marcuswestin/WebViewJavascriptBridge&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WebViewJavascriptBridge&lt;/a&gt;ï¼Œå¯¹äºä¸€äº›å°çš„é¡¹ç›®éœ€æ±‚æ¥è¯´ï¼Œå…¶å®ä¸ç”¨é‚£ä¹ˆéº»çƒ¦ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆä»åŸºç¡€ç€æ‰‹ã€‚
    
    </summary>
    
      <category term="iOS" scheme="https://blog.yuhanle.com/categories/iOS/"/>
    
    
      <category term="tips" scheme="https://blog.yuhanle.com/tags/tips/"/>
    
  </entry>
  
  <entry>
    <title>æ— è¨€é€æ°´ å›å¿†æ— å£°</title>
    <link href="https://blog.yuhanle.com/2016/08/21/passing-silent-silent-memories/"/>
    <id>https://blog.yuhanle.com/2016/08/21/passing-silent-silent-memories/</id>
    <published>2016-08-21T05:23:00.000Z</published>
    <updated>2021-10-21T08:18:48.338Z</updated>
    
    <content type="html"><![CDATA[<p>æ°´çš„å­˜åœ¨ï¼Œå»¶ç»­äº†äººçš„ç”Ÿå‘½ï¼Œå´éš¾ä»¥æ´—æ¶¤äººçš„å›å¿†ã€‚</p><p>åœ¨æˆ‘ä»¬å±±é‡Œï¼Œæ¯ä¸€ä¸ªå°çš„æ‘è½ï¼ŒæŸæ£µæ ‘è«ä¸‹ï¼Œå°±ä¼šæœ‰ä¸€å£äº•ï¼Œé‚£æ˜¯å±±æ³‰ã€‚æ‘è¥¿å¤´çš„å±±è„šä¸‹ï¼Œé‚£é‡Œåœ°åŠ¿ç¨é«˜ï¼Œæœ‰ä¸€æ¡ç”°é—´å°è·¯ï¼Œæ¥æ¥å¾€å¾€çš„äººä»¬æŒ‘ç€æœ¨æ¡¶ï¼Œè·¯ä¸Šæ¹¿æ¼‰æ¼‰çš„ï¼Œä»¿ä½›åˆšä¸‹è¿‡é›¨ï¼Œè®°å¿†å…¨éƒ½å°å¿ƒç¿¼ç¿¼çš„åœ¨è¿™æ¡è·¯ä¸Šç©¿æ¢­ï¼Œç”Ÿæ€•ç¢°åˆ°è·¯äººã€‚</p><a id="more"></a><p><img src="http://cdn.yuhanle.com/passing-silent-silent-memories/626c7bb4022404ceab0bc29676963198df77461598b83-jE6pBi_fw658.jpeg" alt="æ— è¨€é€æ°´"></p><p>å“‘å·´ä»Šå¤©å·²ç»æ˜¯ç¬¬ä¸‰è¶Ÿäº†ï¼Œè¿™æ‹…æ°´æŒ‘å®Œï¼Œä»–å°±èƒ½å¸¦å°ä¼™ä¼´å„¿ä»¬å»å±±ä¸Šæ‘˜èŒ¶æœï¼Œæ¯å¹´æ¸…æ˜å‰åï¼Œå±±é‡Œçš„åƒè´§å¾ˆå¤šï¼Œä½†ç”±äºæ‘é‡Œçš„è€äººæ¸æ¸ç¦»å»ï¼Œå¹´è½»äººéƒ½å¾ˆå°‘å»æ‰“æŸ´ï¼Œä¸Šå±±çš„è·¯ä¹Ÿæ²¡äº†è¸ªè¿¹ï¼Œæ®è¯´å±±ä¸Šæœ‰é‡å…½ï¼Œæ‰€æœ‰å®¶é‡Œäººéƒ½ä¸å…è®¸æˆ‘ä»¬ä¸Šå±±ç©ã€‚</p><p>å“‘å·´æ˜¯æˆ‘ä»¬å¯¹ä»–çš„ç§°å‘¼ï¼Œè™½ç„¶å¤§æˆ‘ä»¬äºŒåå¤šå²ï¼Œä½†æ˜¯å®¶é‡Œäººä»æ¥æ²¡æœ‰æ•™è¿‡æˆ‘å¦‚ä½•ç§°å‘¼ä»–ï¼Œä»–å¤©ç”Ÿä¸ä¼šè®²è¯ï¼Œèº«ä½“ç‰¹åˆ«ç˜¦å°ï¼Œä¹Ÿè®¸æ­£å› å¦‚æ­¤ï¼Œäººä»¬æ‰ä¸æ„¿æ„å»è®°ä½è¿™ä¸ªäººå§ï¼</p><p>ä»æˆ‘è®°äº‹å„¿å¼€å§‹ï¼Œæ¯å¤©æ—©ä¸Šå…­ç‚¹å¤šé’Ÿï¼Œä»–éƒ½è¦ä»æˆ‘å®¶é—¨å‰è·¯è¿‡ï¼ŒæŒ‘ç€ä¸¤ä¸ªæœ¨æ¡¶ï¼Œè™½ç„¶ä¸ä¼šè¯´è¯ï¼Œä½†æ˜¯å˜´é‡Œè¿˜å“¼å”§å“¼å”§ç€ï¼Œæ™ƒæ™ƒæ‚ æ‚ çš„è¸ä¸Šé‚£æ¡å»å¾€æ°´äº•çš„å°è·¯ï¼Œä¸ä¸€ä¼šå„¿å°±å¸¦ç€æ»¡æ»¡ä¸¤æ¡¶æ°´å›æ¥äº†ï¼Œæ¯äº²æœ‰æ—¶å€™æ­£åœ¨åšæ—©é¥­ï¼Œçœ‹è§å“‘å·´è·¯è¿‡ï¼Œå°±æ‹¿ç€æ°´ç“¢å»äº†ã€‚å“‘å·´ä¼šç”Ÿæ°”ï¼Œå› ä¸ºè¿™ç§æƒ…å†µå·²ç»ä¸æ˜¯ç¬¬ä¸€æ¬¡äº†ï¼Œæ‘é‡Œäººéƒ½å–œæ¬¢è¿™æ ·æ¬ºè´Ÿä»–ï¼Œä¹Ÿè®¸ä»–è¿™æ ·ç”Ÿæ°”ï¼Œè¢«æ‘é‡Œäººè§‰å¾—ä¸æ»¡ï¼Œå‘Šè¯‰äº†ä»–çš„æ¯äº²ã€‚</p><p><img src="http://cdn.yuhanle.com/passing-silent-silent-memories/2730025799117722348.jpg" alt="æ‰æ‹…"></p><p>å°è±¡æœ€æ·±çš„ä¸€æ¬¡ï¼Œæˆ‘è¢«ä»–æ‰“äº†ä¸€é¡¿ã€‚</p><p>æˆ‘å’Œä»–çš„å°ä¾„å„¿ä¸€å—ç©ï¼Œå°å­©å­é—´ç–¯ç–¯é—¹é—¹çš„ï¼Œä¸å°å¿ƒæŠŠä»–ä¾„å„¿æ¨åˆ°äº†ï¼Œåˆšå¥½è¢«å“‘å·´çœ‹è§äº†ï¼Œä¸Šæ¥ä¸€å·´æŒå°±æŠŠæˆ‘æ‰‡åˆ°åœ°ä¸Šï¼Œä»æ¥æ²¡æœ‰è¿™æ ·å®³æ€•è¿‡ï¼Œè¿™è¿˜æ˜¯æˆ‘è®¤è¯†çš„å“‘å·´å—ï¼Ÿä»–è™½ç„¶å¾ˆç˜¦ï¼Œä½†åŠ›æ°”å¾ˆå¤§ï¼Œæ‘é‡Œä¸å°‘å¹´è½»äººéƒ½å’Œä»–æ‰“è¿‡ï¼Œå½“ç„¶å¤§å¤šæ•°æ˜¯å’‹æ¬ºè´Ÿä»–ï¼Œè¿™æ¬¡æˆ‘è¢«æ‰“äº†ï¼Œå®¶é‡Œäººè‚¯å®šä¸æ„¿æ„ï¼Œè¿˜å¥½æ²¡ä»€ä¹ˆæƒ…å†µï¼Œåˆæ˜¯ä¹¡é‡Œä¹¡äº²çš„ï¼Œå°±æ²¡æœ‰ä¸‹æ–‡äº†ã€‚</p><p>ä»é‚£ä»¥åï¼Œæˆ‘æ¯æ¬¡è§ä»–éƒ½è¦ç»•é“èµ°ï¼Œå› ä¸ºå®³æ€•ï¼Œæˆ‘ä¸çŸ¥é“è¿™æ ·è‡ªé—­çš„çˆ†å‘èµ·æ¥ä¼šæ˜¯ä»€ä¹ˆæ ·çš„ç»“æœï¼Œæ‘é‡Œçš„å°å­©å„¿ï¼Œé™¤äº†é‚£ç‰¹åˆ«çˆ±æŠ¤çš„é‚£ä¸ªå°ä¾„å„¿ï¼Œéƒ½ä¸å†è·Ÿç€å“‘å·´ç©ã€‚</p><p>è¿‡äº†å‡ å¹´ï¼Œæ‘é‡Œäººå¼€å§‹åŒå€¦æŒ‘æ°´åƒï¼Œå°±å¼€å§‹æŒ¨å®¶æŒ¨æˆ·å‡‘ç‚¹å„¿é’±ï¼Œä¹°äº†äº›æ°´ç®¡ï¼Œä¸€å¤´æ’è¿›äº•é‡Œï¼Œè´¯ç©¿æ‘é‡Œåå‡ æˆ·äººå®¶ï¼Œè¿™æ ·å¤§å®¶å°±éƒ½èƒ½å–åˆ°è‡ªæ¥æ°´äº†ã€‚å½“æ°´ç»è¿‡åœ°ä¸‹ï¼Œä»é¾™å¤´é‡Œå‡ºæ¥çš„æ—¶å€™ï¼Œå¾ˆæ¸…å¾ˆç”œï¼Œè€äººä»¬éƒ½åœ¨æ„Ÿå¹ï¼Œå‡ åå¹´æŒ‘æ°´åƒçš„æ—¥å­ç»ˆäºç†¬åˆ°å¤´ï¼ŒåŒæ—¶é‚£äº›æ—§çš„åœºæ™¯ï¼Œéƒ½ä¸ä¼šå†å‡ºç°ã€‚</p><p>å“‘å·´çš„æ—¥å­è½»æ¾äº†ï¼Œä¸ç”¨å†é‚£ä¹ˆæ—©èµ·æŒ‘æ°´æ¥å…»ä¸€å®¶äººï¼Œä½†æ˜¯ä»–è¿˜æ˜¯å¾ˆæ—©å°±èµ·æ¥äº†ï¼Œæ‘ä¸œå¤´å„¿åˆ°æ‘è¥¿å¤´å„¿çš„çæ™ƒæ‚ ï¼Œå˜´é‡Œå“¼ç€æˆ‘ä»¬å¬ä¸æ‡‚çš„è°ƒè°ƒï¼Œå¶å°”åœç•™åœ¨æˆ‘å®¶é—¨å‰çš„çŸ³æ¿ä¸Šï¼Œä¹Ÿå¾ˆä¹æ„è·Ÿæ‘é‡Œæ—©èµ·çš„è€äººèŠèŠå¤©ï¼Œå½“ç„¶ä»–ä¸ä¼šè¯´è¯ï¼Œå°±æ˜¯å˜´é‡Œå“¼å“¼å”§å”§ï¼Œæ‰‹ä¸åœçš„åœ¨æ‰“æ‰‹åŠ¿ï¼Œå¥‡æ€ªçš„æ˜¯å¤§å®¶è¿˜èƒ½çœ‹æ‡‚å¤§éƒ¨åˆ†ï¼Œä¸å¾—ä¸è¯´å“‘å·´å¾ˆèªæ˜ï¼Œåœ¨ä¸äººäº¤æµä¸Šã€‚</p><p><img src="http://cdn.yuhanle.com/passing-silent-silent-memories/p8033717.jpg" alt="é—²èŠ"></p><p>ä»–å–œæ¬¢æŠ½çƒŸï¼Œä¹Ÿå–œæ¬¢å–é…’ï¼Œå½“ç„¶è¿™äº›éƒ½æ˜¯åœ¨å¸®åˆ«äººå®¶å¹²æ´»äººå®¶ä»˜ç»™ä»–çš„â€œå·¥é’±â€ï¼Œä¸è¿‡å¹²æ´»çš„æ—¶å€™ï¼Œå¤§å®¶å¯ä¸æ•¢è®©ä»–å–é…’ï¼Œå› ä¸ºä»–ä¸€å–å°±åœä¸ä¸‹æ¥ï¼Œå–å¤šäº†å°±ä¸€ç›´ç¬‘ï¼Œçœ¼é‡Œè¿˜æµç€å¾ˆå¤šæ°´ï¼Œæ—¶ä¸æ—¶çš„è¿˜å“¼äº›è°ƒè°ƒï¼Œç„¶åæ´»è‚¯å®šæ˜¯å¹²ä¸äº†äº†ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯åœ¨å¹²å®Œæ´»ï¼Œæ‰æŠŠè¿‡èŠ‚å‰©ä¸‹çš„ç“¶åº•å„¿ç»™ä»–å–ï¼Œä»–ä¸å«Œå¼ƒï¼Œè€Œä¸”è¿˜å¾ˆé«˜å…´ï¼Œå¾ˆæ„Ÿæ¿€ï¼ŒçƒŸç»™å¤šäº†ä»–ä¹Ÿä¸è¦ï¼Œä¸€èˆ¬å°äº‹æƒ…çš„è¯ä»–åªä¼šæ¥ä¸€æ ¹çƒŸï¼Œå¿™äº†ä¸€å¤©æ‰ä¼šæ‹¿ä¸€ç›’ä¸¤å—é’±çš„æ•£èŠ±ã€‚</p><p>æ­£å› å¦‚æ­¤ï¼Œå¤§å®¶å®¶é‡Œæœ‰ä»€ä¹ˆæ´»éƒ½å–œæ¬¢æ‰¾ä»–åšï¼Œä½†æ˜¯å¾ˆå¤šäººéƒ½æ˜¯å·å·çš„æŠŠä»–å«è¿‡æ¥å¹²æ´»å„¿ï¼Œä¸ç»™å·¥é’±ï¼Œä»…ä»…æ˜¯ä¸€äº›çƒŸå’Œé…’ï¼Œæœ‰æ—¶å€™ä»–çš„æ¯äº²åœ¨æ‘é‡Œæ‰¾ä»–éƒ½æ‰¾ä¸è§ï¼Œå› ä¸ºæ˜¯è¢«éš”å£åº„ä¸Šçš„äººå«å»å’Œæ°´æ³¥äº†ï¼ŒæŒ‰ç…§ä¸€èˆ¬äººçš„å·¥é’±ä¸€å¤©è‡³å°‘ä¹Ÿå¾—æœ‰60å—é’±ï¼Œä½†æ˜¯å¯¹äºä»–ï¼Œå¦‚æœé›‡ä¸»æ²¡æœ‰å‘ŠçŸ¥ä»–çš„æ¯äº²çš„è¯ï¼Œä»–è‡ªå·±éƒ½ä¸æ¸…æ¥šæ˜¯åœ¨ç»™è°å¹²ï¼Œä¹Ÿä¸è¦é’±ï¼Œå°±ç®—å‘Šè¯‰äº†ä»–çš„æ¯äº²ï¼Œä¸€å¤©é¡¶å¤šæ‰æœ‰20å‡ å—é’±çš„æ”¶å…¥ï¼Œå½“ç„¶å¯¹äºä»–è‡ªå·±æ¥è¯´ï¼Œè¿™äº›é’±è¶³å¤Ÿä»–ç”Ÿæ´»äº†ï¼Œä½†æ˜¯ä»–è¿˜æ˜¯ä¸ªå­é¡ºçš„å­©å­ï¼Œé’±éƒ½æ˜¯çˆ¶æ¯æ”¶ç€ï¼Œè‡ªå·±çš„è¡£æœå¤§å¤šéƒ½æ˜¯æ—§çš„ï¼Œåƒä½éƒ½åœ¨å®¶é‡Œã€‚åœ¨è€å®¶ï¼Œé™¤äº†ä¼šæœ‰äººæ¬ºè´Ÿä»–ï¼Œçœ‹èµ·æ¥ä»–è¿˜æ˜¯å¾ˆæ»¡è¶³çš„ï¼Œå¯èƒ½ä»–è§‰å¾—è¿™æ˜¯ä¸€ç§ä¸äººæ²Ÿé€šçš„æ–¹å¼å§ï¼Œå°±æ˜¯ä¸€ç›´è¿™ä¹ˆåƒäºï¼Œæ‰ä¼šæœ‰äººæ‰¾ä½ åšæ´»å„¿ã€‚</p><p>å¾€åå¥½äº›å¹´ï¼Œæˆ‘ä¸€ç›´åœ¨å¤–ä¸Šå­¦ï¼Œå°±å¾ˆå°‘è§åˆ°è¿™ä½æ— è¨€è€…äº†ã€‚ç›´åˆ°æœ‰ä¸€å¤©ï¼Œå®¶é‡Œæ‰“ç”µè¯ï¼Œè®©æˆ‘åœ¨å¤–é¢æ³¨æ„å®‰å…¨ï¼Œåˆ«è¢«éª—äº†ï¼Œæˆ‘å½“æ—¶å¬äº†è¿˜å¾ˆçº³é—·ï¼Œä½œä¸ºä¸€ä¸ªåœ¨å¤–ç”Ÿæ´»å¤šå¹´çš„äººè€Œè¨€ï¼Œæˆ‘è¿˜æ˜¯è§è¿‡äº›ä¸–é¢çš„ï¼Œå¯¹äºè¯ˆéª—ï¼Œä¸ç®¡ä¸é—®ä¸ç†ä¼šï¼Œå°±ä¸ä¼šæœ‰å±é™©ã€‚æˆ‘ç»§ç»­è¿½é—®æ‰çŸ¥é“ï¼ŒåŸæ¥æ˜¯æœ‰ä½è€ä¹¡ï¼Œè¯´æ˜¯è¦ç»™è¿™ä½æ— è¨€è€…è®¨ä¸ªè€å©†ï¼Œæ­¤æ—¶ä»–å·²ç»å››åå¤šå²äº†ï¼Œè¿™ä¹ˆå¤šå¹´ä»–çˆ¶æ¯ä¹Ÿå¸®ä»–æ”’äº†ä¸€ä¸¤ä¸‡å—é’±ï¼Œçˆ¶æ¯å¬è¯´æ˜¯æœ‰äººå¸®å„¿å­è®¨è€å©†å¾ˆé«˜å…´ï¼Œåˆæ˜¯ç†Ÿäººå½“ä¸­é—´äººä»‹ç»ï¼Œæ‰€ä»¥å°±æ¯«æ— é˜²å¤‡çš„è¢«äººéª—äº†ï¼Œä»è¿™ä»¥åï¼Œå›å®¶çœ‹åˆ°ä»–æ„Ÿè§‰è€äº†å¾ˆå¤šï¼Œæ²¡å†è§ä»–ç¬‘è¿‡ï¼Œä»¿ä½›å¯¹å¤–ç•Œå……æ»¡äº†æ•Œæ„ã€‚</p><p>è¿™ä¹ˆå¤šå¹´æ¥ï¼Œæ‘å­é‡Œçš„äººæ…¢æ…¢éƒ½æ¬èµ°äº†ï¼Œæ‘é‡Œçš„åœ°ä¹Ÿå¼€å§‹è’åºŸäº†ï¼Œæœ‰é’±çš„åœ¨åŒ—äº¬ä¹°äº†æˆ¿ï¼Œå·®ä¸å¤šçš„éƒ½åœ¨å¸‚é‡Œå¿é‡Œä¹°çš„ï¼Œæœ€å·®çš„ä¹Ÿéƒ½æ¬åˆ°é•‡ä¸Šäº†ï¼Œå¤–é¢èŠ±èŠ±ä¸–ç•Œï¼Œäº¤é€šæ–¹ä¾¿ï¼Œæ”¶å…¥ä¹Ÿå¤šäº†ï¼Œæ€»ä¹‹éƒ½ç®—è¿‡ä¸Šäº†å°åº·ç”Ÿæ´»ã€‚</p><p>è¿™ä½æ— è¨€è€…è‡³ä»Šè¿˜æ‘é‡Œï¼Œå¬è¯´è¿‘å‡ å¹´æœ‰äººç»™ä»–ä»‹ç»äº†ä¸€ä¸ªæ–°çš„å·¥ä½œï¼Œå¸®åˆ«äººå–‚å…»æ‰å˜´ï¼ˆå­¦åé¸­å­ï¼‰ï¼ŒåŒ…åƒåŒ…ä½ï¼Œæ¯å¹´è¿˜æœ‰6000å—é’±çš„æ”¶å…¥ï¼Œå¹´åº•ç»“ç®—ï¼Œæ—¥å­ä¹Ÿç®—ä¸é”™ï¼</p><p>è‡³ä»Šæˆ‘ä¹Ÿæœ‰ä¸‰å››å¹´æ²¡æœ‰è§åˆ°ä»–äº†ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ€»è§‰å¾—å¯¹äºä»–æœ‰ä¸€äº›äºæ¬ ã€‚æˆ‘çš„ç«¥å¹´æ˜¯è·Ÿç€ä»–é•¿å¤§çš„ï¼Œä»–å¸¦ç€æˆ‘ä»¬æé¸Ÿè›‹ï¼Œæ‘˜èŒ¶æœï¼Œæ˜¥èŒ¶å­£èŠ‚è¿˜èƒ½å¸¦ç€æˆ‘ä»¬å»é‡‡èŒ¶å–é’±ï¼Œç„¶åä¹°ä¸€æ¯›é’±ä¸€æ ¹çš„æ£’å†°ï¼Œå¤å­£å¤ªçƒ­ï¼Œè¿˜ä¼šå¸¦ç€æˆ‘ä»¬å»æ²³é‡Œç½‘é±¼ï¼Œæ‰è™¾ï¼Œæ”¾ç‰›çš„æ—¶å€™è¿˜ä¼šæŠŠæˆ‘ä»¬æŠ±åˆ°ç‰›èƒŒä¸Šï¼Œå¹ç€æ ‘ç¬›ï¼ˆä¹¡ä¸‹çš„ç©æ„å„¿ï¼šå°±æ˜¯æŸ³æ ‘æå„¿ï¼Œåœ°ä¸Šæ“ä¸€æ“ï¼ŒæŠŠçš®å’Œå¹²åˆ†ç¦»å¼€ï¼‰ï¼Œåœ¨å’Œå…¶ä»–åº„ä¸Šçš„å­©å­å†²çªçš„æ—¶å€™ï¼Œè¿˜èƒ½æŒºèº«è€Œå‡ºä¸ºæˆ‘ä»¬å¼ºå‡ºå¤´ã€‚</p><p><img src="http://cdn.yuhanle.com/passing-silent-silent-memories/001puwxIgy6UR0N2dhga2&amp;690.jpeg" alt="ç™½é¹­éª‘ç‰›"></p><p>è¿™äº›ç»†èŠ‚ï¼Œéƒ½å¾ˆæ„Ÿæ¿€ã€‚</p><p>å†è¯´è¯´å¦‚ä»Šï¼Œä¸€çº¿åŸå¸‚ï¼Œå·¥ä½œè¿‘ä¸‰å¹´ï¼Œæ¯å¹´å›ä¸¤æ¬¡å®¶ï¼Œè¿˜éƒ½ç‰¹åˆ«åŒ†å¿™ï¼Œæœ‹å‹éƒ½æ²¡æ•¢è§ï¼Œæœä¹ˆéƒ½æ¥ä¸åŠé“åˆ«ï¼Œå°±éº»æºœå„¿çš„æ»šå›æ¥ä¸Šç­äº†ï¼Œè¯´èµ·å·¥ä½œï¼Œå¯¹äºä¸€ä¸ªæ²¡æœ‰ä¼Ÿå¤§å¿—å‘çš„äººæ¥è¯´ï¼Œè¿˜ç®—ç¨³å®šï¼Œæ”¶å…¥ä¹Ÿèƒ½å…»æ´»è‡ªå·±ï¼Œä½†æˆ‘ä»¬ä¿©äººæ¯å¤©å‘æ„çš„éƒ½è¿˜æ˜¯é’±ï¼Œä»€ä¹ˆæ—¶å€™ä¹°æˆ¿ï¼Œä»€ä¹ˆæ—¶å€™ç»“å©šï¼Œä»€ä¹ˆæ—¶å€™è¦å­©å­ï¼Œæ¯æ¯èŠåˆ°è¿™å„¿ï¼Œéƒ½æ˜¯ä¸€å£°å“€å¹ï¼Œç„¶åå°±å¼€å§‹å¤±çœ ï¼Œæ¯é€¢å‘¨æœ«å¦‚æ­¤ã€‚</p><p><img src="http://cdn.yuhanle.com/passing-silent-silent-memories/2013040213393813629.jpg" alt="ä¸Šæµ·å¤–æ»©"></p><p>æ— è¨€é€æ°´ï¼Œæœ‹å‹é—´çš„å…³æ€€ï¼Œä¸€å®šè¦çæƒœï¼Œå¦‚ä»Šçš„æœ‹å‹åœˆï¼Œçœ‹èµ·æ¥å¾ˆé«˜å¤§ä¸Šï¼Œä¸æ˜¯åœ¨ç‚«è€€å°±æ˜¯å‘ä¸€äº›é¸¡æ±¤ï¼Œçœ‹å¤šäº†äººçš„æ™ºå•†ä¼šä¸‹é™ï¼Œèº«è¾¹å¤„å¤„éƒ½æ˜¯ä½å¤´æ—ï¼Œæ–¹å¯¸ä¹‹é—´ï¼Œä¸–é—´ä¸‡ç‰©ï¼Œé€å»çš„å…¶å®ä¸æ˜¯æ°´ï¼Œæ˜¯å…‰é˜´ã€‚</p><p>å¤šå¹´ä»¥åï¼Œä½ æ‰€èƒ½æƒ³èµ·çš„ä¼šæ˜¯æŸä¸ªå¥½æœ‹å‹æ›¾ç»å‘è¿‡çš„ä¸€ä¸ªçŠ¶æ€ï¼Ÿè¿˜æ˜¯ä»–æ›¾ç»å¯¹ä½ çš„å¸®åŠ©ï¼Œå¯¹ä½ çš„é¼“åŠ±å’Œå…³æ€€ã€‚è€Œä½ å‘¢ï¼Ÿä½ ç»™æœ‹å‹ç•™ä¸‹çš„åˆæ˜¯ä»€ä¹ˆï¼Œæ˜¯ä»¤ä½ å‘æ„¤å›¾å¼ºçš„é¸¡æ±¤ï¼Ÿä¹Ÿè®¸åˆ«äººçœ‹ç€å¹¶æ²¡æœ‰ä»»ä½•æ„Ÿè§‰ï¼Œå´åˆä¸å¾—ä¸å¸®ä½ ç‚¹ä¸ªèµï¼Œä¸ç‚¹èµä¸æ˜¯æœ‹å‹ç­‰ç­‰ï¼Œè¿˜æ˜¯ä½ åˆšä¹°çš„è‚¾6è‚¾7å‘¢ï¼Ÿç‚¹èµçš„ä¸æ˜¯æœ‹å‹ï¼Œéª‚ä½ å‚»Xçš„æ‰æ˜¯çœŸå¿ƒçš„ã€‚</p><p>æˆ‘ä¹Ÿæ›¾å…³é—­è¿‡æœ‹å‹åœˆï¼Œå¦‚ä»Šåˆæ‰“å¼€äº†ï¼Œå› ä¸ºæˆ‘çš„æ™ºå•†è´Ÿæ•°ï¼Œæˆ‘åªæƒ³è®©æœ‹å‹çŸ¥é“æˆ‘è¿˜æ´»ç€ã€‚</p><p>æ„¿ä¸–é—´å¤šä¸€äº›çœŸè¯šï¼Œå°‘ä¸€äº›å¥—è·¯ï¼Œè«åœ¨æµªè´¹å…‰é˜´ï¼Œä»¥è‡´å›å¿†æ— å£°ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ°´çš„å­˜åœ¨ï¼Œå»¶ç»­äº†äººçš„ç”Ÿå‘½ï¼Œå´éš¾ä»¥æ´—æ¶¤äººçš„å›å¿†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å±±é‡Œï¼Œæ¯ä¸€ä¸ªå°çš„æ‘è½ï¼ŒæŸæ£µæ ‘è«ä¸‹ï¼Œå°±ä¼šæœ‰ä¸€å£äº•ï¼Œé‚£æ˜¯å±±æ³‰ã€‚æ‘è¥¿å¤´çš„å±±è„šä¸‹ï¼Œé‚£é‡Œåœ°åŠ¿ç¨é«˜ï¼Œæœ‰ä¸€æ¡ç”°é—´å°è·¯ï¼Œæ¥æ¥å¾€å¾€çš„äººä»¬æŒ‘ç€æœ¨æ¡¶ï¼Œè·¯ä¸Šæ¹¿æ¼‰æ¼‰çš„ï¼Œä»¿ä½›åˆšä¸‹è¿‡é›¨ï¼Œè®°å¿†å…¨éƒ½å°å¿ƒç¿¼ç¿¼çš„åœ¨è¿™æ¡è·¯ä¸Šç©¿æ¢­ï¼Œç”Ÿæ€•ç¢°åˆ°è·¯äººã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="prose" scheme="https://blog.yuhanle.com/categories/prose/"/>
    
    
      <category term="prose" scheme="https://blog.yuhanle.com/tags/prose/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘çŸ¥é“çš„å¤ªå¤š</title>
    <link href="https://blog.yuhanle.com/2016/05/20/i-know-more-more/"/>
    <id>https://blog.yuhanle.com/2016/05/20/i-know-more-more/</id>
    <published>2016-05-20T01:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.337Z</updated>
    
    <content type="html"><![CDATA[<p>æ­£å› ä¸ºæˆ‘ä»¬çŸ¥é“çš„å¤ªå¤šï¼Œæ‰€ä»¥æ‰ä¼šè§‰å¾—å‹æŠ‘</p><p>è®¸ä¹…æ²¡æœ‰å†™ä¸œè¥¿ï¼Œæœ‰æ—¶å€™åœ¨æƒ³ï¼Œæ€ç»´ä¼šä¸ä¼šå·²ç»æ¯ç«­ï¼Œé™¤äº†ç®€å•çš„å› ä¸ºæ‰€ä»¥ï¼Œå®Œå…¨å¿˜äº†æŠ¼éŸµã€‚</p><a id="more"></a><p>è®°å¾—å¼€å§‹æƒ³ç€å†™è¿™ç¯‡æ˜¯åœ¨å»å¹´äº†ï¼ŒåŸæœ¬æ‰“ç®—å†™æˆå¹´ç»ˆæ€»ç»“ï¼Œåæ¥å‘ç°è¿™ä¸€å¹´è¿‡å»äº†ï¼Œé™¤äº†èƒ¡é¡»åœ¨é•¿ï¼Œä½“é‡åœ¨å¢åŠ ï¼Œåˆ«çš„æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ã€‚</p><p>æœ‰æ—¶å€™èµ°åœ¨è·¯ä¸Šï¼Œæƒ³èµ·ä»¥å‰ç»å¸¸èƒŒçš„é‚£äº›å®‹è¯æ¥ï¼Œå…¨éƒ½æˆäº†é›¶æ˜Ÿçš„å¥å­ï¼Œä¸Šä¸‹é˜™æ··åœ¨ä¸€èµ·ï¼Œç”šè‡³æ··åˆäº†ä¸åŒçš„è¯ç‰Œï¼Œä¸åŒçš„ä½œè€…ï¼Œç»“æœå´å‡ºä¹æ„æ–™çš„æŠ¼éŸµã€‚</p><p>æˆ‘çŸ¥é“ï¼Œæ˜¯å·¥ä½œå’Œç”Ÿæ´»æ‰°ä¹±äº†æˆ‘ã€‚</p><p>æˆ‘å¾ˆå®³æ€•èº«è¾¹çš„äº‹æƒ…å¤ªå¤šï¼Œå› ä¸ºæˆ‘æ˜¯ä¸€ä¸ªå¾ˆå°å¿ƒçš„äººï¼Œè€Œä¸”å¾ˆä¸ä¼šåŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œä¼šä¸çŸ¥æ‰€æªï¼Œå½“ç„¶å¤„ç†çš„ç»“æœä¹Ÿæ˜¯ä¸€å›¢ç³Ÿã€‚</p><p>å¾ˆå¤šæ—¶å€™ï¼Œæ€»æ˜¯ä¼šåœ¨ç”¨åˆ°æŸäº›çš„æ—¶å€™æ‹¼å‘½å»æŸ¥æ‰¾ï¼Œæ‰¾åˆ°äº†ä»…ä»…æ˜¯ç”¨äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰å½’ç±»ï¼Œå¦‚æ­¤å¾€å¤ï¼Œæ˜æ˜çŸ¥é“æ²¡æœ‰æ•ˆç‡ï¼Œå´ä¾ç„¶å·²ç»ä¹ æƒ¯äº†ã€‚</p><p>è¿™æ˜¯ä¸ªä¸å¥½çš„ä¹ æƒ¯ã€‚ç”šè‡³æˆ‘éƒ½å†³å®šè¿‡è¦å»æ”¹æ‰å®ƒï¼Œæˆ‘è¯•ç€å¼€å§‹åšç¬”è®°ï¼Œå¼€å§‹æ”¶è—ä¸€äº›æ¯”è¾ƒæ„Ÿå…´è¶£çš„ä¸œè¥¿ï¼Œåæ¥æ…¢æ…¢å‘ç°ï¼Œå¸å¼•æˆ‘çš„ä¸œè¥¿å¤ªå¤šå¤ªå¤šï¼Œæ•´ç†çš„ç¬”è®°å·²ç»ä¸çŸ¥é“è¯¥å±äºå“ªä¸€ç±»äº†ï¼Œåˆå‡ºç°äº†å¾ˆå¤šå¾ˆå¤šæ¨¡æ£±ä¸¤å¯çš„ä¸œè¥¿ï¼Œå½¼æ­¤åŒ…å«ï¼Œå®åœ¨æ˜¯å¾ˆéš¾æŠŠå®ƒåœ¨æˆ‘çš„è®°å¿†é‡Œåˆ†ç¦»å¼€æ¥ã€‚</p><p>æˆ‘ä¹Ÿè¯•ç€åœ¨å·¥ä½œå’Œç”Ÿæ´»ä¸­ï¼Œå°½é‡ç‹¬ç«‹å¼€æ¥ï¼Œä¸æŠŠå·¥ä½œå¸¦åˆ°ç”Ÿæ´»ä¸­ï¼Œä¸å¸¦å›å®¶ï¼Œäºæ˜¯å°±æœ‰äº†åŠ ç­ï¼Œä¸æƒ³å›å®¶ï¼Œç›´åˆ°æ„Ÿè§‰è§†åŠ›æ¬ ä½³ï¼ŒåŸæ¥ä¸çŸ¥ä¸è§‰ä¸­ï¼Œèº«è¾¹çš„ä¸€åˆ‡éƒ½åœ¨æ”¹å˜ï¼Œéƒ½åœ¨é™é™çš„å½±å“ç€ä½ çš„å¿ƒæƒ…ï¼Œä½ çš„èº«ä½“ï¼Œç”šè‡³ä½ ä»Šåçš„è·¯ã€‚</p><p>è¯´åˆ°ä»Šåçš„è·¯ï¼Œä¸€å®šä¼šè¶Šæ¥è¶Šè‰°éš¾ï¼Œä½†ç»“å±€æ€»ä¼šæ˜¯è¶Šæ¥è¶Šç¾å¥½ã€‚</p><p>è¿‡äº†æ—©å©šçš„å¹´é¾„å°±çœŸçš„åº”è¯¥å©šäº†ï¼Œå®¶åº­æ‰æ˜¯ç»å¤§éƒ¨åˆ†äººåŠªåŠ›çš„åŠ¨åŠ›ã€‚è¿™ä¸€åˆ»ï¼Œæœ‰æ„Ÿè§‰æ—¥å­å¥½é•¿ï¼Œæ—¥å¤ä¸€æ—¥ï¼Œä»€ä¹ˆæ—¶å€™å¯ä»¥è¿‡ä¸Šä¸€å®¶äººæƒ³è¿‡çš„ç”Ÿæ´»ã€‚</p><p>æˆ‘åˆ°åº•è¿˜æ˜¯æ²¡å­¦ä¼šå¦‚ä½•å…³å¿ƒåˆ«äººã€‚</p><p>æ‰€ä»¥ä¸æ‹’ç»è¿æ¥çš„äººï¼Œä¸æŒ½ç•™ç¦»å»çš„äººã€‚</p><p>çœ‹ä¼¼é¡ºå…¶è‡ªç„¶ï¼Œå®åˆ™æ‡¦å¼±é€ƒé¿ã€‚</p><p>å½“æ—¶è¢«è°è¯´ä¸çæƒœè‡ªå·±çš„æœ‹å‹æ—¶ï¼Œè¿˜å§”å±ˆçš„ä¸è¡Œã€‚</p><p>ç„¶è€Œä»»ä½•æœ‹å‹åˆ°æœ€åï¼Œéƒ½åªä¼šæ˜¯å¤±å»å’Œè¢«å¤±å»ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ­£å› ä¸ºæˆ‘ä»¬çŸ¥é“çš„å¤ªå¤šï¼Œæ‰€ä»¥æ‰ä¼šè§‰å¾—å‹æŠ‘&lt;/p&gt;
&lt;p&gt;è®¸ä¹…æ²¡æœ‰å†™ä¸œè¥¿ï¼Œæœ‰æ—¶å€™åœ¨æƒ³ï¼Œæ€ç»´ä¼šä¸ä¼šå·²ç»æ¯ç«­ï¼Œé™¤äº†ç®€å•çš„å› ä¸ºæ‰€ä»¥ï¼Œå®Œå…¨å¿˜äº†æŠ¼éŸµã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="suibi" scheme="https://blog.yuhanle.com/categories/suibi/"/>
    
    
      <category term="outu" scheme="https://blog.yuhanle.com/tags/outu/"/>
    
  </entry>
  
  <entry>
    <title>iOSå·¥ç¨‹ä¸­ç½‘ç»œè¯·æ±‚ç®¡ç†çš„æƒ³æ³•</title>
    <link href="https://blog.yuhanle.com/2016/02/25/about-ios-net-manager-idea/"/>
    <id>https://blog.yuhanle.com/2016/02/25/about-ios-net-manager-idea/</id>
    <published>2016-02-25T02:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.333Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€ç›´åœ¨æƒ³ä¸€äº›çƒ§è„‘çš„é€»è¾‘é—®é¢˜ã€‚</p><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬æŠ›å‡ºäº†<a href="https://yuhanle.github.io/2016/01/04/a-perfect-package-afn-requests-demo/" target="_blank" rel="noopener">ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ¡†æ¶</a>ï¼Œåœ¨è¿™ä¸ªæ¡†æ¶ä¸­ï¼Œèƒ½å¤Ÿå¾ˆæ¸…æ™°çš„ç®¡ç†æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œæ¯ä¸€ä¸ªå›åº”ï¼Œä»¥åŠç»Ÿä¸€å¤„ç†ï¼Œç‰¹æ®Šå¤„ç†ç­‰ï¼Œä½†å¯¹äºå¼€å‘äººå‘˜æ¥è®²ï¼Œè¿™åªæ˜¯ä¸€ä¸ªeasyçš„æ–‡ä»¶ç›®å½•è€Œå·²ã€‚<a id="more"></a></p><p>ç›®å‰è¿™ä¸ªæ¡†æ¶ä»ç„¶å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œä¾‹å¦‚è¯·æ±‚é‡å‘æœºåˆ¶æœ‰å¾…ä¼˜åŒ–ï¼Œä¸æ”¯æŒå†»ç»“ç½‘ç»œè¯·æ±‚ï¼Œè¿˜æœ‰åœ¨é¡µé¢é”€æ¯æ—¶ï¼Œä¸æ”¯æŒå–æ¶ˆæœªå®Œæˆçš„è¯·æ±‚(ps:ä¸€æ¬¡æ€§å–æ¶ˆæ‰€æœ‰è¯·æ±‚ï¼Œä½†è¿™ä¸æ˜¯æˆ‘å¸Œæœ›çš„æ•ˆæœ)</p><h5 id="å…ˆè¯´è¯´ä»æ–°æ‰‹ä»¥æ¥å¯¹äºç½‘ç»œè¯·æ±‚ç®¡ç†è¿™å—çš„ç†è§£è¿‡ç¨‹ï¼š"><a href="#å…ˆè¯´è¯´ä»æ–°æ‰‹ä»¥æ¥å¯¹äºç½‘ç»œè¯·æ±‚ç®¡ç†è¿™å—çš„ç†è§£è¿‡ç¨‹ï¼š" class="headerlink" title="å…ˆè¯´è¯´ä»æ–°æ‰‹ä»¥æ¥å¯¹äºç½‘ç»œè¯·æ±‚ç®¡ç†è¿™å—çš„ç†è§£è¿‡ç¨‹ï¼š"></a>å…ˆè¯´è¯´ä»æ–°æ‰‹ä»¥æ¥å¯¹äºç½‘ç»œè¯·æ±‚ç®¡ç†è¿™å—çš„ç†è§£è¿‡ç¨‹ï¼š</h5><p>è¯´ä¸€ä¸‹ï¼Œæˆ‘ä»¬è®¨è®ºçš„å‰ææ˜¯ï¼Œå¸Œæœ›æ— å…³è¯·æ±‚éƒ½ä¼šæ­£å¸¸cancelã€‚</p><h6 id="1-ç»Ÿä¸€å•ä¾‹ç±»ï¼Œç®¡ç†æ‰€æœ‰è¯·æ±‚"><a href="#1-ç»Ÿä¸€å•ä¾‹ç±»ï¼Œç®¡ç†æ‰€æœ‰è¯·æ±‚" class="headerlink" title="1. ç»Ÿä¸€å•ä¾‹ç±»ï¼Œç®¡ç†æ‰€æœ‰è¯·æ±‚"></a>1. ç»Ÿä¸€å•ä¾‹ç±»ï¼Œç®¡ç†æ‰€æœ‰è¯·æ±‚</h6><p>è¯¥æ–¹æ³•ï¼Œæä¾›ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè¿˜æœ‰å‡ ä¸ªè¯·æ±‚APIæ¥å£ï¼Œç„¶ååœ¨å·¥ç¨‹ä¸­ä»»ä½•éœ€è¦ç½‘ç»œè¯·æ±‚çš„åœ°æ–¹ä½¿ç”¨ï¼ŒåŠ ä¸Šurlï¼Œç›¸å…³å‚æ•°ä»¥åŠcallbackï¼Œè€Œä¸”å†…éƒ¨çš„æ ¸å¿ƒä»£ç ä¹Ÿæ˜¯ç›´æ¥ä¸AFNetworkingå¤„ç†ï¼Œæ–¹ä¾¿å¿«é€Ÿï¼Œä½†æ˜¯å¯¹äºæˆç™¾ä¸Šåƒï¼ˆè¿™ä¸ªæ•°å­—å¯èƒ½ä¼šè¶Šæ¥è¶Šå¤§ï¼‰çš„æœåŠ¡ç«¯æ¥å£æ¥è¯´ï¼Œä¸æ˜“ç®¡ç†ã€‚</p><p>è€Œä¸”åœ¨å–æ¶ˆå…¨éƒ¨è¯·æ±‚çš„æ—¶å€™ä¼šå‡ºç°ä¸€äº›æ„æƒ³ä¸åˆ°çš„é—®é¢˜</p><blockquote><p>ä¸¾ä¸ªæ —å­</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Aé¡µé¢push Bé¡µé¢</span><br><span class="line">Bé¡µé¢å‘å‡ºäº†è¯·æ±‚1</span><br><span class="line">è¯·æ±‚1å®Œæˆä¹‹åéœ€è¦Aé¡µé¢å‘é€è¯·æ±‚2</span><br><span class="line">å‡è®¾è¿™ä¸ªæ—¶å€™ç½‘ç»œä¸ä½³è€ŒBåˆšå¥½é”€æ¯äº†</span><br><span class="line">è¿™æ ·Açš„è¯·æ±‚2è¿˜æ²¡å›æ¥å°±è¢«å–æ¶ˆ</span><br><span class="line">æ‰€ä»¥Açš„æ•°æ®ä¸èƒ½åŠæ—¶æ›´æ–°</span><br></pre></td></tr></table></figure><p>request:<br>ç›´æ¥è°ƒç”¨<br>responseï¼š<br>ç»Ÿä¸€å¤„ç†<br>cancel:<br>å–æ¶ˆå…¨éƒ¨è¯·æ±‚</p><p>å¦‚ä¸‹å›¾<br><img src="http://cdn.yuhanle.com/QQ20160223-0.png" alt="JZ"></p><h6 id="2-ç»Ÿä¸€éå•ä¾‹ç±»ï¼Œåˆ†ç®¡è¯·æ±‚"><a href="#2-ç»Ÿä¸€éå•ä¾‹ç±»ï¼Œåˆ†ç®¡è¯·æ±‚" class="headerlink" title="2.ç»Ÿä¸€éå•ä¾‹ç±»ï¼Œåˆ†ç®¡è¯·æ±‚"></a>2.ç»Ÿä¸€éå•ä¾‹ç±»ï¼Œåˆ†ç®¡è¯·æ±‚</h6><p>è¿™ç§æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªç±»ï¼Œæ¯æ¬¡è°ƒç”¨è¯·æ±‚çš„æ—¶å€™éƒ½newä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œç„¶åç”±vcæŒæœ‰ï¼Œè¿™æ ·åšä¾¿äºåœ¨é¡µé¢deallocæ—¶ï¼Œç›´æ¥å–æ¶ˆå½“å‰é¡µé¢å‘å‡ºçš„æ‰€æœ‰è¯·æ±‚ã€‚è¯·æ±‚ç®¡ç†ç±»ä¼¼äºï¼Œè°è¯·æ±‚ï¼Œè°è´Ÿè´£cancelã€‚</p><p>å¾ˆæ˜æ˜¾ï¼Œè¿™ç§æ–¹æ³•å¤§å¤§å¢åŠ äº†ç³»ç»Ÿçš„å¼€é”€ï¼Œè€Œä¸”ä¸ç¬¦åˆè®¾è®¡æ€æƒ³ï¼Œè™½ç„¶å¯ä»¥æ–¹ä¾¿çš„å–æ¶ˆè‡ªå·±ç®¡ç†çš„è¯·æ±‚ï¼Œä½†æ˜¯ä¸æ”¯æŒå–æ¶ˆå…¨éƒ¨è¯·æ±‚ã€‚å¦‚æœè¦æ”¯æŒå–æ¶ˆå…¨éƒ¨è¯·æ±‚çš„è¯ï¼Œè¿˜éœ€è¦ä¸€ä¸ªç®¡ç†ç±»æ¥ç®¡ç†ç®¡ç†è¯·æ±‚çš„ç®¡ç†ç±»ï¼Œè¿™æ ·çš„è¯æ•´ä¸ªç›®å½•çœ‹èµ·æ¥æ¨ªä¸ƒç«–å…«ã€‚</p><p>ç”±äºå¯¹å›è°ƒçš„ç»Ÿä¸€å¤„ç†ä¹Ÿæ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥ä¹Ÿä¼šå­˜åœ¨éƒ¨åˆ†éœ€æ±‚ä¸æ»¡è¶³çš„é—®é¢˜</p><blockquote><p>ä¸¾ä¸ªæ —å­</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">éœ€æ±‚ä¸­å­˜åœ¨tokenè¿‡æœŸçš„é—®é¢˜</span><br><span class="line">æ­¤æ—¶é˜Ÿåˆ—ä¸­å­˜åœ¨å¾ˆå¤šè¯·æ±‚</span><br><span class="line">è¯·æ±‚1æ”¶åˆ°äº†tokenè¿‡æœŸçš„å›åº”ï¼ˆä¸€èˆ¬tokenè¿‡æœŸåªä¼šä¿ç•™ä¸€æ¬¡ï¼Œå› ä¸ºæ—§tokenæœåŠ¡å™¨ä¸ä¼šå¸®ä½ ä¿å­˜å¤ªå¤šï¼‰</span><br><span class="line">éœ€è¦ç«‹é©¬åšå‡ºå¤„ç†ï¼Œæ¯”å¦‚é‡æ–°ç™»å½•</span><br><span class="line">è€Œæ­¤æ—¶è¯·æ±‚2ã€è¯·æ±‚3å¯èƒ½éƒ½å·²å‘å‡ºï¼Œæˆ–è€…å·²ç»æ”¶åˆ°å›åº”</span><br><span class="line">ç”±äºè¿™é‡Œçš„å¤„ç†æ˜¯ç‹¬ç«‹çš„ï¼Œéš¾å…ä¼šäº§ç”Ÿå„ç§é—®é¢˜</span><br></pre></td></tr></table></figure><p>request:<br>åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œç›´æ¥è°ƒç”¨<br>responseï¼š<br>å•ç‹¬ç»Ÿä¸€å¤„ç†<br>cancel:<br>æŒæœ‰è€…å–æ¶ˆç‹¬è‡ªç®¡ç†çš„å…¨éƒ¨è¯·æ±‚</p><h6 id="3-ç»Ÿä¸€å•ä¾‹ç±»ï¼Œåˆ†ç®¡è¯·æ±‚"><a href="#3-ç»Ÿä¸€å•ä¾‹ç±»ï¼Œåˆ†ç®¡è¯·æ±‚" class="headerlink" title="3.ç»Ÿä¸€å•ä¾‹ç±»ï¼Œåˆ†ç®¡è¯·æ±‚"></a>3.ç»Ÿä¸€å•ä¾‹ç±»ï¼Œåˆ†ç®¡è¯·æ±‚</h6><p>åˆ†ç®¡è¯·æ±‚æœ‰å¾ˆå¤šç§ï¼Œä¾‹å¦‚å¯ä»¥æ ¹æ®åŠŸèƒ½ã€æ¥å£ã€æˆ–è€…é¡µé¢å±æ€§æ¥ç‹¬è‡ªç®¡ç†æœ‰å…±åŒç‰¹ç‚¹çš„è¯·æ±‚ã€‚</p><p>è¿™é‡Œçš„ç‹¬è‡ªç®¡ç†ï¼Œå…¶å®æ— éå°±æ˜¯ç»™è¯·æ±‚åŠ äº†ä¸€ä¸ªæ ‡ç­¾ï¼Œä¾¿äºç®¡ç†è¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‰ç…§æŸä¸€å…±åŒç‰¹å¾æ¥ç®¡ç†ã€‚ç›¸æ¯”è¾ƒç¬¬ä¸€ç§å½¢å¼ï¼Œä»–çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥æŒ‰éœ€æ±‚å–æ¶ˆéƒ¨åˆ†è¯·æ±‚ï¼Œæ¯”å¦‚åœ¨æŸä¸ªé¡µé¢deallocçš„æ—¶å€™ï¼ŒæŒ‰ç…§é¡µé¢åç§°ï¼Œå–æ¶ˆè¯·æ±‚é˜Ÿåˆ—ä¸­æœ‰å…³å½“å‰é¡µé¢æ‰€æœ‰æœªå®Œæˆçš„è¯·æ±‚ã€‚</p><blockquote><p>ä¸¾ä¸ªæ —å­</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆæ”¯æŒæŒ‰ç…§æ ‡ç­¾å–æ¶ˆè¯·æ±‚</span><br><span class="line">å…¶æ¬¡ç»Ÿä¸€å¤„ç†å¯ä»¥åœ¨é‡åˆ°çªå‘æƒ…å†µï¼ˆtokenè¿‡æœŸï¼‰çš„æ—¶å€™ï¼Œcancelæ‰€æœ‰è¯·æ±‚</span><br></pre></td></tr></table></figure><p>request:<br>ç›´æ¥è°ƒç”¨<br>responseï¼š<br>ç»Ÿä¸€å¤„ç†<br>cancel:<br>å–æ¶ˆå…¨éƒ¨è¯·æ±‚åŒæ—¶æ”¯æŒæŒ‰ç…§tagå–æ¶ˆ</p><h5 id="å¼€æºæ¡†æ¶ç»“æ„ç®€æ"><a href="#å¼€æºæ¡†æ¶ç»“æ„ç®€æ" class="headerlink" title="å¼€æºæ¡†æ¶ç»“æ„ç®€æ"></a>å¼€æºæ¡†æ¶ç»“æ„ç®€æ</h5><h6 id="1ã€YTKNetwork"><a href="#1ã€YTKNetwork" class="headerlink" title="1ã€YTKNetwork"></a>1ã€<a href="https://github.com/yuantiku/YTKNetwork" target="_blank" rel="noopener">YTKNetwork</a></h6><p><img src="http://cdn.yuhanle.com/QQ20160225-0.png" alt="YTK"></p><p>ä¸Šé¢çš„æˆªå›¾æ¥è‡ª<a href="https://github.com/yuantiku/YTKNetwork" target="_blank" rel="noopener">YTKNetwork</a>çš„è®¾è®¡æ¡†æ¶ï¼Œå°†æœåŠ¡ç«¯æ¯ä¸ªapiä¹Ÿåšç®€å•çš„å°è£…å¤„ç†ï¼ˆä¾‹å¦‚å›¾ä¸­çš„RegisterApiï¼‰ï¼Œä½¿ç”¨èµ·æ¥å¾ˆèˆ’æœï¼Œä½†æ˜¯è¿™æ ·å†™ä¸‹å»ï¼Œéœ€è¦äº›æˆç™¾ä¸Šåƒä¸ª.h.mï¼Œæƒ³æƒ³éƒ½è§‰å¾—ä¸å¯æ€è®®ï¼Œå½“ç„¶è¿™åªæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ–¹ä¾¿å¼€æ‹“ä½¿ç”¨è€…æ›´å¹¿æ³›çš„æ€è·¯ã€‚</p><p>æˆ‘åœ¨å·¥ç¨‹ä¸­çš„åšæ³•éƒ½æ˜¯æ ¹æ®åŠŸèƒ½ï¼Œå°†æœåŠ¡ç«¯çš„apiåšäº†åˆ†ç±»ï¼Œæ¥å£ä¸­ä¿ç•™äº†æœåŠ¡ç«¯éœ€è¦çš„infoï¼Œç”±è°ƒç”¨è€…å¡«å……å³å¯ã€‚å¦‚ä¸‹å›¾<br><img src="http://cdn.yuhanle.com/QQ20160225-2.png" alt="WS"></p><p>æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥ä¸‹è½½æˆ‘çš„<a href="https://github.com/yuhanle/WSApiInvoker" target="_blank" rel="noopener">Demo</a>æ‹ä¸€æ‹ã€‚</p><h6 id="2ã€MGJRequestManager"><a href="#2ã€MGJRequestManager" class="headerlink" title="2ã€MGJRequestManager"></a>2ã€<a href="https://github.com/mogujie/MGJRequestManager" target="_blank" rel="noopener">MGJRequestManager</a></h6><p><img src="http://cdn.yuhanle.com/QQ20160225-1.png" alt="MGJ"></p><p>è™½ç„¶è¿™ä¸ªæ¡†æ¶ä»…æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œè€Œä¸”æ”¯æŒç¼“å­˜ï¼Œç”¨èµ·æ¥å¦‚å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„æŠŠä»–å½“åšä¸€ä¸ªè¯·æ±‚ç±»æ¥ä½¿ç”¨ï¼Œæœ€å¥½è¿˜æ˜¯é…åˆYTKçš„æ¨¡å¼ï¼Œå°è£…å¥½è¯·æ±‚å’Œå›åº”ï¼Œæ¥å£ç»Ÿä¸€ç®¡ç†ï¼Œè¿™æ ·ç”¨èµ·æ¥æ‰ä¸å¤±æ•ˆç‡ã€‚</p><p>æˆªå›¾æ¥è‡ªï¼š<br><a href="https://github.com/lookingstars/nuomi" target="_blank" rel="noopener">JZNetworkSingleton</a><br>å¼€æºæ¡†æ¶å‚è€ƒ:<br><a href="https://github.com/yuantiku/YTKNetwork" target="_blank" rel="noopener">YTKNetwork</a><br><a href="https://github.com/mogujie/MGJRequestManager" target="_blank" rel="noopener">MGJRequestManager</a></p><p>çœ‹å®ŒYTKçš„æ¡†æ¶è®¾è®¡ï¼Œæ¡†æ¶è¶Šå¤æ‚ï¼ŒåŠŸèƒ½è¶Šå¼ºå¤§ï¼Œç”¨èµ·æ¥è¶Šæ–¹ä¾¿</p><p>æ¬¢è¿å¤§å®¶ä¸æˆ‘äº¤æµï¼ï¼ï¼</p><p>æœ¬ç«™æ–‡ç« å¦‚æ— å…¶ä»–ç‰¹æ®Šè¯´æ˜ï¼Œå‡ä¸ºåŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘ä¸€ç›´åœ¨æƒ³ä¸€äº›çƒ§è„‘çš„é€»è¾‘é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬æŠ›å‡ºäº†&lt;a href=&quot;https://yuhanle.github.io/2016/01/04/a-perfect-package-afn-requests-demo/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ¡†æ¶&lt;/a&gt;ï¼Œåœ¨è¿™ä¸ªæ¡†æ¶ä¸­ï¼Œèƒ½å¤Ÿå¾ˆæ¸…æ™°çš„ç®¡ç†æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œæ¯ä¸€ä¸ªå›åº”ï¼Œä»¥åŠç»Ÿä¸€å¤„ç†ï¼Œç‰¹æ®Šå¤„ç†ç­‰ï¼Œä½†å¯¹äºå¼€å‘äººå‘˜æ¥è®²ï¼Œè¿™åªæ˜¯ä¸€ä¸ªeasyçš„æ–‡ä»¶ç›®å½•è€Œå·²ã€‚
    
    </summary>
    
      <category term="iOS" scheme="https://blog.yuhanle.com/categories/iOS/"/>
    
    
      <category term="iOS" scheme="https://blog.yuhanle.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€ä¸ªå…³äºè“ç‰™4.0çš„æ™ºèƒ½ç¡¬ä»¶Demo è¯¦è§£</title>
    <link href="https://blog.yuhanle.com/2016/01/10/about-ble-intelligent-hd-demo-detailed/"/>
    <id>https://blog.yuhanle.com/2016/01/10/about-ble-intelligent-hd-demo-detailed/</id>
    <published>2016-01-10T09:00:00.000Z</published>
    <updated>2021-10-21T08:18:48.333Z</updated>
    
    <content type="html"><![CDATA[<p>å†™è¿™ç¯‡è¯¦è§£æ˜¯å› ä¸ºæœ€è¿‘å¾ˆå¤šäººéƒ½åœ¨é—®ç›¸å…³é—®é¢˜ï¼Œä½†æ˜¯ä¸Šç¯‡æ–‡ç« <a href="https://yuhanle.github.io/2015/06/24/ble-development-continuously-update/" target="_blank" rel="noopener">iOS-BLEè“ç‰™å¼€å‘æŒç»­æ›´æ–°</a>å·²ç»è¿‡å»åŠå¹´ï¼Œå¾ˆå¤šä¸œè¥¿å·²ç»å¼€å§‹é—å¿˜ï¼Œä»Šå¤©é‡æ–°æ‹¾èµ·ï¼Œå¹¶åœ¨Demoä¸­æ–°æ·»äº†å…·ä½“åŠŸèƒ½å’Œè¯¦ç»†æ³¨é‡Šï¼Œé¡ºä¾¿å±¡ä¸€ä¸‹å½“åˆè®¾è®¡çš„æ€è·¯ï¼Œæˆ‘æƒ³ç”¨å›¾ç‰‡æ¥è§£é‡Šä¼šæ›´å¥½ç†è§£ã€‚<a id="more"></a></p><p>é¦–å…ˆçœ‹ä¸€ä¸‹å‡ ä¸ªæ–‡ä»¶çš„å¤§æ¦‚åŠŸèƒ½ï¼Œåé¢åœ¨ç”¨å›¾æ¥åˆ†æå…¶ä¸­çš„è®¾è®¡ç†å¿µã€‚</p><h4 id="æ–‡ä»¶ç›®å½•"><a href="#æ–‡ä»¶ç›®å½•" class="headerlink" title="æ–‡ä»¶ç›®å½•"></a>æ–‡ä»¶ç›®å½•</h4><p>æ•´ä¸ªæ–‡ä»¶ä¸»è¦åŒ…å«å››å¤§å—ï¼Œæ¯ä¸€å—çš„åŠŸèƒ½éƒ½æ˜¯ç‹¬ç«‹å¼€çš„ï¼Œä¸è¿‡å½“ä¸­å´åˆè®¾è®¡ä¸è¶³çš„åœ°æ–¹ï¼Œå¸Œæœ›å„ä½èƒ½å¤Ÿç§¯æforkï¼Œè´¡çŒ®ä»£ç ï¼</p><ul><li>QWSDiscovery</li></ul><p>è¿™ä¸ªæ–‡ä»¶æ˜¯åŠŸèƒ½çš„æ ¸å¿ƒï¼Œä¸»è¦è´Ÿè´£å’Œç³»ç»Ÿçš„CoreBluetoothæ²Ÿé€šï¼Œæ¯”å¦‚æ‰«æè®¾å¤‡ï¼Œè¿æ¥ï¼Œæ–­å¼€ç­‰æ“ä½œã€‚å…¶ä¸­ç»´æŠ¤äº†ä¸€ä¸ªè®¾å¤‡åˆ—è¡¨ï¼Œä½¿ç”¨è®¾å¤‡çš„uuidæ¥å”¯ä¸€è¯†åˆ«ã€‚åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼ŒåŒæ—¶ä¹Ÿå®šä¹‰äº†é€šçŸ¥å’Œé”™è¯¯ç±»å‹ï¼Œæ–¹ä¾¿å¤„ç†ä¸è®¾å¤‡ä¹‹é—´çš„ä¿¡æ¯äº¤æµã€‚</p><ul><li>QWSBleHelper </li></ul><p>ç”¨å¿ƒçš„è¯»è€…ä¸€å®šå‘ç°ï¼Œåœ¨æˆ‘ä»¬çš„æ¯ä¸€ä¸ªviewControllerä¸­ï¼Œåªè¦ä¸è“ç‰™åŠŸèƒ½ç›¸å…³ï¼Œé‚£ä»–ä¸€å®šç»´æŠ¤äº†ä¸€ä¸ªhelperã€‚åœ¨è¿™é‡Œæˆ‘ç§°è¿™ä¸ªé¡µé¢ä¸ºç›‘æŠ¤äººï¼Œæ™ºèƒ½è®¾å¤‡å°±åƒæ˜¯ä¸€ä¸ªå­©å­ï¼Œå¾ˆå¤šå­©å­åœ¨å¹¼å„¿å›­é‡Œï¼Œæˆ‘åªå…³å¿ƒæˆ‘çš„å­©å­ï¼Œè€Œè¿™ä¸ªhelperå°±åƒå¹¼å„¿å›­è€å¸ˆï¼Œä»–è´Ÿè´£å‘ŠçŸ¥æˆ‘ä»¬å­©å­åœ¨æ ¡çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥è®©æˆ‘å’Œå­©å­ç›´æ¥æ²Ÿé€šã€‚</p><p>helperä¸­ä¼šç»´æŠ¤ä¸¤ä¸ªé›†åˆï¼Œä¸€ä¸ªæ˜¯æˆ‘å…³å¿ƒçš„è®¾å¤‡é›†åˆï¼Œä¸€ä¸ªæ˜¯å³å°†æ–­å¼€çš„è®¾å¤‡é›†åˆã€‚å¹¶ä¸æ˜¯è¿æ¥æˆåŠŸçš„è®¾å¤‡å°±ä¼šåŠ å…¥åˆ°è¿™ä¸ªé›†åˆä¸­ï¼Œåªæœ‰ç›‘æŠ¤äººå‘å‡ºäº†ä¸è¿™ä¸ªè®¾å¤‡ç›¸å…³çš„è¯·æ±‚ï¼ˆæ¯”å¦‚è¯´ï¼Œè¿æ¥ï¼Œè·å–ä¿¡æ¯ç­‰ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œheplerå¯ä»¥åˆ¤å®šè¿™ä¸ªè®¾å¤‡æ˜¯è¢«ç›‘æŠ¤äººå…³å¿ƒçš„ï¼Œä»è€Œè¿™ä¸ªè®¾å¤‡æœ‰ä¿¡æ¯æ›´æ–°çš„æ—¶å€™ï¼Œä»–ä¼šå‘ŠçŸ¥æ‰€æœ‰ç›‘æŠ¤è¿™ä¸ªè®¾å¤‡çš„ç›‘æŠ¤äººã€‚</p><p>åœ¨è¿™é‡Œä¹‹æ‰€ä»¥å³å°†æ–­å¼€çš„è®¾å¤‡é›†åˆæ˜¯ä¸ºäº†ï¼Œåœ¨ç›‘æŠ¤äººå‘å‡ºæ–­å¼€è¯·æ±‚ä¹‹åï¼Œä»ç„¶èƒ½å¤Ÿæ¸…æ™°çš„å‘ŠçŸ¥ç›‘æŠ¤äººè¯¥è®¾å¤‡çš„çŠ¶æ€ä¿¡æ¯ï¼Œç­‰åˆ°çœŸæ­£æ–­å¼€è¿æ¥ä¹‹åé€šçŸ¥åˆ°æ¯ä¸€ä¸ªç›‘æŠ¤äººã€‚</p><ul><li>QWSBleHandler</li></ul><p>è¿™ä¸ªæ–‡ä»¶é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€äº›ä»£ç†æ–¹æ³•ã€‚è®¾è®¡ä¸­æ˜¯å°†ä»–åŠ å…¥åˆ°helperä¸­ï¼Œå½“helperæ”¶åˆ°è®¾å¤‡å‘æ¥çš„ä¿¡æ¯æ—¶ï¼Œé€šè¿‡ä»£ç†å°†ä¿¡æ¯æ‹†è§£å¹¶å°è£…æ¨¡å‹é€šçŸ¥åˆ°æ‰€æœ‰ç›‘æŠ¤äººï¼Œå†™åœ¨è¿™é‡Œçº¯ç²¹åªæ˜¯ä¸ºäº†çœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ï¼Œåˆ†æ‹…ä¸€ä¸‹å„ä¸ªæ–‡ä»¶çš„ä»£ç å‹åŠ›ã€‚</p><ul><li>QWSDevControlService</li></ul><p>ç»§æ‰¿NSObjectï¼Œå°è£…çš„æ™ºèƒ½ç¡¬ä»¶è®¾å¤‡çš„æ¨¡å‹ã€‚<br>å¯¹äºæ™ºèƒ½ç¡¬ä»¶è®¾å¤‡æ¥è®²ï¼Œå•å•ä¸€ä¸ªCBPeripheralï¼ˆCoreBluetoothé‡Œçš„å¯¹è±¡ï¼‰æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚æˆ‘ä»¬å¯èƒ½éœ€è¦ä¸ºä»–ä¸°å¯Œæ›´å¤šçš„æ‰©å±•ä¿¡æ¯ï¼Œæ¯”å¦‚è¿™ä¸ªè®¾å¤‡æ˜¯å¦è‡ªåŠ¨é‡è¿ï¼Œæ˜¯å¦éœ€è¦æ–­å¼€åè¿æ¥ï¼Œæ˜¯å¦è®¤è¯ï¼Œé‡è¿æ¬¡æ•°ï¼Œç‰ˆæœ¬å·ç­‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç»§æ‰¿CBPeripheralï¼Œä½†è¿™é‡Œæˆ‘è§‰å¾—å°†CBPeripheralä½œä¸ºå…¶ä¸€ä¸ªå±æ€§ä¼šæ¯”è¾ƒæ¸…æ™°ã€‚</p><p>è¿™ä¸ªå¯¹è±¡ä¼šç»´æŠ¤è‡ªå·±æ‰€æœ‰çš„è¯»å†™æ“ä½œï¼Œä¸ç®¡å¤–ç•Œå‘æ¥ä»€ä¹ˆæŒ‡ä»¤ä¿¡æ¯ï¼Œä»–éƒ½èƒ½æ ¹æ®è‡ªå·±å½“å‰çš„çŠ¶æ€ï¼Œè¯¥æŠ¥é”™æŠ¥é”™ï¼Œè¯¥æ‰§è¡Œæ‰§è¡Œï¼Œå¹¶å°†ç»“æœåé¦ˆç»™æ¯ä¸€ä¸ªç›‘æŠ¤äººã€‚</p><hr><h4 id="å›¾è§£è¯´æ˜"><a href="#å›¾è§£è¯´æ˜" class="headerlink" title="å›¾è§£è¯´æ˜"></a>å›¾è§£è¯´æ˜</h4><p>1.æ™ºèƒ½è®¾å¤‡ä¸ç§»åŠ¨ç«¯çš„å…³ç³»</p><p><img src="http://cdn.yuhanle.com/one-ble-demo-1.png" alt="Paste_Image.png"></p><p>æˆ‘ä»¬çš„Discoveryåœ¨æœ€é¡¶å±‚ï¼Œä¸ä¼šå‚ä¸ä¸è®¾å¤‡çš„ç›´æ¥äº¤äº’ï¼Œæ‰€æœ‰çš„æ”¶å‘æ•°æ®éƒ½æ˜¯ç»è¿‡ç³»ç»Ÿçš„æ¡†æ¶å®ç°ã€‚</p><p>2.ç›‘æŠ¤äººä¸å­©å­çš„å…³ç³»</p><p><img src="http://cdn.yuhanle.com/one-ble-demo-2.png" alt="Paste_Image.png"></p><p>å›¾ä¸­çš„è¿çº¿å¾ˆå¤šï¼Œå¯èƒ½å¾ˆè¿·ç³Šï¼ŒåŒä¸€ç§é¢œè‰²çš„è¿çº¿ä»£è¡¨æ•°æ®äº¤äº’ï¼Œçœ‹helperé‡Œå…³å¿ƒçš„è®¾å¤‡ï¼Œå¯ä»¥æ˜æ˜¾ç†è§£ï¼Œåªæœ‰å…³å¿ƒè¿™ä¸ªè®¾å¤‡æ‰ä¼šæ”¶åˆ°è¿™ä¸ªè®¾å¤‡çš„ä¿¡æ¯ã€‚</p><p>æ¯ä¸€ä¸ªviewControllerç»´æŠ¤ä¸€ä¸ªhelperï¼Œé€šè¿‡NSNotificationCenterå¹¿æ’­æ‰€æœ‰æ“ä½œçš„ç»“æœï¼Œå¹¶å‘ŠçŸ¥æ¯ä¸€ä¸ªå…³å¿ƒè¿™ä¸ªè®¾å¤‡çš„viewControllerã€‚</p><p>ç®€è¨€ä¹‹ï¼Œå°±æ˜¯ç›‘æŠ¤äººæ¥ä¸æ¥å—è¿™ä¸ªé€šçŸ¥ï¼Œæˆ–è€…è€å¸ˆå‘ä¸å‘é€è¿™ä¸ªæ¶ˆæ¯ç»™ç›‘æŠ¤äººã€‚æœ‰ä¸€ç‚¹éœ€è¦æ˜ç™½çš„æ˜¯ï¼Œä¸ç®¡ç›‘æŠ¤äººæƒ³ä¸æƒ³æ”¶åˆ°è¿™ä¸ªè®¾å¤‡çš„æ¶ˆæ¯ï¼Œè¿™ä¸ªè®¾å¤‡éƒ½æ˜¯ä¼šå¹¿æ’­è‡ªå·±çš„ä¿¡æ¯çš„ï¼Œåªæ˜¯helperä¼šåˆ¤æ–­è¿™ä¸ªå­©å­æ˜¯ä¸æ˜¯ä½ çš„~</p><p>ä»¥ä¸Šå°±æ˜¯è¿™ä¸ªDemoçš„è®¾è®¡æ€è·¯ï¼Œå½“ç„¶Demoä¸­ä»æœ‰å¾ˆå¤šä¸è¶³ï¼Œä¹‹æ‰€ä»¥ä¸æ•¢ç§°ä¹‹ä¸ºkitï¼Œæ˜¯å› ä¸ºå®ƒç¡®å®æ²¡æœ‰è¾¾åˆ°kitçš„å°è£…èƒ½åŠ›ä¸æ•ˆæœï¼Œæ¯•ç«Ÿè¿™åªæ˜¯ä¸€ä¸ªDemoï¼Œä»–åªæ˜¯ç®€å•ä½“ç°äº†ä¸€ä¸ªè®¾è®¡æ€è·¯ï¼Œå¹¶ä¸èƒ½è¾¾åˆ°é€šç”¨çš„æ•ˆæœï¼Œå› ä¸ºåœ¨æ™ºèƒ½ç¡¬ä»¶è¿™ä¸€å—ï¼Œæ¯ä¸ªäº§å“çš„åè®®ï¼Œå±æ€§éƒ½ä¼šæœ‰æ‰€å·®å¼‚ï¼Œä¸å¯èƒ½åšåˆ°é€šç”¨çš„æ•ˆæœã€‚å¸Œæœ›å’Œå¤§å®¶æœ‰æ›´æ·±å…¥çš„äº¤æµä¸å­¦ä¹ ï¼</p><p>æœ€åå›é¡¾ä¸€ä¸‹ä¸Šç¯‡æ–‡ç« çš„åœ°å€ï¼š<a href="https://yuhanle.github.io/2015/06/24/ble-development-continuously-update/" target="_blank" rel="noopener">iOS-BLEè“ç‰™å¼€å‘æŒç»­æ›´æ–°</a></p><p>ä»¥åŠè¿™ä¸ªè¯´äº†å¾ˆä¹…çš„Demoåœ°å€ï¼š<a href="https://github.com/yuhanle/WEBlueToothManager" target="_blank" rel="noopener">ä¸€ä¸ªiOS BLEè“ç‰™å­¦ä¹ çš„Demo</a></p><p>åœ¨è¿™é‡Œä¹Ÿé¡ºä¾¿ä»‹ç»ä¸€ä¸‹è¿‘æœŸçœ‹åˆ°çš„ä¸€ç¯‡å…³äºBLEå¼€å‘çš„kit(<a href="http://macpu.github.io/2015/11/04/MPBluetoothKit-iOS%E8%93%9D%E7%89%99%E6%A1%86%E6%9E%B6/" target="_blank" rel="noopener">MPBluetoothKit iOSè“ç‰™æ¡†æ¶</a>)ï¼Œä½œè€…å¾ˆè¯¦ç»†çš„å°†ç³»ç»Ÿçš„CoreBluetoothçš„ä»£ç†éƒ½ç”¨blockå®ç°äº†ï¼Œçœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ä¸å®ç”¨ï¼Œä¹Ÿå¸Œæœ›å„ä½èƒ½å¤Ÿå¤šå¤šå…³æ³¨ï¼Œå…±åŒå­¦ä¹ ã€‚</p><p>æœ¬ç«™æ–‡ç« å¦‚æ— å…¶ä»–ç‰¹æ®Šè¯´æ˜ï¼Œå‡ä¸ºåŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å†™è¿™ç¯‡è¯¦è§£æ˜¯å› ä¸ºæœ€è¿‘å¾ˆå¤šäººéƒ½åœ¨é—®ç›¸å…³é—®é¢˜ï¼Œä½†æ˜¯ä¸Šç¯‡æ–‡ç« &lt;a href=&quot;https://yuhanle.github.io/2015/06/24/ble-development-continuously-update/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;iOS-BLEè“ç‰™å¼€å‘æŒç»­æ›´æ–°&lt;/a&gt;å·²ç»è¿‡å»åŠå¹´ï¼Œå¾ˆå¤šä¸œè¥¿å·²ç»å¼€å§‹é—å¿˜ï¼Œä»Šå¤©é‡æ–°æ‹¾èµ·ï¼Œå¹¶åœ¨Demoä¸­æ–°æ·»äº†å…·ä½“åŠŸèƒ½å’Œè¯¦ç»†æ³¨é‡Šï¼Œé¡ºä¾¿å±¡ä¸€ä¸‹å½“åˆè®¾è®¡çš„æ€è·¯ï¼Œæˆ‘æƒ³ç”¨å›¾ç‰‡æ¥è§£é‡Šä¼šæ›´å¥½ç†è§£ã€‚
    
    </summary>
    
      <category term="iOS" scheme="https://blog.yuhanle.com/categories/iOS/"/>
    
    
      <category term="iOS" scheme="https://blog.yuhanle.com/tags/iOS/"/>
    
  </entry>
  
</feed>
